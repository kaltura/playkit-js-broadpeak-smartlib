var KalturaPlayer="object"==typeof KalturaPlayer?KalturaPlayer:{};KalturaPlayer.plugins=KalturaPlayer.plugins||{},KalturaPlayer.plugins.broadpeak=function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=103)}([function(t,e,n){(function(e){var n=function(t){return t&&t.Math==Math&&t};t.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof e&&e)||function(){return this}()||Function("return this")()}).call(this,n(65))},function(t,e,n){var r=n(0),i=n(43),o=n(3),s=n(44),a=n(51),u=n(80),c=i("wks"),l=r.Symbol,f=u?l:l&&l.withoutSetter||s;t.exports=function(t){return o(c,t)&&(a||"string"==typeof c[t])||(a&&o(l,t)?c[t]=l[t]:c[t]=f("Symbol."+t)),c[t]}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){var r=n(41),i={}.hasOwnProperty;t.exports=function(t,e){return i.call(r(t),e)}},function(t,e,n){var r=n(8);t.exports=function(t){if(!r(t))throw TypeError(String(t)+" is not an object");return t}},function(t,e){t.exports=KalturaPlayer},function(module,exports,__webpack_require__){var e;"undefined"!=typeof self&&self,e=function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=159)}([function(t,e,n){"use strict";function r(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}n.d(e,"n",(function(){return Br})),n.d(e,"l",(function(){return V})),n.d(e,"h",(function(){return y})),n.d(e,"g",(function(){return l})),n.d(e,"k",(function(){return et})),n.d(e,"b",(function(){return M})),n.d(e,"a",(function(){return kr})),n.d(e,"i",(function(){return Pn})),n.d(e,"d",(function(){return Qn})),n.d(e,"j",(function(){return jn})),n.d(e,"e",(function(){return Cn})),n.d(e,"c",(function(){return ut})),n.d(e,"f",(function(){return rr})),n.d(e,"m",(function(){return Ot})),n.d(e,"o",(function(){return Jn})),n.d(e,"p",(function(){return dn})),n.d(e,"q",(function(){return Ur})),n(4),n(61),n(140),n(74);var i=0;function o(t){return"__private_"+i+++"_"+t}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),t}var c=function(){function t(){s(this,t)}return u(t,null,[{key:"log",value:function(t,e,n){}}]),t}(),l=function t(){s(this,t)};l.VERBOSE=0,l.DEBUG=1,l.INFO=2,l.WARN=3,l.ERROR=4;var f=function t(){s(this,t)};f.NONE=-1,f.BASIC=0,f.VERBOSE=1;var h=o("instance"),d=o("loggerHandler"),p=o("logs"),v=o("logLevelOutput"),y=function(){function t(){s(this,t),Object.defineProperty(this,d,{writable:!0,value:c}),Object.defineProperty(this,p,{writable:!0,value:void 0}),Object.defineProperty(this,v,{writable:!0,value:void 0}),r(this,p)[p]=[],r(this,v)[v]=f.VERBOSE}return u(t,null,[{key:"getInstance",value:function(){return r(t,h)[h]||(r(t,h)[h]=new t),r(t,h)[h]}}]),u(t,[{key:"init",value:function(t){r(this,d)[d]=t}},{key:"release",value:function(){r(this,d)[d]=void 0}},{key:"printLogs",value:function(t,e,n,i){r(this,p)[p].length>100&&(r(this,p)[p]=[]),void 0!==i&&(n="["+i+"] "+n),r(this,p)[p].push(e+": "+n),r(this,d)[d].log(t,e,n,i)}},{key:"printVerboseLogs",value:function(t,e,n){r(this,v)[v]<f.VERBOSE||this.printLogs(l.VERBOSE,t,e,n)}},{key:"printDebugLogs",value:function(t,e,n){r(this,v)[v]<f.VERBOSE||this.printLogs(l.DEBUG,t,e,n)}},{key:"printInfoLogs",value:function(t,e,n){r(this,v)[v]<=f.NONE||this.printLogs(l.INFO,t,e,n)}},{key:"printWarnLogs",value:function(t,e,n){r(this,v)[v]<=f.NONE||this.printLogs(l.WARN,t,e,n)}},{key:"printErrorLogs",value:function(t,e,n){r(this,v)[v]<=f.NONE||this.printLogs(l.ERROR,t,e,n)}},{key:"getLogs",value:function(){return r(this,p)[p].join("\n")}},{key:"resetLogs",value:function(){r(this,p)[p]=[]}},{key:"getLogLevel",value:function(t){return r(this,v)[v]}},{key:"setLogLevel",value:function(t){r(this,v)[v]=t}}]),t}();function g(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Object.defineProperty(y,h,{writable:!0,value:void 0}),n(19),n(22),n(34),n(173),n(15),n(113),n(45);var E=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,(n=[{key:"parseURL",value:function(t){if(null===t||""===t)return null;var e=t.match("^(https?)\\:\\/\\/(([^:\\/?#]*)(?:\\:([0-9]+))?)([\\/]{0,1}[^?#]*)(\\?[^#]*|)(#.*|)$"),n=e&&{href:t,protocol:e[1],host:e[2],hostname:e[3],port:e[4],path:e[5],query:e[6],hash:e[7]};return null!==n&&null!==n.query&&n.query.length>0&&(n.query=n.query.substring(1)),n}},{key:"getParam",value:function(t,e){if("string"!=typeof t)return"";e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return n&&n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):""}},{key:"addOrReplaceParam",value:function(t,e,n){var r=t.indexOf("?"+e+"=");if(r<0&&(r=t.indexOf("&"+e+"=")),r>=0){var i=t.substring(0,t.indexOf(e)),o=t.substring(t.indexOf(e));return i+e+"="+n+(o.indexOf("&")>=0?o.substring(o.indexOf("&")):"")}return(t.indexOf("?")<0?t+"?":t+"&")+e+"="+n}},{key:"extractHostnamePort",value:function(t){return null===t||""===t?"":(t.indexOf("://")>-1?t.split("/")[2]:t.split("/")[0]).split("?")[0]}}])&&g(e,n),t}();E.REGEX_IP="^(?:[0-9]{1,3}\\.){3}[0-9]{1,3}(:[0-9]+)?$",E.REGEX_HOSTNAME="^([A-Za-z0-9\\_\\-\\.]+)(:[0-9]+)?$",E.REGEX_TICKET="^[0-5a-z]{30,50}$";var S="03.02.00.3317";function b(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n(9),n(11),n(12),n(7),n(13),n(14),n(62),n(114);var m=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,(n=[{key:"randomIntFromInterval",value:function(t,e){return Math.floor(Math.random()*(e-t+1)+t)}},{key:"bufferToBase64Lookup",value:function(t){return t<26?String.fromCharCode(t+"A".charCodeAt(0)):t<52?String.fromCharCode(t-26+"a".charCodeAt(0)):t<62?String.fromCharCode(t-52+"0".charCodeAt(0)):62===t?"-":63===t?"_":""}},{key:"bufferToBase64",value:function(e){var n,r=e.data(),i=e.length(),o="";for(n=0;n<i;n+=3){var s=[void 0,void 0,void 0,void 0];s[0]=r[n]>>2,s[1]=(3&r[n])<<4,i>n+1&&(s[1]|=r[n+1]>>4,s[2]=(15&r[n+1])<<2),i>n+2&&(s[2]|=r[n+2]>>6,s[3]=63&r[n+2]);for(var a=0;a<s.length;a++)void 0===s[a]||(o+=t.bufferToBase64Lookup(s[a]))}return o}},{key:"stringToBase64Lookup",value:function(t){return t<26?String.fromCharCode(t+"A".charCodeAt(0)):t<52?String.fromCharCode(t-26+"a".charCodeAt(0)):t<62?String.fromCharCode(t-52+"0".charCodeAt(0)):62===t?"+":63===t?"/":""}},{key:"stringToBase64",value:function(e){var n;for(e=String(e),n=0;n<e.length;n++)if(e.charCodeAt(n)>255)return null;var r="";for(n=0;n<e.length;n+=3){var i=[void 0,void 0,void 0,void 0];i[0]=e.charCodeAt(n)>>2,i[1]=(3&e.charCodeAt(n))<<4,e.length>n+1&&(i[1]|=e.charCodeAt(n+1)>>4,i[2]=(15&e.charCodeAt(n+1))<<2),e.length>n+2&&(i[2]|=e.charCodeAt(n+2)>>6,i[3]=63&e.charCodeAt(n+2));for(var o=0;o<i.length;o++)void 0===i[o]?r+="=":r+=t.stringToBase64Lookup(i[o])}return r}},{key:"floor",value:function(t){return t>>>0}},{key:"bufferToString",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.length,n="[0x",r=0;r<e;r++){var i=t[r];n+=("00"+Number(i).toString(16)).slice(-2),r<e-1&&(n+=",0x")}return n+"] (capacity:"+t.length+")"}}])&&b(e,n),t}();function k(t){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function A(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function I(t,e,n){return e&&A(t.prototype,e),n&&A(t,n),t}function D(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var R=0,T="BpkJobMgr",_="__private_"+R+++"_instance",N=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.worker=void 0,this.jobs=void 0,this.jobs={}}return I(t,null,[{key:"getInstance",value:function(){return D(t,_)[_]||(D(t,_)[_]=new t),D(t,_)[_]}}]),I(t,[{key:"async",value:function(t,e,n,r){return this.start(t,0,-1,e,n,r)}},{key:"asyncGet",value:function(t,e,n,r){return this.start("get",0,-1,(function(){V.getInstance().requestHandler.get(t,e,n,r)}),(function(){return{url:t,headers:e,timeout:n}}),r)}},{key:"asyncPost",value:function(t,e,n,r,i){return this.start("post",0,-1,(function(){V.getInstance().requestHandler.post(t,e,n,r,i)}),(function(){return{url:t,headers:e,body:n,timeout:r}}),i)}},{key:"asyncDelay",value:function(t,e){var n,r=this.start("delay",t,-1,(function(e){n=setTimeout(e,t)}),void 0,e);return r.task=n,r}},{key:"asyncNonce",value:function(t,e,n){var r,i=this.start("waitNonce",0,t,(function(){r=setTimeout(n,t)}),void 0,e,n,!0);return i.task=r,i}},{key:"waitNonce",value:function(t,e,n){var r,i=this.start("waitNonce",0,t,(function(){r=setTimeout(n,t)}),void 0,e,n,!1);return i.task=r,i}},{key:"start",value:function(t,e,n,r,i,o){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:function(){},a=!(arguments.length>7&&void 0!==arguments[7])||arguments[7];if(void 0===this.worker&&("function"==typeof CoreWorker?this.worker=new CoreWorker:"object"===("undefined"==typeof CoreWorker?"undefined":k(CoreWorker))&&(this.worker=CoreWorker)),void 0!==this.worker){var u=this.createJob();return u.active=!0,u.command=t,u.startDelay=e,u.timeoutDelay=n,u.requestInfo=i,u.result=o,u.timeout=s,u.async=a,y.getInstance().printVerboseLogs(T,'Starting job "'+t+'"...'),a?this.worker.async(u.id,u.command,u.startDelay,u.timeoutDelay):this.worker.sync(u.id,u.command,u.startDelay,u.timeoutDelay),u}return r(o),{command:t}}},{key:"cancel",value:function(t){void 0!==t&&(void 0!==this.worker&&(y.getInstance().printVerboseLogs(T,'Stopping job "'+t.command+'"...'),t.active=!1,this.worker.cancel(t.id),delete this.jobs[t.id]),void 0!==t.task&&clearTimeout(t.task))}},{key:"requestInfo",value:function(t){var e=this.jobs[t];return void 0!==e&&"function"==typeof e.requestInfo?e.requestInfo():{}}},{key:"result",value:function(t,e){var n=this.jobs[t];void 0!==n&&"function"==typeof n.result&&!0===n.active&&n.result(e),delete this.jobs[t]}},{key:"timeout",value:function(t){var e=this.jobs[t];void 0!==e&&"function"==typeof e.timeout&&!0===e.active&&(y.getInstance().printVerboseLogs(T,'Job "'+e.command+'" timeout...'),e.timeout()),delete this.jobs[t]}},{key:"createJob",value:function(){for(var t=m.randomIntFromInterval(1e6,9999999);void 0!==this.jobs[t];)t=m.randomIntFromInterval(1e6,9999999);return this.jobs[t]={id:t},this.jobs[t]}}]),t}();function L(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function O(t,e,n){return e&&L(t.prototype,e),n&&L(t,n),t}function P(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}Object.defineProperty(N,_,{writable:!0,value:void 0}),n(36),n(77),n(37),n(78),n(38);var w=0,C="__private_"+w+++"_instance",M=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.smartLib=void 0,this.listeners=void 0,this.bound=void 0,this.networkAvailable=void 0,this.appInBackground=void 0,this.networkType=99,this.mute=0,this.bound=!1,this.release()}return O(t,null,[{key:"getInstance",value:function(){return P(t,C)[C]||(P(t,C)[C]=new t),P(t,C)[C]}}]),O(t,[{key:"init",value:function(t){y.getInstance().printDebugLogs("BpkAppStateMgr","Initializing core app state manager..."),this.smartLib=t,!1===this.bound?(this.networkAvailable=!0,this.appInBackground=!1):y.getInstance().printDebugLogs("BpkAppStateMgr","Core app state manager is bound to the target, skipping default values..."),this.release()}},{key:"release",value:function(){this.listeners=[]}},{key:"bind",value:function(){this.bound=!0}},{key:"isConnectedToWifi",value:function(){return this.networkType>=10&&this.networkType<=12}},{key:"addListener",value:function(t){this.listeners.includes(t)||this.listeners.push(t)}},{key:"removeListener",value:function(t){var e=this.listeners.indexOf(t);-1!==e&&this.listeners.splice(e,1)}},{key:"notifyEvent",value:function(t,e,n,r){"function"==typeof t[e]&&t[e](n,r)}},{key:"notifyForeground",value:function(){var t=this;y.getInstance().printDebugLogs("BpkAppStateMgr","App is in foreground"),this.appInBackground=!1,this.listeners.forEach((function(e){t.notifyEvent(e,"onForeground")}))}},{key:"notifyBackground",value:function(){var t=this;y.getInstance().printDebugLogs("BpkAppStateMgr","App is in background"),this.appInBackground=!0,this.listeners.forEach((function(e){t.notifyEvent(e,"onBackground")}))}},{key:"notifyNetworkAvailable",value:function(t){var e=this;void 0===t?(y.getInstance().printDebugLogs("BpkAppStateMgr","Network is available (networkType:"+t+")"),this.networkAvailable=!0,this.listeners.forEach((function(t){e.notifyEvent(t,"onNetworkAvailable",99)}))):this.networkType!==t&&(y.getInstance().printDebugLogs("BpkAppStateMgr","Network is available (networkType:"+t+")"),this.networkAvailable=!0,this.networkType=t,this.listeners.forEach((function(n){e.notifyEvent(n,"onNetworkAvailable",t)})))}},{key:"notifyNetworkLost",value:function(){var t=this;!1!==this.networkAvailable&&(y.getInstance().printDebugLogs("BpkAppStateMgr","Network is unavailable"),this.networkAvailable=!1,this.networkType=0,this.listeners.forEach((function(e){t.notifyEvent(e,"onNetworkLost")})))}},{key:"notifyMute",value:function(){var t=this;y.getInstance().printDebugLogs("BpkAppStateMgr","Volume is muted"),this.mute=1,this.listeners.forEach((function(e){t.notifyEvent(e,"onMute")}))}},{key:"notifyUnmute",value:function(){var t=this;y.getInstance().printDebugLogs("BpkAppStateMgr","Volume is unmuted"),this.mute=0,this.listeners.forEach((function(e){t.notifyEvent(e,"onUnmute")}))}}]),t}();function B(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}Object.defineProperty(M,C,{writable:!0,value:void 0});var x=0;function U(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function j(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function F(t,e,n){return e&&j(t.prototype,e),n&&j(t,n),t}var G=function(){function t(){U(this,t)}return F(t,null,[{key:"get",value:function(t,e,n,r){r({body:void 0,headers:void 0,statusCode:-1})}},{key:"post",value:function(t,e,n,r,i){i({body:void 0,headers:void 0,statusCode:-1})}}]),t}(),H="__private_"+x+++"_instance",V=function(){function t(){U(this,t),this.requestHandler=G,this.smartLib=void 0}return F(t,null,[{key:"getInstance",value:function(){return B(t,H)[H]||(B(t,H)[H]=new t),B(t,H)[H]}}]),F(t,[{key:"init",value:function(t){this.requestHandler=t}},{key:"attachInstance",value:function(t){this.smartLib=t}},{key:"release",value:function(){}},{key:"requestNanoCDNStatus",value:function(e){var n="http://"+e+":"+t.NANOCDN_CORE_PORT+"/nanocdnstatus.xml";return new Promise((function(t,e){N.getInstance().asyncGet(n,{Connection:"close"},3e3,(function(e){var n=0,r="";void 0!==e.statusCode&&(n=parseInt(e.statusCode,10)),void 0!==e.body&&(r=e.body),t({httpStatus:n,body:r})}))}))}},{key:"getURL",value:function(e,n,r){var i,o=this,s=r.options,a=0!==n.nanoCDNHost.length&&!0===s.get(dn.REQUEST_NANO_CDN),u=t.isBroadpeakDomainName(e,n.broadpeakDomainNames)&&!0===s.get(dn.REQUEST_BROADPEAK_CDN),c=!0===s.get(dn.MULTICAST_ONLY);if(a?"*"===n.broadpeakDomainNames?y.getInstance().printInfoLogs("BpkRequestMgr","Workflow 5.2 (v"+S+")",r.id):""===n.broadpeakDomainNames?y.getInstance().printInfoLogs("BpkRequestMgr","Workflow 5.4 (v"+S+")",r.id):u?y.getInstance().printInfoLogs("BpkRequestMgr","Workflow 5.6 => 5.2 (v"+S+")",r.id):y.getInstance().printInfoLogs("BpkRequestMgr","Workflow 5.6 => 5.4 (v"+S+")",r.id):"*"===n.broadpeakDomainNames?y.getInstance().printInfoLogs("BpkRequestMgr","Workflow 5.1 (v"+S+")",r.id):""===n.broadpeakDomainNames?y.getInstance().printInfoLogs("BpkRequestMgr","Workflow 5.3 (v"+S+")",r.id):u?y.getInstance().printInfoLogs("BpkRequestMgr","Workflow 5.5 => 5.1 (v"+S+")",r.id):y.getInstance().printInfoLogs("BpkRequestMgr","Workflow 5.5 => 5.3 (v"+S+")",r.id),y.getInstance().printInfoLogs("BpkRequestMgr","   Parameters",r.id),y.getInstance().printInfoLogs("BpkRequestMgr","      analyticsAddress="+n.analyticsAddress,r.id),y.getInstance().printInfoLogs("BpkRequestMgr","      nanoCDNHost="+n.nanoCDNHost,r.id),y.getInstance().printInfoLogs("BpkRequestMgr","      broadpeakDomainNames="+n.broadpeakDomainNames,r.id),s.print("BpkRequestMgr","   ",r.id),a)return this.requestNanoCDN(e,n,r).then((function(t){var i=o.smartLib.nanoCDNHostManager.getNanoCDNHostList();return t.isError()&&i.length>=2?o.requestNanoCDNList(e,n,0,r):{result:t,redirectedURL:t.getURL(),nanoCDNHost:n.nanoCDNHost}})).then((function(t){return t.result.isError()?t.result.isError()&&!0===c?u?(y.getInstance().printDebugLogs("BpkRequestMgr","nanoCDN responded an error, requesting the BkM instead...",r.id),o.requestBkM(e,n,void 0,r)):t.result:o.requestBkM(e,n,void 0,r):(o.smartLib.nanoCDNHostManager.setCurrentNanoCDNHost(t.nanoCDNHost),u&&!1===c?o.requestBkM(e,n,t.nanoCDNHost,r).then((function(e){return e.isError()||-1===e.getURL().indexOf("://"+t.nanoCDNHost+":")||!0!==r.options.get(dn.ULTRA_LOW_LATENCY_SUPPORT)||(e.url=E.addOrReplaceParam(e.url,"ulls","1")),e})):t.result)}));if(!0===c)return Promise.resolve(Ur.error(Ur.RESULT_REQUESTED_URL_NOT_FOUND_ON_NANOCDN));if(void 0===r.adSession||!r.adSession.hasAdParameters())return this.requestBkM(e,n,void 0,r);var l=this.smartLib.internalAdManager.requestNonce();return this.requestBkM(e,n,void 0,r).then((function(t){return i=t,l.getNonce()})).then((function(t){if(!i.isError()){if(void 0!==r.adSession&&r.adSession.hasAdParameters()){var e=r.adSession.adParameters;for(var n in e)i.url=E.addOrReplaceParam(i.url,n,e[n])}return r.adTrackingManager.initBkYouSession(i,t)}return i}))}},{key:"requestBkM",value:function(e,n,r,i){var o=i.options;if(t.isBroadpeakDomainName(e,n.broadpeakDomainNames)&&!0===o.get(dn.REQUEST_BROADPEAK_CDN)||!0===o.get(dn.REQUEST_REDIRECT_THIRD_PARTY_CDN)){var s=E.addOrReplaceParam(e,"response","200");return s=E.addOrReplaceParam(s,"bk-ml","1"),"string"==typeof r&&0!==r.length?s=E.addOrReplaceParam(s,"nanocdnhost",r):!0===o.get(dn.REQUEST_DIVERSITY)&&(s=E.addOrReplaceParam(s,"diversityhost","127.0.0.1:18080")),t.isBroadpeakDomainName(e,n.broadpeakDomainNames)?y.getInstance().printDebugLogs("BpkRequestMgr","Sending request to the BkM/umbrella: "+s,i.id):y.getInstance().printDebugLogs("BpkRequestMgr","Sending request to third party CDN: "+s,i.id),this.getRedirectionLocation(s,t.CDN_REQUEST_TIMEOUT,n,i).then((function(r){return t.isBroadpeakDomainName(e,n.broadpeakDomainNames)?y.getInstance().printDebugLogs("BpkRequestMgr","BkM/umbrella responded with status code "+r.httpStatus,i.id):y.getInstance().printDebugLogs("BpkRequestMgr","Third party CDN responded with status code "+r.httpStatus,i.id),r.httpStatus>=200&&r.httpStatus<400&&""!==r.redirectedURL?Ur.success(r.redirectedURL):r.httpStatus<=0?Ur.error(Ur.RESULT_CDN_RESPONSE_UNREADABLE):r.httpStatus>=400&&r.httpStatus<500?Ur.error(Ur.RESULT_REQUESTED_URL_NOT_FOUND_ON_CDN):r.httpStatus>=500&&r.httpStatus<600?Ur.error(Ur.RESULT_REQUESTED_URL_CDN_ERROR):Ur.error(Ur.RESULT_NO_STREAMING_URL_FOUND)}))}return Promise.resolve(Ur.success(e))}},{key:"requestNanoCDN",value:function(e,n,r){var i=r.options,o=E.parseURL(e),s=t.isBroadpeakDomainName(e,n.broadpeakDomainNames)&&!0===i.get(dn.REQUEST_BROADPEAK_CDN),a=!M.getInstance().isConnectedToWifi()||!0===i.get(dn.REQUEST_LOCAL_NANO_CDN_IF_CONNECTED_TO_WIFI)&&M.getInstance().isConnectedToWifi();if(("127.0.0.1"===n.nanoCDNHost||"localhost"===n.nanoCDNHost)&&!1===a)return y.getInstance().printDebugLogs("BpkRequestMgr","Ignoring nanoCDN "+n.nanoCDNHost+" because of the Wi-Fi connection...",r.id),Promise.resolve(Ur.error(Ur.RESULT_REQUESTED_URL_NOT_FOUND_ON_NANOCDN));var u="";""!==o.query&&(u="&"+o.query);var c="";n.analyticsAddress.length>1&&(c="&ssu="+E.extractHostnamePort(n.analyticsAddress));var l="";!0===r.options.get(dn.MULTICAST_ONLY)&&(l="&mo=1");var f="";!0===r.options.get(dn.ULTRA_LOW_LATENCY_SUPPORT)&&(f="&ulls=1");var h="http://"+n.nanoCDNHost+":8000"+o.path+"?response=200&bk-ml=1"+c+"&us="+o.host+l+f+u;return y.getInstance().printDebugLogs("BpkRequestMgr","Sending request to the nanoCDN ("+n.nanoCDNHost+")...",r.id),this.getRedirectionLocation(h,t.NANOCDN_REQUEST_TIMEOUT,n,r).then((function(t){y.getInstance().printDebugLogs("BpkRequestMgr","nanoCDN responded with status code "+t.httpStatus,r.id);var n=Ur.error(Ur.RESULT_NO_STREAMING_URL_FOUND);return 200===t.httpStatus&&""!==t.redirectedURL?n=Ur.success(t.redirectedURL):503===t.httpStatus&&s?n=Ur.success(e):(503!==t.httpStatus||s)&&(404!==t.httpStatus||s)||(n=Ur.error(Ur.RESULT_REQUESTED_URL_NOT_FOUND_ON_NANOCDN)),n}))}},{key:"requestNanoCDNList",value:function(t,e,n,r){var i=this,o=this.smartLib.nanoCDNHostManager.getNanoCDNHostList();if(n>=o.length)return{result:Ur.error(Ur.RESULT_NO_STREAMING_URL_FOUND),redirectedURL:"",nanoCDNHost:void 0};var s=o[n];return e.nanoCDNHost=s,s===e.nanoCDNHostConfigured?this.requestNanoCDNList(t,e,n+1,r):this.requestNanoCDN(t,e,r).then((function(a){return a.isError()&&o.length>=2?i.requestNanoCDNList(t,e,n+1,r):{result:a,redirectedURL:a.getURL(),nanoCDNHost:s}}))}},{key:"getRedirectionLocation",value:function(t,e,n,r){var i=this;return new Promise((function(o,s){var a={Connection:"close"};void 0!==n.userAgent&&(a["User-Agent"]=n.userAgent),i.requestHandler.get(t,a,e,(function(t){var e=0,n="";void 0!==t.statusCode&&(e=parseInt(t.statusCode,10)),void 0!==t.headers&&void 0!==t.headers.location?n=t.headers.location:e>=200&&e<400&&y.getInstance().printErrorLogs("BpkRequestMgr",'Location header cannot be read, please ensure "Access-Control-Expose-Headers: Location" is configured.',r.id),o({httpStatus:e,redirectedURL:n})}))}))}},{key:"startSession",value:function(e,n){var r=e.sessionReport;if(0!==n.analyticsAddress.length){var i=n.analyticsAddress+t.METRICS_RECEIVER_PATH;return y.getInstance().printInfoLogs("BpkRequestMgr","Posting metrics to "+i,e.id),this.postSession(i,r.toStartSessionJSON(),n).then((function(t){return y.getInstance().printInfoLogs("BpkRequestMgr","Send creation session metrics ended with with status code: "+t.httpStatus,e.id),t.httpStatus>=200&&t.httpStatus<300||(503===t.httpStatus&&y.getInstance().printDebugLogs("BpkRequestMgr","Request execution failed",e.id),!1)}))}return y.getInstance().printWarnLogs("BpkRequestMgr","Metrics platform URL is null, creation metrics won't be posted anywhere.",e.id),Promise.resolve(!1)}},{key:"endSession",value:function(e,n){var r=e.sessionReport;if(0!==n.analyticsAddress.length){var i=n.analyticsAddress+t.METRICS_RECEIVER_PATH;return y.getInstance().printInfoLogs("BpkRequestMgr","Posting metrics to "+i,e.id),this.postSession(i,r.toEndSessionJSON(),n).then((function(t){return y.getInstance().printInfoLogs("BpkRequestMgr","Send session metrics ended with with status code: "+t.httpStatus,e.id),t.httpStatus>=200&&t.httpStatus<300||(503===t.httpStatus&&y.getInstance().printDebugLogs("BpkRequestMgr","Request execution failed",e.id),!1)}))}return y.getInstance().printWarnLogs("BpkRequestMgr","Metrics platform URL is null, metrics won't be posted anywhere.",e.id),Promise.resolve(!1)}},{key:"postSession",value:function(e,n,r){return new Promise((function(i,o){var s={Connection:"close"};void 0!==r.userAgent&&(s["User-Agent"]=r.userAgent);var a=JSON.stringify(n);y.getInstance().printVerboseLogs("BpkRequestMgr","Executing POST request with body: "+a),N.getInstance().asyncPost(e,s,a,t.POST_SESSION_REQUEST_TIMEOUT,(function(t){var e=0;void 0!==t.statusCode&&(e=parseInt(t.statusCode,10)),i({httpStatus:e})}))}))}},{key:"keepalive",value:function(e,n){var r=e.sessionReport,i=r.redirectedURL,o=i.indexOf("?");o>0&&(i=i.substring(0,o)),i.endsWith("/")||(i+="/"),i+=t.KEEPALIVE_PATH;var s=e.options.get(dn.SESSION_REPORTING_MODE);return s===dn.SESSION_REPORTING_MODE_DEFAULT||s===dn.SESSION_REPORTING_MODE_KEEPALIVE_TEARDOWN?(i+="?"+t.TEARDOWN_TIMELINE_QUERY+r.timeline.data().base64(),i+="&"+t.TEARDOWN_METRICS_QUERY+r.toQuery(),y.getInstance().printInfoLogs("BpkRequestMgr","Sending keepalive with metrics to "+i,e.id)):y.getInstance().printInfoLogs("BpkRequestMgr","Sending keepalive without metrics to "+i,e.id),new Promise((function(r,o){var s={Connection:"close"};void 0!==n.userAgent&&(s["User-Agent"]=n.userAgent),N.getInstance().asyncGet(i,s,t.BKS_REQUEST_TIMEOUT,(function(t){y.getInstance().printInfoLogs("BpkRequestMgr","Send keepalive with metrics end with status code: "+t.statusCode,e.id),r(t.statusCode)}))}))}},{key:"teardown",value:function(e,n){var r=e.sessionReport,i=r.redirectedURL,o=i.indexOf("?");o>0&&(i=i.substring(0,o)),i.endsWith("/")||(i+="/"),i+=t.TEARDOWN_PATH,i+=r.statusCode;var s=e.options.get(dn.SESSION_REPORTING_MODE);return s===dn.SESSION_REPORTING_MODE_DEFAULT||s===dn.SESSION_REPORTING_MODE_KEEPALIVE_TEARDOWN?(i+="?"+t.TEARDOWN_TIMELINE_QUERY+r.timeline.data().base64(),i+="&"+t.TEARDOWN_METRICS_QUERY+r.toQuery(),y.getInstance().printInfoLogs("BpkRequestMgr","Sending teardown with metrics to "+i,e.id)):y.getInstance().printInfoLogs("BpkRequestMgr","Sending teardown without metrics to "+i,e.id),new Promise((function(r,o){var s={Connection:"close"};void 0!==n.userAgent&&(s["User-Agent"]=n.userAgent),N.getInstance().asyncGet(i,s,t.BKS_REQUEST_TIMEOUT,(function(t){y.getInstance().printInfoLogs("BpkRequestMgr","Send teardown with metrics end with status code: "+t.statusCode,e.id)}))}))}},{key:"adEvent",value:function(t){N.getInstance().asyncGet(t,{},2e4,(function(t){y.getInstance().printInfoLogs("BpkRequestMgr","Ad event request ends with status code: "+t.statusCode)}))}},{key:"adTracking",value:function(e,n,r){var i=this,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return y.getInstance().printDebugLogs("BpkRequestMgr","Downloading ad tracking file "+r,e.id),new Promise((function(s,a){var u={Connection:"close"};void 0!==n.userAgent&&(u["User-Agent"]=n.userAgent),!1===o?i.requestHandler.get(r,u,t.BKS_REQUEST_TIMEOUT,(function(t){y.getInstance().printDebugLogs("BpkRequestMgr","Ad tracking responded with status code "+t.statusCode,e.id),s({httpStatus:t.statusCode,content:t.body})})):N.getInstance().asyncGet(r,u,t.BKS_REQUEST_TIMEOUT,(function(t){y.getInstance().printDebugLogs("BpkRequestMgr","Ad tracking responded with status code "+t.statusCode,e.id),s({httpStatus:t.statusCode,content:t.body})}))}))}}],[{key:"isBroadpeakDomainName",value:function(t,e){if(null===e||""===e)return!1;if("*"===e)return!0;var n=E.parseURL(t);return null!==n&&null!==n.hostname&&e.split(",").indexOf(n.hostname)>=0}}]),t}();function Y(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}V.METRICS_RECEIVER_PATH="fservices/metricsReceiver",V.TEARDOWN_PATH="teardown/",V.TEARDOWN_METRICS_QUERY="metrics=",V.TEARDOWN_TIMELINE_QUERY="metricsTL=",V.KEEPALIVE_PATH="keepalive",V.NANOCDN_RR_PORT="8000",V.NANOCDN_CORE_PORT="18081",V.QUERY_PARAMETER_SESSION_ID="bk-session_id",V.QUERY_PARAMETER_SESSION_CREATED="bk-session",V.CDN_REQUEST_TIMEOUT=2e4,V.NANOCDN_REQUEST_TIMEOUT=1e3,V.POST_SESSION_REQUEST_TIMEOUT=5e3,V.BKS_REQUEST_TIMEOUT=5e3,V.KEEPALIVE_REQUEST_INTERVAL=5e3,Object.defineProperty(V,H,{writable:!0,value:void 0}),n(53);var W=0;function q(t){return"__private_"+W+++"_"+t}function K(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Q(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function z(t,e,n){return e&&Q(t.prototype,e),n&&Q(t,n),t}var J=function(){function t(){K(this,t)}return z(t,null,[{key:"loadPlayerAdapters",value:function(){return{}}}]),t}(),X=q("instance"),$=q("playerManagerHandler"),Z=q("playerAdapters"),tt=q("playerAdapter"),et=function(){function t(){K(this,t),this.smartLib=void 0,Object.defineProperty(this,$,{writable:!0,value:J}),Object.defineProperty(this,Z,{writable:!0,value:{}}),Object.defineProperty(this,tt,{writable:!0,value:void 0})}return z(t,[{key:"init",value:function(t){Y(this,$)[$]===J&&(Y(this,$)[$]=t,Y(this,Z)[Z]=Y(this,$)[$].loadPlayerAdapters(),y.getInstance().printVerboseLogs("BpkPlayerMgr","Compatible players: "+Object.keys(Y(this,Z)[Z])))}},{key:"release",value:function(){this.setPlayerAdapter(void 0)}},{key:"attachInstance",value:function(t){this.smartLib=t}},{key:"getAdapters",value:function(){return Y(this,Z)[Z]}},{key:"setPlayerAdapter",value:function(t){void 0!==Y(this,tt)[tt]&&Y(this,tt)[tt]!==t&&(y.getInstance().printInfoLogs("BpkPlayerMgr","Player "+Y(this,tt)[tt].getName()+" detached"),Y(this,tt)[tt].detachPlayer()),Y(this,tt)[tt]!==t?Y(this,tt)[tt]=t:void 0!==t&&y.getInstance().printInfoLogs("BpkPlayerMgr","Player "+Y(this,tt)[tt].getName()+" already attached"),void 0!==t&&y.getInstance().printInfoLogs("BpkPlayerMgr","Player "+t.getName()+" attached")}},{key:"getPlayerAdapter",value:function(){return Y(this,tt)[tt]}}],[{key:"getInstance",value:function(){return Y(t,X)[X]||(Y(t,X)[X]=new t),Y(t,X)[X]}}]),t}();function nt(t){return(nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Object.defineProperty(et,X,{writable:!0,value:void 0});var it=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,(n=[{key:"typeParameter",value:function(t,e,n){return nt(t)===e||(y.getInstance().printErrorLogs("BpkValidator",n),!1)}},{key:"typeOrUndefinedParameter",value:function(t,e,n){return nt(t)===e||void 0===t||(y.getInstance().printErrorLogs("BpkValidator",n),!1)}},{key:"typeOrNullParameter",value:function(t,e,n){return nt(t)===e||null===t||(y.getInstance().printErrorLogs("BpkValidator",n),!1)}},{key:"stringNonEmpty",value:function(t,e){return"string"==typeof t&&t.length>0||(y.getInstance().printErrorLogs("BpkValidator",e),!1)}},{key:"toBkAString",value:function(t){return void 0!==t&&"string"==typeof t?t.replace(/\n/g,"").replace(/\t/g,"").replace(/\r/g,""):t}}])&&rt(e,n),t}();function ot(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n(143),n(174),n(175),n(182),n(183),n(184),n(185),n(186),n(187),n(188),n(189),n(190),n(191),n(192),n(193),n(195),n(196),n(197),n(198),n(199),n(200),n(201),n(202),n(203),n(204),n(205);var st=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.index=void 0,this.buffer=void 0,this.index=0,this.buffer=new Uint8Array(e)}var e,n;return e=t,(n=[{key:"put",value:function(t){return this.buffer[this.index++]=t,this}},{key:"putChar",value:function(t){return this.buffer[this.index++]=(65280&t)>>8,this.buffer[this.index++]=255&t,this}},{key:"putTimestamp",value:function(t){return this.buffer[this.index++]=(16711680&t)>>16,this.buffer[this.index++]=(65280&t)>>8,this.buffer[this.index++]=255&t,this}},{key:"putArray",value:function(t){return this.buffer.length>=this.index+t.length&&(this.buffer.set(t,this.index),this.index+=t.length),this}},{key:"putByteBuffer",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.buffer.length,n=t.buffer;return this.buffer.length>=this.index+e&&(this.buffer.set(n,this.index,e),this.index+=e),this}},{key:"increment",value:function(t){return this.buffer[t]++,this}},{key:"set",value:function(t,e){return this.buffer[e]=t,this}},{key:"setChar",value:function(t,e){return this.buffer[e]=(65280&t)>>8,this.buffer[e+1]=255&t,this}},{key:"setTimestamp",value:function(t,e){return this.buffer[e]=(16711680&t)>>16,this.buffer[e+1]=(65280&t)>>8,this.buffer[e+2]=255&t,this}},{key:"shift",value:function(t){return this.buffer.copyWithin(t+1,t),this.index++,this}},{key:"data",value:function(){return this.buffer}},{key:"base64",value:function(){return m.bufferToBase64(this)}},{key:"length",value:function(){return this.index}},{key:"capacity",value:function(){return this.buffer.length}},{key:"remaining",value:function(){return this.capacity()-this.length()}},{key:"toString",value:function(){return m.bufferToString(this.buffer,this.index)+"(length:"+this.length()+")"}}])&&ot(e.prototype,n),t}();function at(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}st.EMPTY=new st(0);var ut=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,(n=[{key:"formatDate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,e="";t<0&&(t*=-1,e="-");var n=t.getDate()<=9?"0"+t.getDate():t.getDate(),r=t.getMonth()+1<=9?"0"+(t.getMonth()+1):t.getMonth()+1,i=t.getHours()<=9?"0"+t.getHours():t.getHours(),o=t.getMinutes()<=9?"0"+t.getMinutes():t.getMinutes(),s=t.getSeconds()<=9?"0"+t.getSeconds():t.getSeconds(),a=String(t.getMilliseconds());return 1===a.length?a="00"+a:2===a.length&&(a="0"+a),e+r+"-"+n+" "+i+":"+o+":"+s+"."+a}},{key:"formatTime",value:function(t){var e="";t<0&&(t*=-1,e="-");var n=t%1e3,r=Math.floor(t/1e3%60),i=Math.floor(t/6e4%60),o=Math.floor(t/36e5%24),s=o<=9?"0"+o:o,a=i<=9?"0"+i:i,u=r<=9?"0"+r:r,c=String(n);return 1===c.length?c="00"+c:2===c.length&&(c="0"+c),e+s+":"+a+":"+u+"."+c}}])&&at(e,n),t}();function ct(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var lt=[3,5,6,7,8,9,10,11,14,17,18,19],ft=[1],ht=[13],dt=[4],pt=[12],vt=[2],yt=[15],gt=[16],Et=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.eventId=void 0,this.eventDate=void 0,this.eventData=void 0,this.startStopEvent=void 0,this.startEventId=void 0,this.stopEventId=void 0,this.triggerStartEventId=void 0,this.keepLastOnly=void 0,this.attachEventId=void 0,this.attachMaxDurationBeforeStart=void 0,this.startEvent=void 0,this.stopEvent=void 0,this.attachedEvent=void 0,this.compressed=void 0,this.compressedData=void 0,this.eventId=e,this.eventDate=Date.now(),this.eventData={},this.startStopEvent=!1,this.startEventId=0,this.stopEventId=0,this.triggerStartEventId=0,this.keepLastOnly=!1,this.attachEventId=0,this.attachMaxDurationBeforeStart=-1,this.startEvent=null,this.stopEvent=null,this.attachedEvent=null,this.addDataSizeInTimeline=!1,this.compressed=!1,this.compressedData=void 0,this.updateMetadata()}var e,n;return e=t,(n=[{key:"updateMetadata",value:function(){switch(this.startStopEvent=!1,this.startEventId=0,this.stopEventId=0,this.triggerStartEventId=0,this.keepLastOnly=!1,this.attachEventId=0,this.attachMaxDurationBeforeStart=-1,this.eventId){case 0:break;case 1:this.startStopEvent=!0,this.startEventId=1,this.stopEventId=2,this.addDataSizeInTimeline=!0;break;case 2:this.startStopEvent=!0,this.startEventId=1,this.stopEventId=2;break;case 3:this.startStopEvent=!1,this.attachEventId=1;break;case 4:this.startStopEvent=!1,this.keepLastOnly=!0,this.attachEventId=3;break;case 5:case 6:this.startStopEvent=!0,this.startEventId=5,this.stopEventId=6;break;case 7:this.startStopEvent=!1;break;case 8:this.startStopEvent=!0,this.startEventId=8,this.stopEventId=9;break;case 9:this.startStopEvent=!0,this.startEventId=8,this.stopEventId=9,this.triggerStartEventId=7;break;case 10:this.startStopEvent=!0,this.startEventId=10,this.stopEventId=11;break;case 11:this.startStopEvent=!0,this.startEventId=10,this.stopEventId=11,this.triggerStartEventId=7,this.attachEventId=12,this.attachMaxDurationBeforeStart=It.MAX_TIME_BETWEEN_SEEK_AND_REBUFFERING;break;case 12:case 13:this.startStopEvent=!1;break;case 14:this.startStopEvent=!0,this.startEventId=14,this.stopEventId=15;break;case 15:this.startStopEvent=!0,this.startEventId=14,this.stopEventId=15,this.attachEventId=12,this.attachMaxDurationBeforeStart=0;break;case 16:case 17:this.startStopEvent=!1;break;case 18:case 19:this.startStopEvent=!1,this.addDataSizeInTimeline=!0}}},{key:"getEventName",value:function(){switch(this.eventId){case 0:return"None";case 1:return"Start";case 2:return"Stop";case 3:return"RedirectionEnd";case 4:return"FirstImage";case 5:return"Pause";case 6:return"Resume";case 7:return"BufferingStart";case 8:return"StallStart";case 9:return"StallStop";case 10:return"RebufferingStart";case 11:return"RebufferingStop";case 12:return"Seek";case 13:return"LayerSwitch";case 14:return"AdBreakStart";case 15:return"AdBreakStop";case 16:return"NetworkAvailable";case 17:return"NetworkLost";case 18:return"Mute";case 19:return"Unmute"}return""}},{key:"isStartEvent",value:function(){return this.startStopEvent&&this.eventId===this.startEventId}},{key:"isStopEvent",value:function(){return this.startStopEvent&&this.eventId===this.stopEventId}},{key:"addEventData",value:function(t,e){"string"==typeof t&&(this.eventData[t]=e)}},{key:"toData",value:function(t){for(var e=Math.abs(this.eventDate-t)/100,n=m.floor(e/65535),r=e%65535,i=Object.keys(this.eventData).length,o=3*n+1+2+2*i+(this.addDataSizeInTimeline?1:0),s=new st(o),a=0;a<n;a++)s.put(0),s.put(255),s.put(255);switch(s.put(this.eventId),s.putChar(r),this.addDataSizeInTimeline&&s.put(2*i),this.eventId){case 1:var u=parseInt(this.eventData.networkType,10),c=parseInt(this.eventData.muteState,10);s.putChar(u),s.putChar(c);break;case 2:var l=parseInt(this.eventData.statusCode,10);s.putChar(l);break;case 4:var f=parseInt(this.eventData.bitrate,10),h=parseInt(this.eventData.position,10);s.putChar(f),s.putChar(h);break;case 12:var d=parseInt(this.eventData.positionStart,10),p=parseInt(this.eventData.positionEnd,10);s.putChar(d),s.putChar(p);break;case 13:var v=parseInt(this.eventData.bitrate,10);s.putChar(v);break;case 15:var y=parseInt(this.eventData.progress,10);s.putChar(y);break;case 16:var g=parseInt(this.eventData.state,10);s.putChar(g);break;case 18:case 19:s.putChar(0)}return s}},{key:"formatDate",value:function(t){return ut.formatDate(new Date(t))}},{key:"print",value:function(){for(var t in y.getInstance().printVerboseLogs("BpkSessionTrackerEvent","   |"),y.getInstance().printVerboseLogs("BpkSessionTrackerEvent","   ├--\x3e "+this.getEventName()+" -> "+(!0===this.compressed?"compressed":"not compressed")+" -> "+this.eventDate),y.getInstance().printVerboseLogs("BpkSessionTrackerEvent","   |      date: "+this.formatDate(this.eventDate)),this.eventData)y.getInstance().printVerboseLogs("BpkSessionTrackerEvent","   |      "+t+": "+this.eventData[t]);this.isStartEvent()&&null!==this.stopEvent&&y.getInstance().printVerboseLogs("BpkSessionTrackerEvent","   |      stop event: "+this.stopEvent.getEventName()+" "+this.stopEvent.eventDate),this.isStopEvent()&&null!==this.startEvent&&y.getInstance().printVerboseLogs("BpkSessionTrackerEvent","   |      start event: "+this.startEvent.getEventName()+" "+this.startEvent.eventDate),null!==this.attachedEvent&&y.getInstance().printVerboseLogs("BpkSessionTrackerEvent","   |      attached event: "+this.attachedEvent.getEventName()+" "+this.attachedEvent.eventDate)}},{key:"toString",value:function(){return this.getEventName()+" ("+this.formatDate(this.eventDate)+")"}}])&&ct(e.prototype,n),t}();function St(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function bt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var mt=function t(e){bt(this,t),this.redirectionTime=void 0,this.startupTime=void 0,this.completion=void 0,this.playbackType=void 0,this.playbackDuration=void 0,this.sessionDuration=void 0,this.contentDuration=void 0,this.stallsNumber=void 0,this.maxStallDuration=void 0,this.totalStallsDuration=void 0,this.rebufferingsNumber=void 0,this.maxRebufferingDuration=void 0,this.totalRebufferingDuration=void 0,this.minBitrate=void 0,this.maxBitrate=void 0,this.averageBitrate=void 0,this.layerSwitchesNumber=void 0,this.timeSpentPerLayer=void 0,this.preStartupTime=void 0,void 0!==e?(this.redirectionTime=e.redirectionTime,this.startupTime=e.startupTime,this.completion=e.completion,this.playbackType=e.playbackType,this.playbackDuration=e.playbackDuration,this.sessionDuration=e.sessionDuration,this.contentDuration=e.contentDuration,this.stallsNumber=e.stallsNumber,this.maxStallDuration=e.maxStallDuration,this.totalStallsDuration=e.totalStallsDuration,this.rebufferingsNumber=e.rebufferingsNumber,this.maxRebufferingDuration=e.maxRebufferingDuration,this.totalRebufferingDuration=e.totalRebufferingDuration,this.minBitrate=e.minBitrate,this.maxBitrate=e.maxBitrate,this.averageBitrate=e.averageBitrate,this.layerSwitchesNumber=e.layerSwitchesNumber,this.timeSpentPerLayer=JSON.parse(JSON.stringify(e.timeSpentPerLayer)),this.preStartupTime=e.preStartupTime):(this.redirectionTime=0,this.startupTime=0,this.completion=0,this.playbackType="",this.playbackDuration=0,this.sessionDuration=0,this.contentDuration=0,this.stallsNumber=0,this.maxStallDuration=0,this.totalStallsDuration=0,this.rebufferingsNumber=0,this.maxRebufferingDuration=0,this.totalRebufferingDuration=0,this.minBitrate=0,this.maxBitrate=0,this.averageBitrate=0,this.layerSwitchesNumber=0,this.timeSpentPerLayer={},this.preStartupTime=0)};mt.PLAYBACK_TYPE_LIVE="LIVE",mt.PLAYBACK_TYPE_VOD="VOD";var kt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new mt;bt(this,t),this.metrics=void 0,this.watchingRanges=void 0,this.metrics=e,this.reset()}var e,n;return e=t,(n=[{key:"setRedirectionTime",value:function(t){return this.metrics.redirectionTime=t,this}},{key:"setStartupTime",value:function(t){return this.metrics.startupTime=t,this}},{key:"setSessionDuration",value:function(t){return this.metrics.sessionDuration=t,this}},{key:"setContentDuration",value:function(t){return this.metrics.contentDuration=t,this}},{key:"setPlaybackType",value:function(t){return this.metrics.playbackType=t,this}},{key:"setFirstLayer",value:function(t){return t>0&&(this.metrics.maxBitrate=t,this.metrics.minBitrate=t),this}},{key:"setPreStartupTime",value:function(t){return this.metrics.preStartupTime=t,this}},{key:"addTimeSpentPerLayer",value:function(t,e){if(t>0){var n=this.metrics.timeSpentPerLayer[t];void 0===n&&(n=0),n+=e,this.metrics.timeSpentPerLayer[t]=n,this.metrics.maxBitrate<t&&(this.metrics.maxBitrate=t),(this.metrics.minBitrate>t||0===this.metrics.minBitrate)&&(this.metrics.minBitrate=t)}return this}},{key:"addLayerSwitch",value:function(){return this.metrics.layerSwitchesNumber++,this}},{key:"addPlaybackDuration",value:function(t){return this.metrics.playbackDuration+=t,this}},{key:"addWatchingRange",value:function(t,e){return t<e&&(y.getInstance().printVerboseLogs("BpkMetrics","Add watching range, duration "+(e-t)+"ms"),this.watchingRanges.push({start:t,end:e,duration:e-t})),this}},{key:"addStall",value:function(t){return this.metrics.stallsNumber++,this.metrics.totalStallsDuration+=t,this.metrics.maxStallDuration<t&&(this.metrics.maxStallDuration=t),this}},{key:"addRebuffering",value:function(t){return this.metrics.rebufferingsNumber++,this.metrics.totalRebufferingDuration+=t,this.metrics.maxRebufferingDuration<t&&(this.metrics.maxRebufferingDuration=t),this}},{key:"clone",value:function(){var e=new t(new mt(this.metrics));return e.watchingRanges=JSON.parse(JSON.stringify(this.watchingRanges)),e}},{key:"computeCompletion",value:function(){if(this.metrics.playbackType===mt.PLAYBACK_TYPE_LIVE||0===this.metrics.contentDuration)return 1e3;var t=JSON.parse(JSON.stringify(this.watchingRanges)),e=t.slice(0);if(1===t.length)return Math.floor(1e3*e[0].duration/this.metrics.contentDuration);if(0===t.length)return 0;var n=[],r=null;e=e.sort((function(t,e){return parseInt(t.start,10)>parseInt(e.start,10)?1:parseInt(t.start,10)<parseInt(e.start,10)?-1:0})),n.push(e[0]);for(var i=1;i<e.length;i++)r=n[n.length-1],parseInt(r.end,10)<parseInt(e[i].start,10)?n.push(e[i]):parseInt(r.end,10)<parseInt(e[i].end,10)&&(r.end=parseInt(e[i].end,10),r.duration=r.end-r.start,n.pop(),n.push(r));for(var o=0,s=0;s<n.length;s++)n[s].duration=parseInt(n[s].end,10)-parseInt(n[s].start,10),o+=parseInt(n[s].duration,10);return this.watchingRanges=n,Math.floor(1e3*o/this.metrics.contentDuration)}},{key:"build",value:function(){var t=0,e=0;for(var n in this.metrics.timeSpentPerLayer){var r=this.metrics.timeSpentPerLayer[n];t+=n*r,e+=r}return 0!==e&&(this.metrics.averageBitrate=Math.round(t/e)),this.metrics.completion=this.computeCompletion(),this.metrics.startupTime+=this.metrics.preStartupTime,this.metrics}},{key:"reset",value:function(){return this.watchingRanges=[],this}}])&&St(e.prototype,n),t}();function At(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var It=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.session=void 0,this.builder=void 0,this.playerAdapter=void 0,this.timeline=void 0,this.started=void 0,this.playing=void 0,this.buffering=void 0,this.seeking=void 0,this.bitrate=void 0,this.redirectionStartDate=void 0,this.playingStartDate=void 0,this.bufferingStartDate=void 0,this.lastLayerSwitchDate=void 0,this.lastSeekDate=void 0,this.playOnNextBufferingEnd=void 0,this.startPosition=void 0,this.session=e,this.builder=new kt,this.playerAdapter=n,this.timeline=this.session.sessionReport.timeline,this.started=!1,this.playing=!1,this.buffering=!1,this.seeking=!1,this.bitrate=-1,this.redirectionStartDate=0,this.playingStartDate=0,this.bufferingStartDate=0,this.lastLayerSwitchDate=0,this.lastSeekDate=0,this.playOnNextBufferingEnd=!1,this.startPosition=0}var e,n;return e=t,(n=[{key:"onStart",value:function(){this.redirectionStartDate=Date.now()}},{key:"onRedirectionEnd",value:function(){this.builder.setRedirectionTime(Date.now()-this.redirectionStartDate),this.playingStartDate=Date.now()}},{key:"onFirstImage",value:function(t,e){y.getInstance().printInfoLogs("BpkMetricsMgr","Streaming session started ("+t+"kpbs,"+ut.formatTime(e)+")",this.session.id),this.started=!0,this.playing=!0,this.startPosition=e,this.builder.setContentDuration(this.playerAdapter.getDuration()).setPlaybackType(this.playerAdapter.getDuration()<=0?mt.PLAYBACK_TYPE_LIVE:mt.PLAYBACK_TYPE_VOD),this.builder.setStartupTime(Date.now()-this.redirectionStartDate),this.playingStartDate=Date.now(),this.builder.setFirstLayer(t),this.bitrate=t,this.lastLayerSwitchDate=Date.now()}},{key:"onLayerSwitch",value:function(t){y.getInstance().printDebugLogs("BpkMetricsMgr","Player changed layer to "+t+"kbps",this.session.id),this.started&&(this.builder.addTimeSpentPerLayer(this.bitrate,Date.now()-this.lastLayerSwitchDate),this.lastLayerSwitchDate=Date.now(),this.bitrate!==t&&this.bitrate>0&&(y.getInstance().printDebugLogs("BpkMetricsMgr","Player changed layer, before: "+this.bitrate+"kbps, now: "+t+"kbps",this.session.id),this.timeline.pushEventBitrate(13,t),this.builder.addLayerSwitch())),this.bitrate=t}},{key:"onPause",value:function(){this.playing&&(y.getInstance().printDebugLogs("BpkMetricsMgr","Player is paused",this.session.id),this.timeline.pushEvent(5),this.playing=!1,this.buffering||this.builder.addPlaybackDuration(Date.now()-this.playingStartDate),this.builder.addWatchingRange(this.startPosition,this.playerAdapter.getPosition()))}},{key:"onResume",value:function(){this.started&&!this.playing&&(y.getInstance().printDebugLogs("BpkMetricsMgr","Player is resumed",this.session.id),this.timeline.pushEvent(6),this.playing=!0,this.buffering=!1,this.playingStartDate=Date.now())}},{key:"onBufferingStart",value:function(){if(!this.buffering&&this.started){y.getInstance().printDebugLogs("BpkMetricsMgr","Player is buffering",this.session.id),this.timeline.pushEvent(7);var e=Date.now();this.buffering=!0,this.seeking&&e-this.lastSeekDate>t.MAX_TIME_BETWEEN_SEEK_AND_REBUFFERING&&(this.seeking=!1),this.bufferingStartDate=e,this.playOnNextBufferingEnd=!1,this.playing&&this.builder.addPlaybackDuration(e-this.playingStartDate)}}},{key:"onBufferingEnd",value:function(t){var e=Date.now();t&&this.playOnNextBufferingEnd&&!this.buffering&&(this.playingStartDate=e,this.playOnNextBufferingEnd=!1),this.started&&this.bufferingStartDate>0&&(this.buffering=!1,t?this.playingStartDate=e:this.playOnNextBufferingEnd=!0,this.seeking?(this.seeking=!1,this.session.notifyRebufferingEnd()):this.session.notifyStallEnd(),this.bufferingStartDate=0)}},{key:"onStallEnd",value:function(){var t=Date.now()-this.bufferingStartDate;this.builder.addStall(t),this.timeline.pushEvent(9),y.getInstance().printDebugLogs("BpkMetricsMgr","Player stalled for "+t+"ms",this.session.id)}},{key:"onRebufferingEnd",value:function(){var t=Date.now()-this.bufferingStartDate;this.builder.addRebuffering(t),this.timeline.pushEvent(11),y.getInstance().printDebugLogs("BpkMetricsMgr","Player buffered for "+t+"ms",this.session.id)}},{key:"onSeek",value:function(t,e){y.getInstance().printDebugLogs("BpkMetricsMgr","Player seeked from "+ut.formatTime(t)+" to "+ut.formatTime(e),this.session.id),this.timeline.pushEventPositionStartEnd(12,t,e),this.builder.addWatchingRange(this.startPosition,t),this.startPosition=e,this.seeking=!0,this.lastSeekDate=Date.now()}},{key:"onStop",value:function(t){if(this.started){var e=Date.now();this.playing&&!this.buffering&&this.builder.addPlaybackDuration(e-this.playingStartDate),this.buffering&&this.onBufferingEnd(!1),this.playing&&(this.builder.addWatchingRange(this.startPosition,this.playerAdapter.getPosition()),this.playing=!1),this.builder.setSessionDuration(e-this.redirectionStartDate).addTimeSpentPerLayer(this.bitrate,e-this.lastLayerSwitchDate),this.started=!1}}},{key:"onStartSessionReportUpdateRequested",value:function(t){t.metrics=this.builder.build()}},{key:"onKeepaliveSessionReportUpdateRequested",value:function(t){var e=Date.now(),n=this.builder.clone();if(this.playing&&!this.buffering&&n.addPlaybackDuration(e-this.playingStartDate),this.started&&this.bufferingStartDate>0){var r=Date.now()-this.bufferingStartDate;this.seeking?n.addRebuffering(r):n.addStall(r)}this.playing&&n.addWatchingRange(this.startPosition,this.playerAdapter.getPosition()),n.setSessionDuration(e-this.redirectionStartDate).addTimeSpentPerLayer(this.bitrate,e-this.lastLayerSwitchDate);var i=this.session.smartLib.getParameters().customParameters.pre_startup_time,o=0;void 0===i||isNaN(i)||(o=parseInt(i,10)),n.setPreStartupTime(o),t.metrics=n.build()}},{key:"onEndSessionReportUpdateRequested",value:function(t){var e=Date.now();this.builder.setSessionDuration(e-this.redirectionStartDate);var n=this.session.smartLib.getParameters().customParameters.pre_startup_time,r=0;void 0===n||isNaN(n)||(r=parseInt(n,10)),this.builder.setPreStartupTime(r),t.metrics=this.builder.build()}}])&&At(e.prototype,n),t}();function Dt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}It.MAX_TIME_BETWEEN_SEEK_AND_REBUFFERING=1e3;var Rt=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.timeline=void 0,this.minIndex=void 0,this.initialBitrate=void 0,this.builder=void 0,this.summaryDuration=void 0,this.pauseDuration=void 0,this.nbNetworkDisconnected=void 0,this.nbNetworkWifi=void 0,this.nbNetworkMobile=void 0,this.nbNetworkEthernet=void 0,this.lastNetworkState=void 0,this.muteDuration=void 0,this.lastMuteState=void 0,this.timeline=e,this.minIndex=n,this.initialBitrate=void 0,this.builder=void 0,this.summaryDuration=0,this.pauseDuration=0,this.nbNetworkDisconnected=0,this.nbNetworkWifi=0,this.nbNetworkMobile=0,this.nbNetworkEthernet=0,this.lastNetworkState=void 0,this.muteDuration=0,this.lastMuteState=void 0,this.init()}var e,n;return e=t,(n=[{key:"init",value:function(){for(var t=this.minIndex;t>=0;t--){var e=this.timeline.events[t];switch(e.eventId){case 13:case 4:void 0===this.initialBitrate&&(this.initialBitrate=parseInt(e.eventData.bitrate,10));break;case 1:void 0===this.lastNetworkState&&(this.lastNetworkState=parseInt(e.eventData.networkType,10)),void 0===this.lastMuteState&&(this.lastMuteState=parseInt(e.eventData.muteState,10));break;case 16:void 0===this.lastNetworkState&&(this.lastNetworkState=parseInt(e.eventData.state,10));break;case 17:void 0===this.lastNetworkState&&(this.lastNetworkState=0);break;case 18:void 0===this.lastMuteState&&(this.lastMuteState=1);break;case 19:void 0===this.lastMuteState&&(this.lastMuteState=0)}}void 0!==this.initialBitrate&&0!==this.initialBitrate||(this.initialBitrate=-1),void 0===this.lastNetworkState&&(this.lastNetworkState=1),void 0===this.lastMuteState&&(this.lastMuteState=0)}},{key:"update",value:function(t){if(!(this.minIndex>=this.timeline.events.length||t>=this.timeline.events.length)){var e,n,r,i=this.timeline.events[this.minIndex],o=this.timeline.events[t],s=this.initialBitrate,a=i.eventDate,u=1===this.lastMuteState?i.eventDate:-1;this.builder=new kt,this.summaryDuration=o.eventDate-i.eventDate,this.pauseDuration=0,this.nbNetworkDisconnected=0,this.nbNetworkWifi=0,this.nbNetworkMobile=0,this.nbNetworkEthernet=0,this.muteDuration=0;for(var c=this.minIndex;c<=t;c++){var l=this.timeline.events[c];switch(l.eventId){case 5:!1!==e&&void 0!==e||(null!==l.stopEvent&&l.stopEvent.eventDate<=o.eventDate&&(this.pauseDuration+=l.stopEvent.eventDate-l.eventDate),e=!0);break;case 6:void 0===e&&(this.pauseDuration+=l.eventDate-i.eventDate),e=!1;break;case 8:!1!==n&&void 0!==n||(null!==l.stopEvent&&l.stopEvent.eventDate<=o.eventDate&&this.builder.addStall(l.stopEvent.eventDate-l.eventDate),n=!0);break;case 9:void 0===n&&this.builder.addStall(l.eventDate-i.eventDate),n=!1;break;case 10:!1!==r&&void 0!==r||(null!==l.stopEvent&&l.stopEvent.eventDate<=o.eventDate&&this.builder.addRebuffering(l.stopEvent.eventDate-l.eventDate),r=!0);break;case 11:void 0===r&&this.builder.addRebuffering(l.eventDate-i.eventDate),r=!1;break;case 13:this.builder.addLayerSwitch(),-1!==s&&this.builder.addTimeSpentPerLayer(s,l.eventDate-a),s=parseInt(l.eventData.bitrate,10),a=l.eventDate;break;case 16:this.lastNetworkState=parseInt(l.eventData.state,10),this.lastNetworkState>=10&&this.lastNetworkState<20?this.nbNetworkWifi++:this.lastNetworkState>=20&&this.lastNetworkState<30?this.nbNetworkMobile++:this.lastNetworkState>=30&&this.lastNetworkState<40&&this.nbNetworkEthernet++;break;case 17:this.lastNetworkState=0,this.nbNetworkDisconnected++;break;case 18:this.lastMuteState=1,u=l.eventDate;break;case 19:this.lastMuteState=0,-1!==u&&(this.muteDuration+=l.eventDate-u,u=-1)}}-1!==s&&this.builder.addTimeSpentPerLayer(s,o.eventDate-a),-1!==u&&(this.muteDuration+=o.eventDate-u),this.builder.build()}}},{key:"data",value:function(){if(void 0===this.builder)return st.EMPTY;var e=new st(t.BUFFER_SIZE),n=this.builder.metrics;return e.put(144).putChar(Math.round(this.summaryDuration/1e3)).put(t.BUFFER_SIZE-2-1-1).putChar(this.pauseDuration/100).put(n.stallsNumber).putChar(n.totalStallsDuration/100).put(n.rebufferingsNumber).putChar(n.totalRebufferingDuration/100).put(n.layerSwitchesNumber).putChar(n.minBitrate).putChar(n.maxBitrate).putChar(n.averageBitrate).put(this.nbNetworkDisconnected).put(this.nbNetworkWifi).put(this.nbNetworkMobile).put(this.nbNetworkEthernet).putChar(this.lastNetworkState).putChar(Math.round(this.muteDuration/1e3)).put(this.lastMuteState),e}},{key:"toString",value:function(){if(void 0===this.builder)return"no data";var t=this.builder.metrics;return this.summaryDuration+", "+this.pauseDuration+", "+t.minBitrate+", "+t.maxBitrate+", "+t.layerSwitchesNumber+", "+t.averageBitrate+", "+t.stallsNumber+", "+t.totalStallsDuration+", "+t.rebufferingsNumber+", "+t.totalRebufferingDuration+", "+this.nbNetworkDisconnected+", "+this.nbNetworkWifi+", "+this.nbNetworkMobile+", "+this.nbNetworkEthernet+", "+this.lastNetworkState+", "+this.muteDuration+", "+this.lastMuteState}}])&&Dt(e.prototype,n),t}();function Tt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Rt.BUFFER_SIZE=28;var Nt=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.DEFAULT_BUFFER_SIZE,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.DEFAULT_END_EVENTS_DURATION,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.DEFAULT_END_EVENTS_NUMBER;Tt(this,t),this.timeline=void 0,this.maxBufferSize=void 0,this.maxEndEventsDuration=void 0,this.maxEndEventsNumber=void 0,this.events=void 0,this.uncompressedData=void 0,this.uncompressedDataFull=void 0,this.compressedStartData=void 0,this.minSummaryIndex=void 0,this.maxEndBufferSize=void 0,this.summary=void 0,this.maxBufferSize=n,this.maxEndEventsDuration=r,this.maxEndEventsNumber=i,this.timeline=e,this.events=this.timeline.events,this.uncompressedData=new st(this.maxBufferSize),this.uncompressedDataFull=!1,this.compressedStartData=void 0,this.minSummaryIndex=0,this.maxEndBufferSize=this.maxBufferSize,this.summary=void 0}var e,n;return e=t,(n=[{key:"onEventAdded",value:function(t){if(!this.uncompressedDataFull){var e=t;this.events.length>=2&&(e=this.events[this.events.length-2]),t.compressedData=t.toData(e.eventDate),t.compressed=!0,t.compressedData.capacity()<=this.uncompressedData.remaining()?this.uncompressedData.putByteBuffer(t.compressedData):(this.uncompressedDataFull=!0,this.compressedStartData=new st(this.maxBufferSize))}}},{key:"onEventUpdated",value:function(){this.uncompressedData=new st(this.maxBufferSize);for(var t=0;t<this.events.length;t++)void 0!==this.events[t].compressedData&&this.uncompressedData.putByteBuffer(this.events[t].compressedData)}},{key:"process",value:function(){var t=Date.now();if(!this.uncompressedDataFull)return y.getInstance().printDebugLogs("BpkSessionTrackerTimeline","Timeline encoder generated uncompressed data ("+this.events.length+" events, "+this.uncompressedData.length()+" bytes)"),this.uncompressedData;for(var e,n="",r=[],i=0,o=this.events.length-1;o>=0;o--){var s=this.events[o];if(!(t-s.eventDate<this.maxEndEventsDuration&&r.length<this.maxEndEventsNumber)){e=o;break}var a=void 0;if(o<this.events.length-1){var u=this.events[o+1];a=s.toData(u.eventDate)}else a=s.toData(s.eventDate);if(!(i+a.length()<=this.maxEndBufferSize)){e=o;break}r.push(a),i+=a.length()}if(0===this.compressedStartData.length()){this.minSummaryIndex=e;for(var c=this.maxBufferSize-Rt.BUFFER_SIZE-i,l=0;l<e;l++){var f=this.events[l];if(this.compressedStartData.length()+f.compressedData.length()>c){this.minSummaryIndex=l;break}this.compressedStartData.putByteBuffer(f.compressedData)}this.maxEndBufferSize=this.compressedStartData.remaining()-Rt.BUFFER_SIZE,this.uncompressedData=void 0,n+="first iteration, "}var h=new st(this.maxBufferSize);if(h.putByteBuffer(this.compressedStartData,this.compressedStartData.length()),this.minSummaryIndex===e)h.put(145),n+="no summary";else{void 0===this.summary&&(this.summary=new Rt(this.timeline,this.minSummaryIndex)),this.summary.update(e);var d=this.summary.data();h.putByteBuffer(d),n+="summary {"+this.summary.toString()+"}"}for(var p=0;p<r.length;p++)h.putByteBuffer(r[p]);return y.getInstance().printDebugLogs("BpkSessionTrackerTimeline","Timeline encoder generated compressed data ("+this.events.length+" events before encoding, "+(this.minSummaryIndex+r.length)+" events after encoding, "+h.length()+" bytes, ~"+(Date.now()-t)+"ms, "+n+")"),h}},{key:"extend",value:function(){if(this.uncompressedDataFull)y.getInstance().printWarnLogs("BpkSessionTrackerTimeline","Failed to extend size from "+t.DEFAULT_BUFFER_SIZE+" to 768");else{this.maxBufferSize=768,this.maxEndEventsDuration=4e4,this.maxEndEventsNumber=40;var e=this.uncompressedData;this.uncompressedData=new st(this.maxBufferSize),this.uncompressedData.putByteBuffer(e,e.length()),y.getInstance().printVerboseLogs("BpkSessionTrackerTimeline","Extended size from "+t.DEFAULT_BUFFER_SIZE+" to 768")}}}])&&_t(e.prototype,n),t}();function Lt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Nt.DEFAULT_BUFFER_SIZE=384,Nt.DEFAULT_END_EVENTS_DURATION=15e3,Nt.DEFAULT_END_EVENTS_NUMBER=20;var Ot=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.session=void 0,this.startDate=void 0,this.stopDate=void 0,this.events=void 0,this.firstImageWithoutBitrateEvent=void 0,this.encoder=void 0,this.startDate=null,this.stopDate=null,this.events=[],this.firstImageWithoutBitrateEvent=null,this.encoder=new Nt(this)}var e,n;return e=t,(n=[{key:"pushEvent",value:function(t){if(this.checkType(t,lt)){var e=this.createEvent(t);this.encoder.onEventAdded(e)}}},{key:"pushEventStart",value:function(t,e,n){if(this.checkType(t,ft)){var r=this.createEvent(t);r.addEventData("networkType",e),r.addEventData("muteState",n),this.encoder.onEventAdded(r)}}},{key:"pushEventBitrate",value:function(t,e){if(this.checkType(t,ht)){var n=this.createEvent(t);n.addEventData("bitrate",e),null!==this.firstImageWithoutBitrateEvent&&(this.firstImageWithoutBitrateEvent.addEventData("bitrate",e),this.firstImageWithoutBitrateEvent=null),this.encoder.onEventAdded(n)}}},{key:"pushEventBitratePosition",value:function(t,e,n){if(this.checkType(t,dt)){var r=this.createEvent(t);r.addEventData("bitrate",e),r.addEventData("position",n),4===t&&e<=0&&(this.firstImageWithoutBitrateEvent=r),this.encoder.onEventAdded(r)}}},{key:"pushEventPositionStartEnd",value:function(t,e,n){if(this.checkType(t,pt)){var r=this.createEvent(t);r.addEventData("positionStart",e),r.addEventData("positionEnd",n),this.encoder.onEventAdded(r)}}},{key:"pushEventStatusCode",value:function(t,e){if(this.checkType(t,vt)){var n=this.createEvent(t);n.addEventData("statusCode",e),this.encoder.onEventAdded(n)}}},{key:"pushEventProgress",value:function(t,e){if(this.checkType(t,yt)){var n=this.createEvent(t);n.addEventData("progress",e),this.encoder.onEventAdded(n)}}},{key:"pushEventState",value:function(t,e){if(this.checkType(t,gt)){var n=this.createEvent(t);n.addEventData("state",e),this.encoder.onEventAdded(n)}}},{key:"createEvent",value:function(t){var e=new Et(t);return y.getInstance().printVerboseLogs("BpkSessionTrackerTimeline","Creating event "+e.getEventName()+"..."),this.applyKeepLastOnly(e),this.events.push(e),this.updateTimelineProperties(e),this.reconciliateStopWithStartEvent(e),e}},{key:"checkType",value:function(t,e){return e.indexOf(t)>=0||(y.getInstance().printVerboseLogs("BpkSessionTrackerTimeline","Can't push event '"+t+"' to timeline, invalid parameters"),!1)}},{key:"applyKeepLastOnly",value:function(t){if(t.keepLastOnly)for(var e=this.events.length-1;e>=0;e--)if(this.events[e].eventId===t.eventId)return this.events.splice(e,1),void this.encoder.onEventUpdated()}},{key:"attachEvent",value:function(t){if(t.attachEventId>0){var e=-1;null!==t.startEvent&&-1!==t.attachMaxDurationBeforeStart&&(e=t.startEvent.eventDate-t.attachMaxDurationBeforeStart);for(var n=this.events.length-1;n>=0;n--){var r=this.events[n];if(r.eventId===t.attachEventId&&(-1===e||r.eventDate>=e))return void(t.attachedEvent=r)}}}},{key:"updateTimelineProperties",value:function(t){switch(t.eventId){case 1:this.startDate=Date.now();break;case 2:this.stopDate=Date.now()}}},{key:"reconciliateStopWithStartEvent",value:function(t){if(t.isStopEvent())for(var e=this.events.length-1;e>=0;e--){var n=this.events[e];if(n.eventId===t.startEventId)return n.stopEvent=t,void(t.startEvent=n);if(n.eventId===t.triggerStartEventId)return n.eventId=t.startEventId,n.startStopEvent=!0,n.startEventId=t.startEventId,n.stopEventId=t.stopEventId,void 0!==n.compressedData&&(n.compressedData.set(n.eventId,0),this.encoder.onEventUpdated()),n.stopEvent=t,void(t.startEvent=n)}}},{key:"onStart",value:function(t,e){this.pushEventStart(1,t,e)}},{key:"onRedirectionEnd",value:function(){this.pushEvent(3)}},{key:"onFirstImage",value:function(t,e){this.pushEventBitratePosition(4,t,e)}},{key:"onStop",value:function(t){this.pushEventStatusCode(2,t)}},{key:"onForeground",value:function(){y.getInstance().printDebugLogs("BpkSessionTrackerTimeline","Received event onForeground but ignored")}},{key:"onBackground",value:function(){y.getInstance().printDebugLogs("BpkSessionTrackerTimeline","Received event onBackground but ignored")}},{key:"onNetworkAvailable",value:function(t){y.getInstance().printVerboseLogs("BpkSessionTrackerTimeline","Received event onNetworkAvailable type:"+t),this.pushEventState(16,t)}},{key:"onNetworkLost",value:function(){y.getInstance().printDebugLogs("BpkSessionTrackerTimeline","Received event onNetworkLost"),this.pushEvent(17)}},{key:"onMute",value:function(){y.getInstance().printDebugLogs("BpkSessionTrackerTimeline","Received event onMute"),this.pushEvent(18)}},{key:"onUnmute",value:function(){y.getInstance().printDebugLogs("BpkSessionTrackerTimeline","Received event onUnmute"),this.pushEvent(19)}},{key:"data",value:function(){return this.encoder.process()}},{key:"formatDate",value:function(t){return ut.formatDate(new Date(t))}},{key:"print",value:function(){y.getInstance().printVerboseLogs("BpkSessionTrackerTimeline","Timeline (startDate:"+this.formatDate(this.startDate)+", stopDate:"+this.formatDate(this.stopDate)+")");for(var t=0;t<this.events.length;t++)this.events[t].print()}},{key:"toString",value:function(){for(var t=[],e=0;e<this.events.length;e++)t.push(this.events[e].toString());return t.join(", ")}}])&&Lt(e.prototype,n),t}();function Pt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var wt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.active=void 0,this.timeout=void 0,this.nonce=void 0,this.active=!0,this.timeout=!1}var e,n;return e=t,(n=[{key:"setNonce",value:function(t){this.nonce=t,this.active=!1}},{key:"generateNonce",value:function(){var t=this;N.getInstance().asyncNonce(5e3,(function(e){t.setNonce(e.nonce)}),(function(){t.timeout=!0}))}},{key:"getNonce",value:function(){var t=this;return void 0===this.nonce&&!0===this.active?new Promise((function(e,n){N.getInstance().waitNonce(5e3,(function(n){t.setNonce(n.nonce),e(t.nonce)}),(function(){t.active=!1,t.timeout=!0,e(t.nonce)}))})):new Promise((function(e,n){e(t.nonce)}))}}])&&Pt(e.prototype,n),t}();function Ct(t){return(Ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mt(t,e){return(Mt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Bt(t,e){return!e||"object"!==Ct(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xt(t){return(xt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ut(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function jt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ft(t,e,n){return e&&jt(t.prototype,e),n&&jt(t,n),t}n(150),n(39),n(30),n(26),n(208);var Gt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Mt(t,e)}(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=xt(t);if(e){var i=xt(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Bt(this,n)}}(n);function n(t,r){var i,o;return Ut(this,n),(o=e.call(this,r)).session=void 0,o.adTrackingManager=void 0,o.adListener=void 0,o.session=t,o.adTrackingManager=t.adTrackingManager,o.adListener=null===(i=t.adSession)||void 0===i?void 0:i.adEventsListener,o}return Ft(n,[{key:"process",value:function(){var t=this.url.substring(n.SMARTLIB_PREFIX.length).split("/");if(t[0]===n.AD_BREAKS_TYPE&&t.length>=3)return this.onAdBreak(t[1],t[2]);if(t[0]===n.AD_TRACKER_TYPE&&t.length>=5)return this.onAdTracker(t[1],t[2],t[3],t[4]);if(t[0]===n.AD_SKIP_TYPE&&t.length>=5){var e=parseInt(t[3],10),r=parseInt(t[4],10);if(Number.isInteger(e)&&Number.isInteger(r))return this.onAdSkip(t[1],t[2],e,r)}else y.getInstance().printDebugLogs("BpkAdLegacyTracker","Cannot parse event type with URL "+this.url);return!1}},{key:"onAdBreak",value:function(t,e){return t===n.AD_BREAKS_ACTION_BEGIN?(y.getInstance().printDebugLogs("BpkAdLegacyTracker","Ad breaks begin"),void 0!==this.adListener&&this.adListener.onAdBreakBegin(-1),this.adTrackingManager.notifyAdBreakBegin(e),!0):t===n.AD_BREAKS_ACTION_END&&(y.getInstance().printDebugLogs("BpkAdLegacyTracker","Ad breaks ended"),void 0!==this.adListener&&this.adListener.onAdBreakEnd(),this.adTrackingManager.notifyAdBreakEnd(e),!0)}},{key:"onAdTracker",value:function(t,e,r,i){switch(t){case n.AD_TRACKER_ACTION_BEGIN:return y.getInstance().printDebugLogs("BpkAdLegacyTracker","Ad start"),this.adTrackingManager.notifyAdBegin(e,r,i),this.adTrackingManager.notifyAdProgress(e,r,i,0),!0;case n.AD_TRACKER_ACTION_25:return y.getInstance().printDebugLogs("BpkAdLegacyTracker","Ad progress 25%"),this.adTrackingManager.notifyAdProgress(e,r,i,25),!0;case n.AD_TRACKER_ACTION_50:return y.getInstance().printDebugLogs("BpkAdLegacyTracker","Ad progress 50%"),this.adTrackingManager.notifyAdProgress(e,r,i,50),!0;case n.AD_TRACKER_ACTION_75:return y.getInstance().printDebugLogs("BpkAdLegacyTracker","Ad progress 75%"),this.adTrackingManager.notifyAdProgress(e,r,i,75),!0;case n.AD_TRACKER_ACTION_END:return y.getInstance().printDebugLogs("BpkAdLegacyTracker","Ad end"),this.adTrackingManager.notifyAdProgress(e,r,i,100),this.adTrackingManager.notifyAdEnd(e,r,i),!0}return!1}},{key:"onAdSkip",value:function(t,e,r,i){return t===n.AD_SKIP_ACTION_SKIPPABLE&&(y.getInstance().printDebugLogs("BpkAdLegacyTracker","Ad skippable"),void 0!==this.adListener&&this.adListener.onAdSkippable(r,i),this.adTrackingManager.notifyAdSkippable(e,r,i),!0)}}]),n}(function(){function t(e){Ut(this,t),this.url=void 0,this.url=e}return Ft(t,[{key:"process",value:function(){throw new Error("AdTracker is an abstract class")}}]),t}());function Ht(t){return(Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&function(t,e){(Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}(t,e)}function Yt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=qt(t);if(e){var i=qt(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Wt(this,n)}}function Wt(t,e){return!e||"object"!==Ht(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qt(t){return(qt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Kt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Qt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function zt(t,e,n){return e&&Qt(t.prototype,e),n&&Qt(t,n),t}Gt.SMARTLIB_PREFIX="http://smartlib.broadpeak.tv/",Gt.AD_BREAKS_TYPE="adbreaks",Gt.AD_BREAKS_ACTION_BEGIN="begin",Gt.AD_BREAKS_ACTION_END="end",Gt.AD_TRACKER_TYPE="adtracker",Gt.AD_TRACKER_ACTION_BEGIN="progress_begin",Gt.AD_TRACKER_ACTION_25="progress_25",Gt.AD_TRACKER_ACTION_50="progress_middle",Gt.AD_TRACKER_ACTION_75="progress_75",Gt.AD_TRACKER_ACTION_END="progress_end",Gt.AD_SKIP_TYPE="adskip",Gt.AD_SKIP_ACTION_SKIPPABLE="skippable";var Jt=function(){function t(){Kt(this,t)}return zt(t,[{key:"process",value:function(){throw new Error("AdTracker is an abstract class")}}]),t}(),Xt=function(t){Vt(n,t);var e=Yt(n);function n(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return Kt(this,n),(r=e.call(this)).url=void 0,r.sessionToken=void 0,r.adBreakId=void 0,r.url=t,r.sessionToken=i,r.adBreakId=o,r}return zt(n,[{key:"process",value:function(){return y.getInstance().printDebugLogs("BpkAdTracker","Requesting "+this.url),V.getInstance().adEvent(this.url),!0}}]),n}(Jt),$t=function(t){Vt(n,t);var e=Yt(n);function n(t,r,i){var o,s;return Kt(this,n),(s=e.call(this)).session=void 0,s.adTrackingManager=void 0,s.adListener=void 0,s.sessionToken=void 0,s.adBreakId=void 0,s.session=t,s.adTrackingManager=t.adTrackingManager,s.adListener=null===(o=t.adSession)||void 0===o?void 0:o.adEventsListener,s.sessionToken=r,s.adBreakId=i,s}return zt(n,[{key:"process",value:function(){throw new Error("AdSmartLibTracker is an abstract class")}}]),n}(Jt),Zt=function(t){Vt(n,t);var e=Yt(n);function n(t,r,i,o){var s;return Kt(this,n),(s=e.call(this,t,r,i)).adBreakData=void 0,s.adBreakData=o,s}return zt(n,[{key:"process",value:function(){y.getInstance().printDebugLogs("BpkAdTracker","Ad break data"),this.adTrackingManager.notifyAdBreakData(this.adBreakData)}}]),n}($t),te=function(t){Vt(n,t);var e=Yt(n);function n(t,r,i){var o;return Kt(this,n),(o=e.call(this,t,r,i)).adBreakEnd=void 0,o.position=void 0,o}return zt(n,[{key:"process",value:function(){y.getInstance().printDebugLogs("BpkAdTracker","Ad break begin"),void 0!==this.adListener&&this.adListener.onAdBreakBegin(this.position),this.adTrackingManager.notifyAdBreakBegin(this.sessionToken)}}]),n}($t),ee=function(t){Vt(n,t);var e=Yt(n);function n(t,r,i){return Kt(this,n),e.call(this,t,r,i)}return zt(n,[{key:"process",value:function(){y.getInstance().printDebugLogs("BpkAdTracker","Ad break ended"),void 0!==this.adListener&&this.adListener.onAdBreakEnd(),this.adTrackingManager.notifyAdBreakEnd(this.sessionToken)}}]),n}($t),ne=function(t){Vt(n,t);var e=Yt(n);function n(t,r,i,o){var s;return Kt(this,n),(s=e.call(this,t,r,i)).adData=void 0,s.adData=o,s}return zt(n,[{key:"process",value:function(){y.getInstance().printDebugLogs("BpkAdTracker","Ad data"),this.adTrackingManager.notifyAdData(this.adData)}}]),n}($t),re=function(t){Vt(n,t);var e=Yt(n);function n(t,r,i,o,s,a){var u;return Kt(this,n),(u=e.call(this,t,r,i)).creativeId=void 0,u.adId=void 0,u.adProgress=void 0,u.creativeId=o,u.adId=s,u.adProgress=a,u}return zt(n,[{key:"process",value:function(){switch(this.adProgress){case 0:y.getInstance().printDebugLogs("BpkAdTracker","Ad start"),this.adTrackingManager.notifyAdBegin(this.sessionToken,this.creativeId,this.adId),this.adTrackingManager.notifyAdProgress(this.sessionToken,this.creativeId,this.adId,0);break;case 25:y.getInstance().printDebugLogs("BpkAdTracker","Ad progress 25%"),this.adTrackingManager.notifyAdProgress(this.sessionToken,this.creativeId,this.adId,25);break;case 50:y.getInstance().printDebugLogs("BpkAdTracker","Ad progress 50%"),this.adTrackingManager.notifyAdProgress(this.sessionToken,this.creativeId,this.adId,50);break;case 75:y.getInstance().printDebugLogs("BpkAdTracker","Ad progress 75%"),this.adTrackingManager.notifyAdProgress(this.sessionToken,this.creativeId,this.adId,75);break;case 100:y.getInstance().printDebugLogs("BpkAdTracker","Ad end"),this.adTrackingManager.notifyAdProgress(this.sessionToken,this.creativeId,this.adId,100),this.adTrackingManager.notifyAdEnd(this.sessionToken,this.creativeId,this.adId)}}}]),n}($t),ie=function(t){Vt(n,t);var e=Yt(n);function n(t,r,i,o,s,a){var u;return Kt(this,n),(u=e.call(this,t,r,i,o,s,a)).adBreakBegin=void 0,u.adEnd=void 0,u.adSkippable=void 0,u}return n}(re),oe=function(t){Vt(n,t);var e=Yt(n);function n(t,r,i,o,s,a,u){var c;return Kt(this,n),(c=e.call(this,t,r,i)).creativeId=void 0,c.adId=void 0,c.offset=void 0,c.limit=void 0,c.creativeId=o,c.adId=s,c.offset=a,c.limit=u,c}return zt(n,[{key:"process",value:function(){y.getInstance().printDebugLogs("BpkAdTracker","Ad skippable"),void 0!==this.adListener&&this.adListener.onAdSkippable(this.offset,this.limit),this.adTrackingManager.notifyAdSkippable(this.sessionToken,this.offset,this.limit)}}]),n}($t),se=function(){function t(){Kt(this,t)}return zt(t,null,[{key:"parseLegacyTracker",value:function(e,n){return t.isSmartLibPrefix(n)?new Gt(e,n):new Xt(n)}},{key:"isSmartLibPrefix",value:function(t){return t.startsWith(Gt.SMARTLIB_PREFIX)}}]),t}();function ae(t){return(ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ue(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ce(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&function(t,e){(Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}(t,e)}function le(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=he(t);if(e){var i=he(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return fe(this,n)}}function fe(t,e){return!e||"object"!==ae(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function he(t){return(he=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function de(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var pe=function t(){de(this,t),this.tracker=void 0},ve=function(t){ce(n,t);var e=le(n);function n(){return de(this,n),e.apply(this,arguments)}return n}(pe),ye=function(t){ce(n,t);var e=le(n);function n(){var t;de(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))).position=void 0,t}return n}(pe),ge=function(){function t(){de(this,t)}var e,n;return e=t,(n=[{key:"parseDashEvent",value:function(t,e){var n=new ve;return n.tracker=se.parseLegacyTracker(t,e),n}},{key:"parseJSONEvent",value:function(t,e){var n=new ye;return n.tracker=se.parseLegacyTracker(t,e.url),n.position=e.position,n}},{key:"createAdBreakData",value:function(t,e,n,r,i){var o=new ye;return o.tracker=new Zt(t,e,n,r),o.position=i,o}},{key:"createAdBreakBegin",value:function(t,e,n,r){var i=new ye;return i.tracker=new te(t,e,n),i.tracker.position=r,i.position=r,i}},{key:"createAdBreakEnd",value:function(t,e,n,r){var i=new ye;return i.tracker=new ee(t,e,n),i.position=r,i}},{key:"createAdData",value:function(t,e,n,r,i){var o=new ye;return o.tracker=new ne(t,e,n,r),o.position=i,o}},{key:"createAdProgress",value:function(t,e,n,r,i,o,s){var a=new ye;return a.tracker=0===o?new ie(t,e,n,r,i,o):new re(t,e,n,r,i,o),a.position=s,a}},{key:"createAdSkippable",value:function(t,e,n,r,i,o,s,a){var u=new ye;return u.tracker=new oe(t,e,n,r,i,o,s),u.position=a,u}},{key:"createAdSkippable",value:function(t,e,n,r,i,o,s,a){var u=new ye;return u.tracker=new oe(t,e,n,r,i,o,s),u.position=a,u}},{key:"createThirdParty",value:function(t,e,n,r){var i=new ye;return i.tracker=new Xt(e,n,r),i.position=t,i}}])&&ue(e,n),t}();function Ee(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Se=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.session=void 0,this.adEventsListener=void 0,this.adParameters=void 0,this.eventCallbackEnabled=void 0,this.adEventsListener=void 0,this.adParameters={},this.eventCallbackEnabled=!0}var e,n;return e=t,(n=[{key:"setAdEventsListener",value:function(t){this.adEventsListener=t}},{key:"setAdParameter",value:function(t,e){this.adParameters[t]=e,y.getInstance().printDebugLogs("BpkAdSession","Adding parameter "+t+"="+e)}},{key:"setEventCallbackEnabled",value:function(t){this.eventCallbackEnabled=t}},{key:"resetAdParameters",value:function(){this.adParameters={}}},{key:"hasAdParameters",value:function(){return Object.keys(this.adParameters).length>0}},{key:"onDashEvent",value:function(t){if(this.hasAdParameters())if(this.eventCallbackEnabled)if(!1===this.session.adTrackingManager.bkYouSession){var e=t;-1!==e.indexOf("<![CDATA[")&&-1!==e.indexOf("]]>")&&(e=e.trim().replace(/^(\/\/\s*)?<!\[CDATA\[|(\/\/\s*)?\]\]>$/g,"")),e=e.replace(/&&;/g,"&").trim(),ge.parseDashEvent(this.session,e).tracker.process()}else y.getInstance().printDebugLogs("BpkAdSession","Event received but legacy mode not enabled",this.session.id);else y.getInstance().printDebugLogs("BpkAdSession","Event received but callbacks are disabled",this.session.id);else y.getInstance().printDebugLogs("BpkAdSession","Event received but ad not enabled (no ad parameter)",this.session.id)}}])&&Ee(e.prototype,n),t}();function be(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var me=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.smartLib=void 0,this.initialized=void 0,this.nonceGenerator=void 0,this.omPartnerName=void 0,this.omPartnerVersion=void 0,this.firstNonceRequest=void 0,this.nonceEnabled=!1,this.adSession=void 0,this.eventCallbackEnabled=void 0,this.adEventsListener=void 0,this.initialized=!1,this.nonceEnabled=!1,this.adSession=new Se,this.eventCallbackEnabled=!0,this.adEventsListener=void 0}var e,n;return e=t,(n=[{key:"init",value:function(t){this.smartLib=t,this.initialized||(this.initialized=!0,this.adSession=new Se,this.eventCallbackEnabled=!0,this.adEventsListener=void 0,y.getInstance().printDebugLogs("BpkAdMgr","Ad manager loaded"))}},{key:"setNonceGenerator",value:function(t){this.nonceGenerator=t}},{key:"requestNonce",value:function(){var t=this.firstNonceRequest;return void 0!==t&&void 0===t.nonce&&!1===t.timeout?(y.getInstance().printDebugLogs("BpkAdMgr","Using first nonce request..."),this.firstNonceRequest=void 0,t):(this.firstNonceRequest=void 0,t=new wt,this.initialized&&this.nonceEnabled?(y.getInstance().printDebugLogs("BpkAdMgr","Generating nonce..."),t.generateNonce(),void 0===this.nonceGenerator&&t.setNonce(void 0)):t.setNonce(void 0),t)}},{key:"release",value:function(){this.initialized=!1,this.nonceEnabled=!1,this.adSession=new Se,this.eventCallbackEnabled=!0,this.adEventsListener=void 0,void 0!==this.firstNonceRequest&&(this.firstNonceRequest.setNonce(void 0),this.firstNonceRequest=void 0),void 0!==this.nonceGenerator&&this.nonceGenerator.reset()}},{key:"setPalParameters",value:function(t,e,n,r,i,o,s,a,u,c,l){void 0!==this.nonceGenerator&&(void 0!==t&&this.nonceGenerator.setDescriptionURL(t),void 0!==e&&void 0!==n&&this.nonceGenerator.setOmidPartner(e,n),void 0!==r&&this.nonceGenerator.setOmidVersion(r),void 0!==i&&this.nonceGenerator.setPlayerType(i),void 0!==o&&this.nonceGenerator.setPlayerVersion(o),void 0!==s&&this.nonceGenerator.setPpid(s),0!==a&&this.nonceGenerator.setVideoPlayerHeight(a),0!==u&&this.nonceGenerator.setVideoPlayerWidth(u),this.nonceGenerator.setWillAdAutoPlay(c),this.nonceGenerator.setWillAdPlayMuted(l),this.nonceEnabled||(this.nonceEnabled=!0,this.firstNonceRequest=new wt,this.firstNonceRequest.generateNonce()))}},{key:"setOMPartner",value:function(t,e){this.omPartnerName=t,this.omPartnerVersion=e}}])&&be(e.prototype,n),t}();function ke(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ae(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ie(t,e,n){return e&&Ae(t.prototype,e),n&&Ae(t,n),t}me.AD_NONCE_QUERY_PARAMETER="paln",n(131);var De=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;ke(this,t),this.adSkippable=void 0,this.adSkipped=void 0,this.adProgress=void 0,this.adDuration=void 0,this.stallsNumber=void 0,this.stallsDuration=void 0,this.layerSwitchesNumber=void 0,this.averageBitrate=void 0,this.sessionToken=void 0,this.creativeId=void 0,this.adId=void 0,void 0===e?(this.adSkippable=!1,this.adSkipped=!1,this.adProgress=0,this.adDuration=0,this.stallsNumber=0,this.stallsDuration=0,this.layerSwitchesNumber=0,this.averageBitrate=0,this.sessionToken="",this.creativeId="",this.adId=""):(this.adSkippable=e.adSkippable,this.adSkipped=e.adSkipped,this.adProgress=e.adProgress,this.adDuration=e.adDuration,this.stallsNumber=e.stallsNumber,this.stallsDuration=e.stallsDuration,this.layerSwitchesNumber=e.layerSwitchesNumber,this.averageBitrate=e.averageBitrate,this.sessionToken=e.sessionToken,this.creativeId=e.creativeId,this.adId=e.adId)}return Ie(t,[{key:"toString",value:function(){return"\n{ adSkippable="+this.adSkippable+"\n  adSkipped="+this.adSkipped+"\n  adProgress="+this.adProgress+"\n  adDuration="+this.adDuration+"\n  stallsNumber="+this.stallsNumber+"\n  stallsDuration="+this.stallsDuration+"\n  layerSwitchesNumber="+this.layerSwitchesNumber+"\n  averageBitrate="+this.averageBitrate+"\n  sessionToken='"+this.sessionToken+"'\n  creativeId='"+this.creativeId+"'\n  adId='"+this.adId+"' }"}}],[{key:"merge",value:function(e){if(void 0!==e&&e.length>0){var n=new t,r=e[e.length-1];n.adSkippable=r.adSkippable,n.adSkipped=r.adSkipped,n.adProgress=r.adProgress,n.sessionToken=r.sessionToken,n.creativeId=r.creativeId,n.adId=r.adId;for(var i=0,o=0,s=0;s<e.length;s++){var a=e[s];n.adDuration+=a.adDuration,n.stallsNumber+=a.stallsNumber,n.stallsDuration+=a.stallsDuration,n.layerSwitchesNumber+=a.layerSwitchesNumber,i+=a.averageBitrate*a.adDuration,o+=a.adDuration}return 0!==o&&(n.averageBitrate=Math.round(i/o)),n}}}]),t}(),Re=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;ke(this,t),this.adMetrics=void 0,this.timeSpentPerLayer=void 0,void 0===e&&void 0===n?(this.timeSpentPerLayer={},this.reset()):(this.adMetrics=e,this.timeSpentPerLayer=n)}return Ie(t,[{key:"setAdSkippable",value:function(t){return this.adMetrics.adSkippable=t,this}},{key:"setAdSkipped",value:function(t){return this.adMetrics.adSkipped=t,this}},{key:"setAdProgress",value:function(t){return this.adMetrics.adProgress=t,this}},{key:"setSessionToken",value:function(t){return this.adMetrics.sessionToken=t,this}},{key:"setCreativeId",value:function(t){return this.adMetrics.creativeId=t,this}},{key:"setAdId",value:function(t){return this.adMetrics.adId=t,this}},{key:"addTimeSpentPerLayer",value:function(t,e){return t>0&&(void 0!==this.timeSpentPerLayer[t]?this.timeSpentPerLayer[t]+=e:this.timeSpentPerLayer[t]=e),this}},{key:"addLayerSwitch",value:function(){return this.adMetrics.layerSwitchesNumber++,this}},{key:"addStall",value:function(t){return this.adMetrics.stallsNumber++,this.adMetrics.stallsDuration+=t,this}},{key:"reset",value:function(){return this.adMetrics=new De,this.timeSpentPerLayer={},this}},{key:"clone",value:function(){return new t(new De(this.adMetrics),Object.assign({},this.timeSpentPerLayer))}},{key:"build",value:function(){var t=0,e=0;for(var n in this.timeSpentPerLayer){var r=this.timeSpentPerLayer[n];t+=n*r,e+=r}return 0!==e&&(this.adMetrics.averageBitrate=Math.round(t/e)),this.adMetrics.adDuration=e,this.adMetrics}}]),t}();function Te(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var _e=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.requestedURL=void 0,this.redirectedURL=void 0,this.sessionRunning=void 0,this.sessionId=void 0,this.teardownActivated=void 0,this.smartLibParameters=void 0,this.playerName=void 0,this.playerVersion=void 0,this.osName=void 0,this.osVersion=void 0,this.deviceType=void 0,this.smartLibVersion=void 0,this.networkTypeList=void 0,this.nanoCDNStatus=void 0,this.statusCode=void 0,this.playerErrorCode=void 0,this.metrics=void 0,this.adMetrics=void 0,this.timeline=void 0,this.diversity=void 0,this.endSessionDate=void 0,this.startSessionRequestDate=void 0,this.keepaliveRequestDate=void 0,this.teardownRequestDate=void 0,this.endSessionRequestDate=void 0,this.requestedURL="",this.redirectedURL="",this.sessionRunning=!1,this.sessionId="",this.teardownActivated=!1,this.smartLibParameters={},this.playerName="",this.playerVersion="",this.osName="",this.osVersion="",this.deviceType="",this.smartLibVersion=S,this.networkTypeList=[],this.nanoCDNStatus=An.NANOCDN_STATUS_UNAVAILABLE,this.statusCode=Br.BPSessionEndsNormally,this.playerErrorCode="",this.timeline=new Ot,this.endSessionDate=0,this.startSessionRequestDate=0,this.keepaliveRequestDate=0,this.teardownRequestDate=0,this.endSessionRequestDate=0}var e,n;return e=t,(n=[{key:"toQuery",value:function(){var t,e=""===this.playerName?"Generic":this.playerName,n=this.smartLibParameters.customParameters.pre_startup_time;if(t=void 0===this.metrics?"-1+"+encodeURIComponent(e)+"+"+encodeURIComponent(this.playerVersion)+"+"+encodeURIComponent(this.osName)+"+"+encodeURIComponent(this.osVersion)+"+"+(""!==this.smartLibParameters.deviceType?encodeURIComponent(this.smartLibParameters.deviceType):encodeURIComponent(this.deviceType))+"+-1+-1+-1++-1+-1+-1+-1+-1+-1+-1+-1+-1+-1+-1++":this.metrics.redirectionTime+"+"+encodeURIComponent(e)+"+"+encodeURIComponent(this.playerVersion)+"+"+encodeURIComponent(this.osName)+"+"+encodeURIComponent(this.osVersion)+"+"+(""!==this.smartLibParameters.deviceType?encodeURIComponent(this.smartLibParameters.deviceType):encodeURIComponent(this.deviceType))+"+"+this.metrics.startupTime+"+"+this.metrics.completion+"+"+Math.round(this.metrics.playbackDuration/1e3)+"+"+this.metrics.playbackType+"+"+this.metrics.stallsNumber+"+"+this.metrics.maxStallDuration+"+"+this.metrics.totalStallsDuration+"+"+this.metrics.rebufferingsNumber+"+"+this.metrics.maxRebufferingDuration+"+"+this.metrics.totalRebufferingDuration+"+"+this.metrics.maxBitrate+"+"+this.metrics.minBitrate+"+"+this.metrics.averageBitrate+"+"+this.metrics.layerSwitchesNumber+"+"+Math.round(this.metrics.sessionDuration/1e3)+"+"+this.getTimeSpentPerLayerQuery()+"+",t+=encodeURIComponent(this.smartLibParameters.uuid)+"+"+this.nanoCDNStatus+"+"+(void 0!==n?encodeURIComponent(n):"")+"+"+encodeURIComponent(this.smartLibVersion)+"+",void 0!==this.adMetrics&&this.adMetrics.length>0){var r=De.merge(this.adMetrics);t+=(r.adSkippable?1:0)+"+"+(r.adSkipped?1:0)+"+"+r.adProgress/25+"+"+Math.round(r.adDuration/1e3)+"+"+r.stallsNumber+"+"+Math.round(r.stallsDuration/1e3)+"+"+r.layerSwitchesNumber+"+"+r.averageBitrate}else t+="+++++++";return t+"+"+this.getNetworkTypeListStr()+"+"+encodeURIComponent(this.playerErrorCode)}},{key:"toStartSessionJSON",value:function(){var e={};return e[t.IS_START_TAG]=!0,e[t.SESSION_ID_TAG]=this.sessionId,void 0!==this.metrics&&(e[t.STARTUP_TIME_TAG]=this.metrics.startupTime),e}},{key:"toEndSessionJSON",value:function(){var e={};if(e[t.IS_START_TAG]=!1,e[t.SESSION_ID_TAG]=this.sessionId,e[t.STATUS_CODE_TAG]=this.statusCode,e[t.CONTENT_URL_TAG]=it.toBkAString(this.requestedURL),this.redirectedURL.includes(me.AD_NONCE_QUERY_PARAMETER)?e[t.REDIRECT_URL_TAG]=it.toBkAString(E.addOrReplaceParam(this.redirectedURL,me.AD_NONCE_QUERY_PARAMETER,"ignored")):e[t.REDIRECT_URL_TAG]=it.toBkAString(this.redirectedURL),void 0!==this.metrics?(e[t.REDIRECTION_TIME_TAG]=this.metrics.redirectionTime,e[t.STARTUP_TIME_TAG]=this.metrics.startupTime,e[t.COMPLETION_TAG]=this.metrics.completion,e[t.PLAYED_TIME_TAG]=Math.round(this.metrics.playbackDuration/1e3),e[t.DURATION_TAG]=Math.round(this.metrics.sessionDuration/1e3),e[t.PLAYBACK_TYPE_TAG]=this.metrics.playbackType,e[t.NUMBER_OF_STALLS_TAG]=this.metrics.stallsNumber,e[t.MAX_STALL_TIME_TAG]=this.metrics.maxStallDuration,e[t.TOTAL_STALL_TIME_TAG]=this.metrics.totalStallsDuration,e[t.NUMBER_OF_REBUFFERING_TAG]=this.metrics.rebufferingsNumber,e[t.MAX_REBUFFERING_TIME_TAG]=this.metrics.maxRebufferingDuration,e[t.TOTAL_REBUFFERING_TIME_TAG]=this.metrics.totalRebufferingDuration,e[t.MIN_BITRATE_TAG]=this.metrics.minBitrate,e[t.MAX_BITRATE_TAG]=this.metrics.maxBitrate,e[t.AVERAGE_BITRATE_TAG]=this.metrics.averageBitrate,e[t.NUMBER_OF_LAYER_SWITCH_TAG]=this.metrics.layerSwitchesNumber,e[t.TIME_SPENT_PER_LAYER_TAG]=this.metrics.timeSpentPerLayer):(e[t.REDIRECTION_TIME_TAG]=-1,e[t.STARTUP_TIME_TAG]=-1,e[t.COMPLETION_TAG]=-1,e[t.PLAYED_TIME_TAG]=-1,e[t.DURATION_TAG]=-1,e[t.PLAYBACK_TYPE_TAG]="",e[t.NUMBER_OF_STALLS_TAG]=-1,e[t.MAX_STALL_TIME_TAG]=-1,e[t.TOTAL_STALL_TIME_TAG]=-1,e[t.NUMBER_OF_REBUFFERING_TAG]=-1,e[t.MAX_REBUFFERING_TIME_TAG]=-1,e[t.TOTAL_REBUFFERING_TIME_TAG]=-1,e[t.MIN_BITRATE_TAG]=-1,e[t.MAX_BITRATE_TAG]=-1,e[t.AVERAGE_BITRATE_TAG]=-1,e[t.NUMBER_OF_LAYER_SWITCH_TAG]=-1,e[t.TIME_SPENT_PER_LAYER_TAG]={}),e[t.PLAYER_NAME_TAG]=it.toBkAString(this.playerName),e[t.PLAYER_VERSION_TAG]=it.toBkAString(this.playerVersion),e[t.DEVICE_OS_TAG]=it.toBkAString(this.osName),e[t.DEVICE_VERSION_TAG]=it.toBkAString(this.osVersion),""!==this.smartLibParameters.deviceType?e[t.DEVICE_TYPE]=it.toBkAString(this.smartLibParameters.deviceType):e[t.DEVICE_TYPE]=it.toBkAString(this.deviceType),e[t.UUID_TAG]=it.toBkAString(this.smartLibParameters.uuid),e[t.NANOCDN_STATUS_TAG]=this.nanoCDNStatus,e[t.CUSTOM_PARAMETERS_TAG]=this.smartLibParameters.customParameters,e[t.TIMELINE_TAG]=this.timeline.data().base64(),e[t.SMARTLIB_VERSION_TAG]=it.toBkAString(this.smartLibVersion),e[t.MULTIPATH_TAG]=this.diversity,e[t.PLAYER_ERROR_CODE_TAG]=it.toBkAString(this.playerErrorCode),e[t.AD_METRICS_TAG]=[],void 0!==this.adMetrics&&this.adMetrics.length>0)for(var n=0;n<this.adMetrics.length;n++){var r=this.adMetrics[n];e[t.AD_METRICS_TAG].push({ad_skippable:r.adSkippable?1:0,ad_skipped:r.adSkipped?1:0,ad_progress:r.adProgress/25,ad_duration:Math.round(r.adDuration/1e3),stalls_number:r.stallsNumber,stalls_duration:Math.round(r.stallsDuration/1e3),layer_switches_number:r.layerSwitchesNumber,average_bitrate:r.averageBitrate,session_token:r.sessionToken,creative_id:r.creativeId,ad_id:r.adId})}return e[t.NETWORK_TYPE_TAG]=this.getNetworkTypeListStr(),e}},{key:"getTimeSpentPerLayerQuery",value:function(){var t="";for(var e in this.metrics.timeSpentPerLayer)""!==t&&(t+=","),t+=e+":"+this.metrics.timeSpentPerLayer[e];return t}},{key:"addNetworkType",value:function(t){this.networkTypeList.includes(t)||this.networkTypeList.push(t)}},{key:"getNetworkTypeListStr",value:function(){return this.networkTypeList.length>0?this.networkTypeList.sort().join("-"):""}},{key:"toString",value:function(){return JSON.stringify(this,(function(t,e){return"timeline"===t&&e instanceof Ot?e.toString():void 0===e?"undefined":e}),"  ")}}])&&Te(e.prototype,n),t}();function Ne(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Le(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}_e.SESSION_ID_TAG="session_id",_e.IS_START_TAG="start",_e.STATUS_CODE_TAG="status_code",_e.STARTUP_TIME_TAG="startup_time",_e.REDIRECTION_TIME_TAG="redirection_time",_e.COMPLETION_TAG="completion",_e.PLAYED_TIME_TAG="played_time",_e.DURATION_TAG="duration",_e.PLAYBACK_TYPE_TAG="playback_type",_e.NUMBER_OF_STALLS_TAG="cnt_stall",_e.TOTAL_STALL_TIME_TAG="total_stall_time",_e.MAX_STALL_TIME_TAG="max_stall_time",_e.NUMBER_OF_REBUFFERING_TAG="cnt_rebuffering",_e.TOTAL_REBUFFERING_TIME_TAG="total_rebuffering_time",_e.MAX_REBUFFERING_TIME_TAG="max_rebuffering_time",_e.REDIRECT_URL_TAG="redirect_url",_e.CONTENT_URL_TAG="content_url",_e.MAX_BITRATE_TAG="max_bitrate",_e.MIN_BITRATE_TAG="min_bitrate",_e.AVERAGE_BITRATE_TAG="average_bitrate",_e.NUMBER_OF_LAYER_SWITCH_TAG="cnt_layer_switch",_e.TIME_SPENT_PER_LAYER_TAG="time_spent_per_layer",_e.PLAYER_NAME_TAG="player_name",_e.PLAYER_VERSION_TAG="player_version",_e.DEVICE_OS_TAG="device_os",_e.DEVICE_VERSION_TAG="device_version",_e.DEVICE_TYPE="device_type",_e.MULTIPATH_TAG="multipath",_e.UUID_TAG="uuid",_e.NANOCDN_STATUS_TAG="nano_status",_e.CUSTOM_PARAMETERS_TAG="custom_parameters",_e.TIMELINE_TAG="timeline",_e.SMARTLIB_VERSION_TAG="smartlib_version",_e.AD_METRICS_TAG="ad_metrics",_e.NETWORK_TYPE_TAG="network_type_list",_e.PLAYER_ERROR_CODE_TAG="player_error_code";var Oe=0;function Pe(t){return"__private_"+Oe+++"_"+t}var we=Pe("session"),Ce=Pe("active"),Me=Pe("job"),Be=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Object.defineProperty(this,we,{writable:!0,value:void 0}),Object.defineProperty(this,Ce,{writable:!0,value:void 0}),Object.defineProperty(this,Me,{writable:!0,value:void 0}),Le(this,we)[we]=e,Le(this,Ce)[Ce]=!0}var e,n;return e=t,(n=[{key:"start",value:function(){var t=this;Le(this,Me)[Me]=N.getInstance().asyncDelay(V.KEEPALIVE_REQUEST_INTERVAL,(function(){t.process()}))}},{key:"process",value:function(){var t=this;if(Le(this,Ce)[Ce]){Le(this,we)[we].notifyKeepaliveSessionReportRequested(Le(this,we)[we].sessionReport),Le(this,we)[we].sessionReport.keepaliveRequestDate=Date.now();var e={userAgent:Le(this,we)[we].smartLib.getParameters().userAgent};V.getInstance().keepalive(Le(this,we)[we],e).then((function(e){e>0&&(e<200||e>=300)?(y.getInstance().printDebugLogs("BpkKeepAliveMgr","Stopping keepalive...",Le(t,we)[we].id),t.stop()):Le(t,Me)[Me]=N.getInstance().asyncDelay(V.KEEPALIVE_REQUEST_INTERVAL,(function(){t.process()}))}))}}},{key:"stop",value:function(){Le(this,Ce)[Ce]=!1,N.getInstance().cancel(Le(this,Me)[Me])}},{key:"isActive",value:function(){return Le(this,Ce)[Ce]}}])&&Ne(e.prototype,n),t}();function xe(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var Ue=0;function je(t){return"__private_"+Ue+++"_"+t}function Fe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ge(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function He(t,e,n){return e&&Ge(t.prototype,e),n&&Ge(t,n),t}var Ve=function(){function t(){Fe(this,t)}return He(t,null,[{key:"startLib",value:function(){}},{key:"stopLib",value:function(){}},{key:"setNbConnection",value:function(){}},{key:"setLogLevel",value:function(){}},{key:"getStats",value:function(){}},{key:"getJobStats",value:function(){}},{key:"getVersion",value:function(){}}]),t}(),Ye=je("instance"),We=je("diversityHandler"),qe=je("port"),Ke=je("receiveTimeoutMs"),Qe=je("connectionNumber"),ze=je("sessionId"),Je=je("logLevel"),Xe=function(){function t(){Fe(this,t),this.smartLib=void 0,Object.defineProperty(this,We,{writable:!0,value:void 0}),Object.defineProperty(this,qe,{writable:!0,value:void 0}),Object.defineProperty(this,Ke,{writable:!0,value:void 0}),Object.defineProperty(this,Qe,{writable:!0,value:void 0}),Object.defineProperty(this,ze,{writable:!0,value:void 0}),Object.defineProperty(this,Je,{writable:!0,value:void 0}),xe(this,qe)[qe]=0,xe(this,Ke)[Ke]=2e3,xe(this,Qe)[Qe]=0,xe(this,Je)[Je]=t.MULTIPATH_LOG_LEVEL_ERROR}return He(t,null,[{key:"getInstance",value:function(){return xe(t,Ye)[Ye]||(xe(t,Ye)[Ye]=new t),xe(t,Ye)[Ye]}}]),He(t,[{key:"attachInstance",value:function(t){this.smartLib=t}},{key:"attachHandler",value:function(t){xe(this,We)[We]=t}},{key:"init",value:function(){if(xe(this,qe)[qe]<=0){var t=this.getVersion();if(void 0===t&&(t="multipath get version not working"),xe(this,We)[We].setNbConnection(xe(this,Qe)[Qe]),y.getInstance().printInfoLogs("BpkDiversity",t),y.getInstance().printInfoLogs("BpkDiversity","Connection number: "+xe(this,Qe)[Qe]),xe(this,qe)[qe]=xe(this,We)[We].startLib("--log-level "+xe(this,Je)[Je]+" --blacklist_timeout_cdn 200 --rcv_timeout_cdn "+xe(this,Ke)[Ke]),xe(this,qe)[qe]<=0){var e="";switch(xe(this,qe)[qe]){case-1:e="can't get a valid port";break;case-2:e="issues to launch modules";break;case-3:e="options parsing error";break;default:e=xe(this,qe)[qe]}y.getInstance().printErrorLogs("BpkDiversity","Init lib multipath failed, status:"+e)}else y.getInstance().printInfoLogs("BpkDiversity","Init lib multipath Successfull, port:"+xe(this,qe)[qe])}}},{key:"release",value:function(){xe(this,qe)[qe]=0,xe(this,We)[We].stopLib()}},{key:"getVersion",value:function(){return xe(this,We)[We].getVersion()}},{key:"isActive",value:function(){return xe(this,We)[We]!==Ve&&xe(this,qe)[qe]>0}},{key:"rewriteURL",value:function(t){if(xe(this,qe)[qe]>0&&null!=t){var e=t.indexOf("["),n=t.indexOf("]");e>=0&&n>=0||(e=t.indexOf("/bpk-token/"))>=0&&(e+="/bpk-token/".length-1,n=t.indexOf("/",e+1)),e>=0&&n>=0&&(xe(this,ze)[ze]=t.substring(e+1,n)),""!==E.getParam(t,"us")&&(t=t.replace(":18080/",":"+xe(this,qe)[qe]+"/"))}return t}},{key:"getNbConnection",value:function(){return xe(this,Qe)[Qe]}},{key:"setNbConnection",value:function(t){xe(this,Qe)[Qe]=t,xe(this,We)[We].setNbConnection(t)}},{key:"setRcvTimeoutMs",value:function(t){xe(this,Ke)[Ke]=t}},{key:"setLogLevel",value:function(t){xe(this,Je)[Je]=t,xe(this,We)[We].setLogLevel(t)}},{key:"getStats",value:function(t,e){var n="";return xe(this,qe)[qe]>0?n=xe(this,We)[We].getStats(t,e):y.getInstance().printDebugLogs("BpkDiversity","No diversity metrics"),n}},{key:"getJobStats",value:function(t,e){var n="";return xe(this,qe)[qe]>0&&(""!==t&&null!=t||void 0===xe(this,ze)[ze]||(t=xe(this,ze)[ze]),n=xe(this,We)[We].getJobStats(t,e)),""!==n&&void 0!==n||(n='{"id":"'+e+'","Bytes":0,"DurationMs":0,"Bitratebps":0,"ResponseTimeMs":0,"Cdn":[]}'),n}},{key:"saveDiversityStats",value:function(t){}},{key:"getDiversityStats",value:function(){}}]),t}();function $e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Ze(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Xe.MULTIPATH_STATS_PERIODIC=0,Xe.MULTIPATH_STATS_SINCE_START=1,Xe.MULTIPATH_LOG_LEVEL_PANIC=1,Xe.MULTIPATH_LOG_LEVEL_FATAL=2,Xe.MULTIPATH_LOG_LEVEL_ERROR=3,Xe.MULTIPATH_LOG_LEVEL_WARN=4,Xe.MULTIPATH_LOG_LEVEL_NOTICE=5,Xe.MULTIPATH_LOG_LEVEL_INFO=6,Xe.MULTIPATH_LOG_LEVEL_DEBUG=7,Object.defineProperty(Xe,Ye,{writable:!0,value:void 0}),n(151),n(65);var tn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.session=void 0,this.timeline=void 0,this.builder=void 0,this.adMetrics=void 0,this.firstImage=void 0,this.lastLayerBitrate=void 0,this.adBreakPlaying=void 0,this.adPlaying=void 0,this.adProgress=void 0,this.adQuartiles=void 0,this.adSkipped=void 0,this.adLastLayerSwitchDate=void 0,this.adLastBufferingStartDate=void 0,this.session=e,this.timeline=this.session.sessionReport.timeline,this.builder=new Re,this.adMetrics=[]}var e,n;return e=t,(n=[{key:"onStart",value:function(){this.adMetrics=[],this.adLastLayerSwitchDate=0,this.firstImage=!1,this.lastLayerBitrate=0,this.adLastBufferingStartDate=-1,this.adBreakPlaying=!1,this.adPlaying=!1,this.adProgress=0,this.adQuartiles={},this.adSkipped=!1}},{key:"onFirstImage",value:function(t,e){this.lastLayerBitrate=t,this.adLastLayerSwitchDate=Date.now(),this.firstImage=!0}},{key:"onLayerSwitch",value:function(t){this.adBreakPlaying&&this.firstImage&&(this.builder.addTimeSpentPerLayer(this.lastLayerBitrate,Date.now()-this.adLastLayerSwitchDate),this.adLastLayerSwitchDate=Date.now(),this.lastLayerBitrate!==t&&this.builder.addLayerSwitch()),this.lastLayerBitrate=t}},{key:"onBufferingStart",value:function(){this.adBreakPlaying&&(this.adLastBufferingStartDate=Date.now())}},{key:"onStallEnd",value:function(){this.adBreakPlaying&&this.adLastBufferingStartDate>=0&&this.builder.addStall(Date.now()-this.adLastBufferingStartDate),this.adLastBufferingStartDate=-1}},{key:"onRebufferingEnd",value:function(){this.adLastBufferingStartDate=-1}},{key:"onSeek",value:function(t,e){this.adBreakPlaying&&(y.getInstance().printDebugLogs("BpkAdMetricsManager","Ad seeked from "+ut.formatTime(t)+" to "+ut.formatTime(e)),Math.abs(e-t)<1e3?y.getInstance().printDebugLogs("BpkAdMetricsManager","Ignoring seek < 1000ms"):this.adSkipped=!0)}},{key:"onStop",value:function(t){this.adBreakPlaying&&(this.handleAdEnd(),this.adBreakPlaying=!1)}},{key:"onAdBreakBegin",value:function(t){this.adBreakPlaying=!0,void 0!==this.timeline&&this.timeline.pushEvent(14)}},{key:"onAdBegin",value:function(t,e,n){this.adSkipped&&this.handleAdEnd(),this.adSkipped=!1,this.adLastLayerSwitchDate=Date.now(),this.builder.reset().setSessionToken(t).setCreativeId(e).setAdId(n),this.adQuartiles={},this.adPlaying=!0}},{key:"onAdSkippable",value:function(t,e,n){this.builder.setAdSkippable(!0)}},{key:"onAdProgress",value:function(t,e,n,r){this.adQuartiles[r]=!0,this.adProgress=25*Object.keys(this.adQuartiles).length-25}},{key:"onAdEnd",value:function(t,e,n){this.handleAdEnd(),this.adPlaying=!1}},{key:"onAdBreakEnd",value:function(t){!0===this.adPlaying&&(this.builder.setAdSkipped(!0),this.handleAdEnd()),this.adBreakPlaying=!1,void 0!==this.timeline&&this.timeline.pushEventProgress(15,this.adProgress)}},{key:"onKeepaliveSessionReportUpdateRequested",value:function(t){var e=function(t){return function(t){if(Array.isArray(t))return $e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return $e(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$e(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(this.adMetrics);if(this.adBreakPlaying){var n=this.builder.clone().setAdProgress(this.adProgress).addTimeSpentPerLayer(this.lastLayerBitrate,Date.now()-this.adLastLayerSwitchDate);this.adLastBufferingStartDate>=0&&n.addStall(Date.now()-this.adLastBufferingStartDate),e.push(n.build())}t.adMetrics=e}},{key:"onEndSessionReportUpdateRequested",value:function(t){t.adMetrics=this.adMetrics}},{key:"handleAdEnd",value:function(){this.builder.setAdSkipped(this.adSkipped).setAdProgress(this.adProgress).addTimeSpentPerLayer(this.lastLayerBitrate,Date.now()-this.adLastLayerSwitchDate);var t=this.builder.build();this.adMetrics.push(t),y.getInstance().printDebugLogs("BpkAdMetricsManager","Ad metrics : "+t.toString()),this.builder.reset(),this.adSkipped=!1}}])&&Ze(e.prototype,n),t}();function en(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n(152),n(212),n(213);var nn=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.session=void 0,this.playerAdapter=void 0,this.listeners=void 0,this.baseEvents=void 0,this.currentEvents=void 0,this.updatePositionJob=void 0,this.updateBkYouSessionJob=void 0,this.started=void 0,this.paused=void 0,this.buffering=void 0,this.lastPosition=void 0,this.firstImageDate=void 0,this.currentAdBreakBegin=void 0,this.currentAdBegin=void 0,this.bkYouSession=void 0,this.bkYouBaseURL=void 0,this.bkYouNonce=void 0,this.bkYouNonceDate=void 0,this.bkYouNonceRequest=void 0,this.bkYouFirstFileReceived=void 0,this.bkYouFirstFileProceeded=void 0,this.session=e,this.playerAdapter=n,this.listeners=[],this.baseEvents=[],this.currentEvents=[],this.updatePositionJob=void 0,this.updateBkYouSessionJob=void 0,this.started=!1,this.paused=!1,this.buffering=!1,this.lastPosition=0,this.currentAdBreakBegin=void 0,this.bkYouSession=!1,this.bkYouBaseURL=void 0,this.bkYouNonce=void 0,this.bkYouNonceDate=0,this.bkYouNonceRequest=void 0,this.bkYouFirstFileReceived=!1,this.bkYouFirstFileProceeded=!1}var e,n;return e=t,(n=[{key:"initBkYouSession",value:function(t,e){var n=this;this.bkYouSession=!1,this.bkYouBaseURL=E.addOrReplaceParam(t.getURL(),"bk-ml","1");var r=this.bkYouBaseURL;void 0!==e&&(this.bkYouNonce=e,this.bkYouNonceDate=Date.now(),r=E.addOrReplaceParam(r,me.AD_NONCE_QUERY_PARAMETER,e));var i={userAgent:this.session.smartLib.getParameters().userAgent};return V.getInstance().adTracking(this.session,i,r,!1).then((function(r){if(r.httpStatus>=200&&r.httpStatus<300){var i;try{i=JSON.parse(r.content)}catch(r){return y.getInstance().printDebugLogs("BpkAdTrackingMgr","Ad Tracking file unreadable, falling back to legacy mode",n.session.id),void 0!==e&&(t.url=E.addOrReplaceParam(t.url,me.AD_NONCE_QUERY_PARAMETER,e)),t}if(void 0===i.sessiontoken)return t;n.bkYouSession=!0;var o=i.playbackqueries;Array.isArray(o)&&o.forEach((function(e){if(-1!==e.indexOf("=")){var n=e.split("=");t.url=E.addOrReplaceParam(t.url,n[0],n[1])}})),n.parseAdPods(i)}else y.getInstance().printDebugLogs("BpkAdTrackingMgr","Ad tracking response unreadable",n.session.id);return t}))}},{key:"updateBkYouSession",value:function(){var e=this;if(!0===this.bkYouSession){y.getInstance().printDebugLogs("BpkAdTrackingMgr","Updating ad tracking file...",this.session.id);var n=this.bkYouBaseURL;void 0!==this.bkYouNonceRequest&&(this.bkYouNonce=this.bkYouNonceRequest.nonce,this.bkYouNonceDate=Date.now(),this.bkYouNonceRequest=void 0,y.getInstance().printDebugLogs("BpkAdTrackingMgr","New nonce "+this.bkYouNonce,this.session.id)),void 0!==this.bkYouNonce&&(n=E.addOrReplaceParam(n,me.AD_NONCE_QUERY_PARAMETER,this.bkYouNonce));var r={userAgent:this.session.smartLib.getParameters().userAgent};V.getInstance().adTracking(this.session,r,n,!0).then((function(n){if(n.httpStatus>=200&&n.httpStatus<300){var r;try{r=JSON.parse(n.content)}catch(t){return void y.getInstance().printDebugLogs("BpkAdTrackingMgr","Ad Tracking updated file unreadable",e.session.id)}e.bkYouFirstFileReceived=!0;var i=e.baseEvents.filter((function(t){return t.tracker instanceof te}));void 0!==e.currentAdBreakBegin?(e.baseEvents=e.baseEvents.filter((function(t){return t.tracker.adBreakId===e.currentAdBreakBegin.tracker.adBreakId})),e.currentEvents=e.currentEvents.filter((function(t){return t.tracker.adBreakId===e.currentAdBreakBegin.tracker.adBreakId}))):(e.baseEvents=[],e.currentEvents=[]),e.parseAdPods(r);var o=e.baseEvents.filter((function(t){return t.tracker instanceof te}));if(i.length!==o.length||Date.now()-e.bkYouNonceDate>t.NONCE_EXPIRATION_TIME)e.updateNonce();else for(var s=0;s<i.length;s++){var a=i[s],u=o[s];if(a.adBreakId!==u.adBreakId){e.updateNonce();break}}}void 0!==e.updateBkYouSessionJob&&N.getInstance().cancel(e.updateBkYouSessionJob),e.updateBkYouSessionJob=N.getInstance().asyncDelay(t.SESSION_UPDATE_INTERVAL,(function(){e.updateBkYouSessionJob=void 0,e.updateBkYouSession()}))}))}}},{key:"updateNonce",value:function(){y.getInstance().printDebugLogs("BpkAdTrackingMgr","Updating nonce...",this.session.id),this.bkYouNonce=void 0,this.bkYouNonceRequest=this.session.smartLib.internalAdManager.requestNonce()}},{key:"parseAdPods",value:function(t){var e=this,n=[],r=t.sessiontoken||"",i=t.timereference_ms||0,o=t.adpods;Array.isArray(o)&&o.forEach((function(t){var o=t.id,s=t.starttime_ms+i,a=t.duration_ms,u=t.ads,c=ge.createAdBreakData(e.session,r,o,{adBreakId:o,startTime:s,duration:a},s);n.push(c);var l=ge.createAdBreakBegin(e.session,r,o,s),f=ge.createAdBreakEnd(e.session,r,o,s+a);l.tracker.adBreakEnd=f,n.push(l),Array.isArray(u)&&u.forEach((function(t){var s=t.creativeid||"",a=t.adid||"",u=t.starttime_ms+i,c=t.skippable_ms+i||0,f=t.duration_ms,h=t.trackingevents;if(void 0!==u&&void 0!==f){var d=ge.createAdData(e.session,r,o,{creativeId:s,adId:a,startTime:u,skippableTime:c,duration:f,skippable:0!==c&&null!=c},u);n.push(d);var p=ge.createAdProgress(e.session,r,o,s,a,0,u);if(n.push(p),c>0){var v=ge.createAdSkippable(e.session,r,o,s,a,c,u+f,u+1);n.push(v),p.tracker.adSkippable=v}n.push(ge.createAdProgress(e.session,r,o,s,a,25,u+Math.round(f/4))),n.push(ge.createAdProgress(e.session,r,o,s,a,50,u+Math.round(f/2))),n.push(ge.createAdProgress(e.session,r,o,s,a,75,u+Math.round(3*f/4)));var y=ge.createAdProgress(e.session,r,o,s,a,100,u+f-1);n.push(y),p.tracker.adBreakBegin=l,p.tracker.adEnd=y}Array.isArray(h)&&h.forEach((function(t){var e=t.callbackurl,s=t.time_ms;void 0!==e&&void 0!==s&&n.push(ge.createThirdParty(s+i,e,r,o))}))})),n.push(f)})),this.addEvents(n)}},{key:"start",value:function(){var e=this;void 0===this.updatePositionJob&&(this.updatePositionJob=N.getInstance().asyncDelay(t.POSITION_UPDATE_INTERVAL,(function(){e.updatePositionJob=void 0,e.onPositionUpdated(e.playerAdapter.getPosition())})))}},{key:"stop",value:function(){void 0!==this.updatePositionJob&&(y.getInstance().printDebugLogs("BpkAdTrackingMgr","Ad tracking paused (player event)"),N.getInstance().cancel(this.updatePositionJob),this.updatePositionJob=void 0)}},{key:"addEvents",value:function(t){var e=this;void 0!==this.currentAdBreakBegin&&(t=t.filter((function(t){return t.tracker.adBreakId!==e.currentAdBreakBegin.tracker.adBreakId}))),t.forEach((function(t){return e.baseEvents.push(t)})),this.baseEvents=this.baseEvents.sort((function(t,e){return t.position-e.position})),this.currentEvents=this.baseEvents.filter((function(t){return t.position>=e.lastPosition})),this.started&&(void 0===this.updatePositionJob&&this.currentEvents.length>0&&(y.getInstance().printDebugLogs("BpkAdTrackingMgr","Ad tracking resumed"),this.lastPosition=this.playerAdapter.getPosition()),this.checkStart())}},{key:"onPositionUpdated",value:function(e){var n=this,r=this.lastPosition!==e?this.lastPosition:e-1,i=e;if(!0===this.bkYouFirstFileReceived&&!1===this.bkYouFirstFileProceeded&&(this.bkYouFirstFileProceeded=!0,Date.now()-this.firstImageDate<=4e3)){var o=this.baseEvents.slice().reverse().find((function(t){return t.tracker instanceof re&&0===t.tracker.adProgress&&r-1e3<t.position&&t.position<r}));void 0!==o&&(this.baseEvents.filter((function(t){return o.position<=t.position&&t.position<=r&&!(t.tracker instanceof te)})).forEach((function(t){return t.tracker.process()})),this.currentAdBegin=o)}if(r<i&&i-r<2*t.POSITION_UPDATE_INTERVAL){var s=this.currentEvents.filter((function(t){return t.position>r&&t.position<=i}));s.forEach((function(t){var e=t.tracker;e instanceof te?n.currentAdBreakBegin=t:e instanceof ee?n.currentAdBreakBegin=void 0:e instanceof re&&0===e.adProgress?n.currentAdBegin=t:e instanceof re&&100===e.adProgress&&(n.currentAdBegin=void 0),e.process()})),this.currentEvents=this.baseEvents.filter((function(t){return t.position>i})),this.lastPosition=e,y.getInstance().printDebugLogs("BpkAdTrackingMgr","Start: "+(r+1)+", End: "+i+", Current events: "+JSON.stringify(s.map((function(t){return{position:t.position,url:t.tracker.url}})))+", Remaining events number: "+this.currentEvents.length),this.currentEvents.length>0?this.paused||this.buffering?y.getInstance().printDebugLogs("BpkAdTrackingMgr","Ad tracking paused (playback paused)"):this.start():y.getInstance().printDebugLogs("BpkAdTrackingMgr","Ad tracking paused (no more event)")}else y.getInstance().printDebugLogs("BpkAdTrackingMgr","Start: "+r+", End: "+i+", skipping...")}},{key:"checkStart",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.playerAdapter.getPosition();this.currentEvents.length>0?this.onPositionUpdated(t):y.getInstance().printDebugLogs("BpkAdTrackingMgr","Ad tracking paused (no more event)")}},{key:"onFirstImage",value:function(t,e){var n=this;this.started=!0,this.paused=!1,this.buffering=!1,this.lastPosition=e,this.firstImageDate=Date.now(),this.currentEvents=this.baseEvents.filter((function(t){return t.position>=n.lastPosition})),this.checkStart(e),this.updateBkYouSession()}},{key:"onPause",value:function(){this.paused=!0,this.stop(),this.lastPosition=this.playerAdapter.getPosition(),this.onPositionUpdated(this.lastPosition)}},{key:"onResume",value:function(){this.paused=!1,this.buffering||(this.lastPosition=this.playerAdapter.getPosition(),this.checkStart())}},{key:"onBufferingStart",value:function(){this.buffering=!0,this.stop(),this.lastPosition=this.playerAdapter.getPosition(),this.onPositionUpdated(this.lastPosition)}},{key:"onBufferingEnd",value:function(t){this.buffering=!1,this.paused||(this.lastPosition=this.playerAdapter.getPosition(),this.checkStart())}},{key:"onSeek",value:function(e,n){var r=this;if(this.lastPosition=n,this.currentEvents=this.baseEvents.filter((function(t){return t.position>=r.lastPosition})),!(Math.abs(n-e)<1e3)){if(void 0===this.currentAdBreakBegin)for(var i,o,s=this.baseEvents.slice().reverse().filter((function(t){return t.position<=n})),a=0;a<s.length;a++){var u=s[a];if(void 0===i&&u.tracker instanceof te&&(i=u),void 0===o&&u.tracker instanceof ie&&(o=u),void 0!==i&&void 0!==o){var c;this.currentAdBreakBegin=i,this.currentAdBegin=o,i.tracker.process(),o.position+t.POSITION_UPDATE_INTERVAL<=n&&(o.tracker.process(),null===(c=o.tracker.adSkippable)||void 0===c||c.tracker.process());break}}if(this.onPositionUpdated(n),void 0!==this.currentAdBreakBegin){var l,f=this.currentAdBreakBegin.position,h=null===(l=this.currentAdBreakBegin.tracker.adBreakEnd)||void 0===l?void 0:l.position;if(e<n&&h<=n)this.currentAdBreakBegin.tracker.adBreakEnd.tracker.process(),this.currentAdBreakBegin=void 0,this.currentAdBegin=void 0;else if(n<e&&n<f)this.currentAdBreakBegin.tracker.adBreakEnd.tracker.process(),this.currentAdBreakBegin=void 0,this.currentAdBegin=void 0;else if(f<n&&n<h){var d=this.baseEvents.slice().reverse().find((function(e){return e.tracker instanceof re&&0===e.tracker.adProgress&&n-t.POSITION_UPDATE_INTERVAL<e.position&&e.position<n}));void 0!==d&&(this.baseEvents.filter((function(t){return d.position<=t.position&&t.position<=n&&!(t.tracker instanceof te)})).forEach((function(t){return t.tracker.process()})),this.currentAdBegin=d)}}}}},{key:"onStop",value:function(t){this.stop(),this.lastPosition=this.playerAdapter.getPosition(),this.onPositionUpdated(this.lastPosition),this.stop(),void 0!==this.updateBkYouSessionJob&&N.getInstance().cancel(this.updateBkYouSessionJob)}},{key:"addListener",value:function(t){this.listeners.includes(t)||this.listeners.push(t)}},{key:"removeListener",value:function(t){var e=this.listeners.indexOf(t);-1!==e&&this.listeners.splice(e,1)}},{key:"notifyEvent",value:function(t,e,n,r,i,o){"function"==typeof t[e]&&t[e](n,r,i,o)}},{key:"notifyAdBreakData",value:function(t){var e=this;this.listeners.forEach((function(n){e.notifyEvent(n,"onAdBreakData",t)}))}},{key:"notifyAdBreakBegin",value:function(t){var e=this;this.listeners.forEach((function(n){e.notifyEvent(n,"onAdBreakBegin",t)}))}},{key:"notifyAdData",value:function(t){var e=this;this.listeners.forEach((function(n){e.notifyEvent(n,"onAdData",t)}))}},{key:"notifyAdBegin",value:function(t,e,n){var r=this;this.listeners.forEach((function(i){r.notifyEvent(i,"onAdBegin",t,e,n)}))}},{key:"notifyAdSkippable",value:function(t,e,n){var r=this;this.listeners.forEach((function(i){r.notifyEvent(i,"onAdSkippable",t,e,n)}))}},{key:"notifyAdProgress",value:function(t,e,n,r){var i=this;this.listeners.forEach((function(o){i.notifyEvent(o,"onAdProgress",t,e,n,r)}))}},{key:"notifyAdEnd",value:function(t,e,n){var r=this;this.listeners.forEach((function(i){r.notifyEvent(i,"onAdEnd",t,e,n)}))}},{key:"notifyAdBreakEnd",value:function(t){var e=this;this.listeners.forEach((function(n){e.notifyEvent(n,"onAdBreakEnd",t)}))}}])&&en(e.prototype,n),t}();function rn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function on(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?rn(Object(n),!0).forEach((function(e){sn(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):rn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function sn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function an(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function un(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}nn.POSITION_UPDATE_INTERVAL=1e3,nn.SESSION_UPDATE_INTERVAL=5e3,nn.NONCE_EXPIRATION_TIME=3e5,n(46),n(214);var cn=0;function ln(t){return"__private_"+cn+++"_"+t}var fn=ln("options"),hn=ln("updates"),dn=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Object.defineProperty(this,fn,{writable:!0,value:void 0}),Object.defineProperty(this,hn,{writable:!0,value:void 0}),un(this,fn)[fn]={},un(this,fn)[fn][t.MULTICAST_ONLY]=!1,un(this,fn)[fn][t.ULTRA_LOW_LATENCY_SUPPORT]=!1,un(this,fn)[fn][t.PIP_SESSION]=!1,un(this,fn)[fn][t.REQUEST_REDIRECT_THIRD_PARTY_CDN]=!1,un(this,fn)[fn][t.REQUEST_DIVERSITY]=!1,un(this,fn)[fn][t.REQUEST_NANO_CDN]=!0,un(this,fn)[fn][t.REQUEST_BROADPEAK_CDN]=!0,un(this,fn)[fn][t.REQUEST_LOCAL_NANO_CDN_IF_CONNECTED_TO_WIFI]=!1,un(this,fn)[fn][t.SESSION_KEEPALIVE]=t.SESSION_ENABLED_IF_BROADPEAK_DOMAIN,un(this,fn)[fn][t.SESSION_TEARDOWN]=t.SESSION_ENABLED_IF_BROADPEAK_DOMAIN,un(this,fn)[fn][t.SESSION_REPORTING_MODE]=t.SESSION_REPORTING_MODE_DEFAULT,un(this,hn)[hn]=[]}var e,n,r;return e=t,r=[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,r=new t;return e instanceof t&&(un(r,fn)[fn]=on({},un(e,fn)[fn])),void 0!==n&&un(n,hn)[hn].forEach((function(t){un(r,fn)[fn][t]=un(n,fn)[fn][t]})),r}},{key:"optionToString",value:function(t){switch(t){case this.MULTICAST_ONLY:return"MULTICAST_ONLY";case this.PIP_SESSION:return"PIP_SESSION";case this.ULTRA_LOW_LATENCY_SUPPORT:return"ULTRA_LOW_LATENCY_SUPPORT";case this.REQUEST_REDIRECT_THIRD_PARTY_CDN:return"REQUEST_REDIRECT_THIRD_PARTY_CDN";case this.REQUEST_DIVERSITY:return"REQUEST_DIVERSITY";case this.REQUEST_NANO_CDN:return"REQUEST_NANO_CDN";case this.REQUEST_BROADPEAK_CDN:return"REQUEST_BROADPEAK_CDN";case this.REQUEST_LOCAL_NANO_CDN_IF_CONNECTED_TO_WIFI:return"REQUEST_LOCAL_NANO_CDN_IF_CONNECTED_TO_WIFI";case this.SESSION_KEEPALIVE:return"SESSION_KEEPALIVE";case this.SESSION_TEARDOWN:return"SESSION_TEARDOWN";case this.SESSION_REPORTING_MODE:return"SESSION_REPORTING_MODE"}return"unknown"}},{key:"valueToString",value:function(t,e){switch(t){case this.SESSION_KEEPALIVE:case this.SESSION_TEARDOWN:return this.stateToString(e);case this.SESSION_REPORTING_MODE:return this.reportingModeToString(e)}return String(e)}},{key:"stateToString",value:function(e){switch(e){case t.SESSION_DISABLED:return"disabled";case t.SESSION_ENABLED_IF_BROADPEAK_DOMAIN:return"enabled if broadpeak domain name";case t.SESSION_ENABLED:return"enabled"}return"unknown"}},{key:"reportingModeToString",value:function(e){switch(e){case t.SESSION_REPORTING_MODE_DEFAULT:return"default";case t.SESSION_REPORTING_MODE_KEEPALIVE_TEARDOWN:return"keepalive/teardown";case t.SESSION_REPORTING_MODE_METRICS_RECEIVER:return"metricsReceiver";case t.SESSION_REPORTING_MODE_DISABLED:return"disabled"}return"unknown"}}],(n=[{key:"option",value:function(e,n){return this.validate(e,n)&&(un(this,fn)[fn][e]=n,e===t.PIP_SESSION&&!0===n&&this.option(t.REQUEST_NANO_CDN,!1),-1===un(this,hn)[hn].indexOf(e)&&un(this,hn)[hn].push(e)),this}},{key:"get",value:function(t){return void 0===un(this,fn)[fn][t]&&y.getInstance().printWarnLogs("BpkStreamingSessionOptions","Warning: get option "+t+" not found"),un(this,fn)[fn][t]}},{key:"set",value:function(t,e){this.option(t,e)}},{key:"validate",value:function(e,n){if(e===t.SESSION_REPORTING_MODE)return n===t.SESSION_REPORTING_MODE_DEFAULT||n===t.SESSION_REPORTING_MODE_KEEPALIVE_TEARDOWN||n===t.SESSION_REPORTING_MODE_METRICS_RECEIVER||n===t.SESSION_REPORTING_MODE_DISABLED||(y.getInstance().printErrorLogs("BpkStreamingSessionOptions","Error: SESSION_REPORTING_MODE should be SESSION_REPORTING_MODE_DEFAULT, SESSION_REPORTING_MODE_KEEPALIVE_TEARDOWN, SESSION_REPORTING_MODE_METRICS_RECEIVER or SESSION_REPORTING_MODE_DISABLED"),!1);if(e===t.SESSION_KEEPALIVE||e===t.SESSION_TEARDOWN)return n===t.SESSION_DISABLED||n===t.SESSION_ENABLED_IF_BROADPEAK_DOMAIN||n===t.SESSION_ENABLED||(y.getInstance().printErrorLogs("BpkStreamingSessionOptions","Error: "+t.optionToString(e)+" value should be SESSION_ENABLED_IF_BROADPEAK_DOMAIN, SESSION_DISABLED or SESSION_ENABLED"),!1);var r="boolean"==typeof n;return r||y.getInstance().printErrorLogs("BpkStreamingSessionOptions","Error: "+t.optionToString(e)+" value should be a boolean"),r}},{key:"print",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"BpkStreamingSessionOptions",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2?arguments[2]:void 0;y.getInstance().printInfoLogs(e,n+"Options",r),y.getInstance().printInfoLogs(e,n+"   MULTICAST_ONLY="+this.get(t.MULTICAST_ONLY),r),y.getInstance().printInfoLogs(e,n+"   REQUEST_REDIRECT_THIRD_PARTY_CDN="+this.get(t.REQUEST_REDIRECT_THIRD_PARTY_CDN),r),y.getInstance().printInfoLogs(e,n+"   REQUEST_DIVERSITY="+this.get(t.REQUEST_DIVERSITY),r),y.getInstance().printInfoLogs(e,n+"   REQUEST_NANO_CDN="+this.get(t.REQUEST_NANO_CDN),r),y.getInstance().printInfoLogs(e,n+"   REQUEST_BROADPEAK_CDN="+this.get(t.REQUEST_BROADPEAK_CDN),r),y.getInstance().printInfoLogs(e,n+"   REQUEST_LOCAL_NANO_CDN_IF_CONNECTED_TO_WIFI="+this.get(t.REQUEST_LOCAL_NANO_CDN_IF_CONNECTED_TO_WIFI),r),y.getInstance().printInfoLogs(e,n+"   SESSION_KEEPALIVE="+t.stateToString(this.get(t.SESSION_KEEPALIVE)),r),y.getInstance().printInfoLogs(e,n+"   SESSION_TEARDOWN="+t.stateToString(this.get(t.SESSION_TEARDOWN)),r),y.getInstance().printInfoLogs(e,n+"   SESSION_REPORTING_MODE="+t.reportingModeToString(this.get(t.SESSION_REPORTING_MODE)),r),y.getInstance().printInfoLogs(e,n+"   PIP_SESSION="+this.get(t.PIP_SESSION),r),y.getInstance().printInfoLogs(e,n+"   ULTRA_LOW_LATENCY_SUPPORT="+this.get(t.ULTRA_LOW_LATENCY_SUPPORT),r)}},{key:"printUpdates",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"BpkStreamingSessionOptions",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2?arguments[2]:void 0;un(this,hn)[hn].forEach((function(o){y.getInstance().printInfoLogs(n,r+"   "+t.optionToString(o)+"="+t.valueToString(o,e.get(o)),i)}))}}])&&an(e.prototype,n),r&&an(e,r),t}();function pn(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}dn.MULTICAST_ONLY=0,dn.ULTRA_LOW_LATENCY_SUPPORT=1,dn.PIP_SESSION=2,dn.REQUEST_REDIRECT_THIRD_PARTY_CDN=100,dn.REQUEST_DIVERSITY=101,dn.REQUEST_NANO_CDN=102,dn.REQUEST_BROADPEAK_CDN=103,dn.REQUEST_LOCAL_NANO_CDN_IF_CONNECTED_TO_WIFI=104,dn.SESSION_KEEPALIVE=200,dn.SESSION_TEARDOWN=201,dn.SESSION_REPORTING_MODE=202,dn.SESSION_DISABLED=-1,dn.SESSION_ENABLED_IF_BROADPEAK_DOMAIN=0,dn.SESSION_ENABLED=1,dn.SESSION_REPORTING_MODE_DEFAULT=0,dn.SESSION_REPORTING_MODE_KEEPALIVE_TEARDOWN=1,dn.SESSION_REPORTING_MODE_METRICS_RECEIVER=2,dn.SESSION_REPORTING_MODE_DISABLED=-1;var vn=0;function yn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function gn(t,e,n){return e&&yn(t.prototype,e),n&&yn(t,n),t}var En="__private_"+vn+++"_instance",Sn=function(){function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.smartLib=void 0}return gn(t,null,[{key:"getInstance",value:function(){return pn(t,En)[En]||(pn(t,En)[En]=new t),pn(t,En)[En]}}]),gn(t,[{key:"init",value:function(){y.getInstance().printDebugLogs("BpkOMSDKMgr","Initializing OM SDK manager...")}},{key:"release",value:function(){}},{key:"attachInstance",value:function(t){this.smartLib=t}},{key:"attachHandler",value:function(t){y.getInstance().printDebugLogs("BpkOMSDKMgr","Attaching OM SDK handler..."),this.omsdkHandler=t}},{key:"isEnabled",value:function(){return void 0!==this.omsdkHandler&&null!==this.omsdkHandler}}]),t}();function bn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Object.defineProperty(Sn,En,{writable:!0,value:void 0});var mn=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.session=void 0,this.playerAdapter=void 0,this.internalAdManager=void 0,this.omsdkHandler=void 0,this.omAdSession=void 0,this.firstImageDate=void 0,this.adBreakPosition=void 0,this.session=e,this.playerAdapter=n,this.internalAdManager=this.session.smartLib.internalAdManager,this.omsdkHandler=Sn.getInstance().omsdkHandler,this.firstImageDate=0,this.adBreakPosition="midroll"}var e,n;return e=t,(n=[{key:"onStart",value:function(){}},{key:"onRedirectionEnd",value:function(){}},{key:"onFirstImage",value:function(t,e){this.firstImageDate=Date.now()}},{key:"onLayerSwitch",value:function(t){}},{key:"onPause",value:function(){var t;null===(t=this.omAdSession)||void 0===t||t.pause()}},{key:"onResume",value:function(){var t;null===(t=this.omAdSession)||void 0===t||t.resume()}},{key:"onBufferingStart",value:function(){var t;null===(t=this.omAdSession)||void 0===t||t.bufferStart()}},{key:"onBufferingEnd",value:function(t){var e;null===(e=this.omAdSession)||void 0===e||e.bufferFinish()}},{key:"onStallEnd",value:function(){}},{key:"onRebufferingEnd",value:function(){}},{key:"onSeek",value:function(t,e){var n;void 0!==this.adData&&Math.abs(e-t)>=1e3&&(e>this.adData.startTime+this.adData.duration||e<this.adData.startTime)&&(null===(n=this.omAdSession)||void 0===n||n.skipped())}},{key:"onStop",value:function(t){}},{key:"onStartSessionReportUpdateRequested",value:function(t){}},{key:"onKeepaliveSessionReportUpdateRequested",value:function(t){}},{key:"onEndSessionReportUpdateRequested",value:function(t){}},{key:"onAdBreakData",value:function(t){y.getInstance().printErrorLogs("BpkOMSessionHandler","ad break data="+JSON.stringify(t),this.session.id),y.getInstance().printErrorLogs("BpkOMSessionHandler","ad break end position="+(t.startTime+t.duration),this.session.id),y.getInstance().printErrorLogs("BpkOMSessionHandler","content end position="+this.playerAdapter.getDuration(),this.session.id),Math.abs(t.startTime+t.duration-this.playerAdapter.getDuration())<1e4?this.adBreakPosition="postroll":Date.now()-this.firstImageDate<3e3?this.adBreakPosition="preroll":this.adBreakPosition="midroll",y.getInstance().printDebugLogs("BpkOMSessionHandler","Ad break position is "+this.adBreakPosition,this.session.id)}},{key:"onAdBreakBegin",value:function(t){}},{key:"onAdData",value:function(t){y.getInstance().printErrorLogs("BpkOMSessionHandler","ad data="+JSON.stringify(t),this.session.id),this.adData=t,this.omAdSession=this.omsdkHandler.createOMAdSession(this.internalAdManager.omPartnerName,this.internalAdManager.omPartnerVersion,"data",[{verificationVendor:"Bpk Ad",verificationURL:"http://192.168.1.65:8000/omid-validation-verification-script-v1.js",verificationParameters:"http://192.168.1.65:8000/sendMessage?msg="}]),this.omAdSession.start(),!0===t.skippable?this.omAdSession.loaded(t.skippableTime-t.startTime,t.duration,this.adBreakPosition,this.playerAdapter.getVolume()):this.omAdSession.loaded(-1,t.duration,this.adBreakPosition,this.playerAdapter.getVolume())}},{key:"onAdBegin",value:function(t,e,n){}},{key:"onAdSkippable",value:function(t,e,n){}},{key:"onAdProgress",value:function(t,e,n,r){this.omAdSession.progress(r)}},{key:"onAdEnd",value:function(t,e,n){this.adData=void 0,this.omAdSession.finish(),this.omAdSession=void 0}},{key:"onAdBreakEnd",value:function(t){this.adData=void 0,void 0!==this.omAdSession&&(this.omAdSession.finish(),this.omAdSession=void 0),this.adBreakPosition="midroll"}},{key:"onVolumeChanged",value:function(t){var e;y.getInstance().printErrorLogs("BpkOMSessionHandler","Volume is now "+t,this.session.id),null===(e=this.omAdSession)||void 0===e||e.volumeChange(t)}}])&&bn(e.prototype,n),t}();function kn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var An=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.smartLib=void 0,this.options=void 0,this.adSession=void 0,this.omSessionHandler=void 0,this.id=void 0,this.listeners=void 0,this.playerAdapter=void 0,this.metricsManager=void 0,this.keepAliveManager=void 0,this.adMetricsManager=void 0,this.adTrackingManager=void 0,this.sessionReport=void 0,this.firstImageCalled=void 0,this.smartLib=e,this.adSession=void 0,this.listeners=[],this.sessionReport=new _e,this.firstImageCalled=!1,this.sessionReport.smartLibParameters=e.getParameters()}var e,n;return e=t,(n=[{key:"initPlayerAdapter",value:function(){void 0!==this.playerAdapter?(y.getInstance().printInfoLogs("BpkSession","Player:name="+this.playerAdapter.getName()+", version="+this.playerAdapter.getVersion(),this.id),y.getInstance().printInfoLogs("BpkSession","Player:capabilities="+JSON.stringify(this.playerAdapter.getCapabilities())),this.playerAdapter.attachSession(this),this.playerAdapter.initSessionPlayerObjects()):y.getInstance().printInfoLogs("BpkSession","Player:no player attached",this.id)}},{key:"initManagers",value:function(){this.metricsManager=new It(this,this.playerAdapter),this.adMetricsManager=new tn(this),this.adTrackingManager=new nn(this,this.playerAdapter),void 0!==this.playerAdapter&&(this.addListener(this.metricsManager),this.addListener(this.playerAdapter)),this.addListener(this.sessionReport.timeline),this.addListener(this.adMetricsManager),this.adTrackingManager.addListener(this.adMetricsManager),void 0!==this.adSession&&this.adSession.hasAdParameters()&&Sn.getInstance().isEnabled()&&(this.omSessionHandler=new mn(this,this.playerAdapter),this.addListener(this.omSessionHandler),this.adTrackingManager.addListener(this.omSessionHandler)),this.addListener(this),M.getInstance().addListener(this.sessionReport.timeline),M.getInstance().addListener(this)}},{key:"start",value:function(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};y.getInstance().printInfoLogs("BpkSession","Starting streaming session with redirect...",this.id),this.sessionReport.requestedURL=e,this.initPlayerAdapter(),this.initManagers(),this.notifyStart();var i=this.smartLib.getParameters(),o={analyticsAddress:i.analyticsAddress,nanoCDNHost:this.smartLib.nanoCDNHostManager.getCurrentNanoCDNHost(),nanoCDNHostConfigured:this.smartLib.nanoCDNHostManager.getCurrentNanoCDNHost(),broadpeakDomainNames:i.broadpeakDomainNames,forceTeardown:i.forceTeardown,userAgent:i.userAgent};return 0!==o.nanoCDNHost.length&&(this.sessionReport.nanoCDNStatus=t.NANOCDN_STATUS_DETECTED_NOT_USED),V.getInstance().getURL(e,o,this).then((function(t){return Xe.getInstance().isActive()&&!t.isError()&&!0===n.options.get(dn.REQUEST_DIVERSITY)&&(t.url=Xe.getInstance().rewriteURL(t.getURL())),t})).then((function(t){return n.sessionReport.redirectedURL=n.patchBkmResult(t.getURL()),n.handleRedirectedURL(o),y.getInstance().printInfoLogs("BpkSession","getURL result: "+n.sessionReport.redirectedURL,n.id),t.url=n.sessionReport.redirectedURL,r(n.sessionReport.redirectedURL),t}))}},{key:"handleRedirectedURL",value:function(e){this.isNanoCDNUsed()&&(this.sessionReport.nanoCDNStatus=t.NANOCDN_STATUS_USED),0!==this.sessionReport.redirectedURL.length&&(this.sessionReport.sessionRunning=!0),this.sessionReport.teardownActivated=this.isTeardownActivated(e),this.sessionReport.redirectedURL=this.removeBroadpeakParameters(this.sessionReport.redirectedURL),this.sessionReport.sessionId=this.getTicket(),this.sessionReport.teardownActivated||this.sessionReport.timeline.encoder.extend(),this.notifyRedirectionEnd(),void 0===this.playerAdapter&&this.sessionReport.sessionRunning&&this.notifyFirstImage(0,0)}},{key:"stop",value:function(t){if(M.getInstance().removeListener(this.sessionReport.timeline),M.getInstance().removeListener(this),void 0===t||isNaN(t)||(this.sessionReport.statusCode=t),this.notifyStop(this.sessionReport.statusCode),void 0!==this.keepAliveManager&&this.keepAliveManager.stop(),this.sessionReport.sessionRunning){y.getInstance().printDebugLogs("BpkSession","Session ends with status code: "+this.sessionReport.statusCode,this.id);var e=this.smartLib.getParameters();this.sessionReport.sessionRunning=!1,this.sessionReport.endSessionDate=Date.now();try{var n=Xe.getInstance().getStats(this.sessionReport.sessionId,1);null!=n&&0!==n.length?this.sessionReport.diversity=JSON.parse(n):this.sessionReport.diversity={}}catch(t){y.getInstance().printWarnLogs("BpkSession","Invalid Diversity metrics",this.id)}this.sessionReport.smartLibParameters=JSON.parse(JSON.stringify(this.sessionReport.smartLibParameters)),this.notifyEndSessionReportUpdateRequested(this.sessionReport),y.getInstance().printDebugLogs("BpkSession","SessionReport: "+this.sessionReport.toString(),this.id),this.smartLib.resetCustomParameters();var r={analyticsAddress:e.analyticsAddress,userAgent:e.userAgent},i=this.options.get(dn.SESSION_TEARDOWN),o=this.options.get(dn.SESSION_REPORTING_MODE);i===dn.SESSION_ENABLED?(this.sessionReport.teardownRequestDate=Date.now(),V.getInstance().teardown(this,r),o===dn.SESSION_REPORTING_MODE_METRICS_RECEIVER&&(this.sessionReport.endSessionRequestDate=Date.now(),V.getInstance().endSession(this,r))):i===dn.SESSION_ENABLED_IF_BROADPEAK_DOMAIN?this.sessionReport.teardownActivated?(this.sessionReport.teardownRequestDate=Date.now(),V.getInstance().teardown(this,r),o===dn.SESSION_REPORTING_MODE_METRICS_RECEIVER&&(this.sessionReport.endSessionRequestDate=Date.now(),V.getInstance().endSession(this,r))):o!==dn.SESSION_REPORTING_MODE_DEFAULT&&o!==dn.SESSION_REPORTING_MODE_METRICS_RECEIVER||(this.sessionReport.endSessionRequestDate=Date.now(),V.getInstance().endSession(this,r)):i===dn.SESSION_DISABLED&&(o!==dn.SESSION_REPORTING_MODE_DEFAULT&&o!==dn.SESSION_REPORTING_MODE_METRICS_RECEIVER||(this.sessionReport.endSessionRequestDate=Date.now(),V.getInstance().endSession(this,r)))}void 0!==this.playerAdapter&&(this.playerAdapter.releaseSessionPlayerObjects(),this.playerAdapter.detachSession()),this.listeners=[]}},{key:"onFirstImage",value:function(t,e){if(!this.isSessionCreated(this.sessionReport.requestedURL)){var n=this.options.get(dn.SESSION_TEARDOWN),r=this.options.get(dn.SESSION_REPORTING_MODE),i=n===dn.SESSION_ENABLED_IF_BROADPEAK_DOMAIN&&!this.sessionReport.teardownActivated||n===dn.SESSION_DISABLED;if(r===dn.SESSION_REPORTING_MODE_DEFAULT&&i||r===dn.SESSION_REPORTING_MODE_METRICS_RECEIVER){this.sessionReport.startSessionRequestDate=Date.now(),this.notifyStartSessionReportUpdateRequested(this.sessionReport);var o=this.smartLib.getParameters(),s={analyticsAddress:o.analyticsAddress,userAgent:o.userAgent};V.getInstance().startSession(this,s)}}var a=this.options.get(dn.SESSION_KEEPALIVE);a===dn.SESSION_ENABLED?(y.getInstance().printInfoLogs("BpkSession","Keepalive is enabled (SESSION_KEEPALIVE=SESSION_ENABLED)",this.id),this.keepAliveManager=new Be(this),this.keepAliveManager.start()):a===dn.SESSION_ENABLED_IF_BROADPEAK_DOMAIN?this.sessionReport.teardownActivated&&(this.keepAliveManager=new Be(this),this.keepAliveManager.start()):a===dn.SESSION_DISABLED&&this.sessionReport.teardownActivated&&y.getInstance().printInfoLogs("BpkSession","Keepalive is disabled (SESSION_KEEPALIVE=SESSION_DISABLED)",this.id)}},{key:"isNanoCDNUsed",value:function(){var t=this,e=!1;return"string"==typeof this.sessionReport.redirectedURL&&0!==this.sessionReport.redirectedURL.length&&this.smartLib.nanoCDNHostManager.getNanoCDNHostList().forEach((function(n){t.sessionReport.redirectedURL.indexOf(n)>0&&(e=!0)})),e}},{key:"patchBkmResult",value:function(t){var e=E.parseURL(t);if(null!==e){var n=t,r=e.query.split("&");return r.length>=2&&-1===r[0].indexOf("bk-teardown=")&&(n=n.replace("?bk-teardown=","&bk-teardown=")),-1!==n.indexOf("//bpk-token")&&(n=n.replace("//bpk-token","/bpk-token")),n}return t}},{key:"getTicket",value:function(){var t,e=E.getParam(this.sessionReport.redirectedURL,V.QUERY_PARAMETER_SESSION_ID);if(""===e&&(t=this.sessionReport.redirectedURL.split("/")).length>=4&&(t[3].match("\\[(.*)\\]")?e=t[3].substring(1,t[3].length-1):t[3].match("\\%5B(.*)\\%5D")&&(e=t[3].substring(3,t[3].length-3))),""===e){var n=this.sessionReport.redirectedURL.split("//");(t=n[n.length-1].split("/")).length>=3&&(t[0].match(E.REGEX_IP)||t[0].match(E.REGEX_HOSTNAME))&&"bpk-token"===t[1]&&t[2].match(E.REGEX_TICKET)&&(e=t[2],y.getInstance().printVerboseLogs("BpkSession","Ticket detected: "+e,this.id))}if(""===e){var r=this.sessionReport.redirectedURL.split("//");(t=r[r.length-1].split("/")).length>=2&&(t[0].match(E.REGEX_IP)||t[0].match(E.REGEX_HOSTNAME))&&t[1].match(E.REGEX_TICKET)&&(e=t[1],y.getInstance().printVerboseLogs("BpkSession","Ticket detected: "+e,this.id))}return""===e&&(e=this.generateTicket()),""===e&&(y.getInstance().printWarnLogs("BpkSession","Failed getting ticket",this.id),y.getInstance().printWarnLogs("BpkSession","SmartLib won't be able to post metrics",this.id)),e}},{key:"generateTicket",value:function(){var t=Date.now(),e=m.randomIntFromInterval(1e6,9999999),n=m.stringToBase64(e+t);return null===n?(y.getInstance().printWarnLogs("BpkSession","Cannot encode base 64 ticket",this.id),""):(y.getInstance().printVerboseLogs("BpkSession","Ticket generated: "+n,this.id),n)}},{key:"getTeardown",value:function(){var t=E.getParam(this.sessionReport.redirectedURL,"bk-teardown");return t.startsWith("T")||t.startsWith("t")||t.startsWith("1")}},{key:"isTeardownActivated",value:function(e){return e.forceTeardown===Br.FORCE_TEARDOWN_ENABLED?(y.getInstance().printInfoLogs("BpkSession","Session will start with keepalives/teardown (forceTeardown)",this.id),!0):e.forceTeardown===Br.FORCE_TEARDOWN_DISABLED?(y.getInstance().printInfoLogs("BpkSession","Session will start without keepalives/teardown (forceTeardown)",this.id),!1):null!==this.sessionReport.redirectedURL&&"0"===E.getParam(this.sessionReport.redirectedURL,"bk-teardown")?(y.getInstance().printInfoLogs("BpkSession","Session will start without keepalives/teardown (bk-teardown=0)",this.id),!1):null!==this.sessionReport.redirectedURL&&this.getTeardown()?(y.getInstance().printInfoLogs("BpkSession","Session will start with keepalives/teardown (bk-teardown=1)",this.id),!0):this.sessionReport.nanoCDNStatus===t.NANOCDN_STATUS_USED?(y.getInstance().printInfoLogs("BpkSession","Session will start with keepalives/teardown (nanoCDN used)",this.id),!0):!1===this.options.get(dn.REQUEST_BROADPEAK_CDN)?(y.getInstance().printInfoLogs("BpkSession","Session will start without keepalives/teardown (REQUEST_BROADPEAK_CDN=false)",this.id),!1):null!==this.sessionReport.requestedURL&&V.isBroadpeakDomainName(this.sessionReport.requestedURL,e.broadpeakDomainNames)?(y.getInstance().printInfoLogs("BpkSession","Session will start with keepalives/teardown (in broadpeak domains list)",this.id),!0):(y.getInstance().printInfoLogs("BpkSession","Session will start without keepalives/teardown",this.id),!1)}},{key:"removeBroadpeakParameters",value:function(t){var e=E.parseURL(t);if(null!==e){for(var n="",r=e.query.split("&"),i=1,o=0;o<r.length;o++){var s=r[o];s.startsWith("bk-")||s.startsWith("bpk-")?y.getInstance().printDebugLogs("BpkSession","Remove query parameter '"+s+"' from url",this.id):(i||(n+="&"),n+=s,i=0)}return""===n?t.replace("?"+e.query,""):t.replace(e.query,n)}return t}},{key:"isSessionCreated",value:function(t){if(null===t)return!1;var e=E.getParam(t,V.QUERY_PARAMETER_SESSION_ID);return 0!==e.length||(e=E.getParam(t,V.QUERY_PARAMETER_SESSION_CREATED)).startsWith("T")||e.startsWith("t")||e.startsWith("1")}},{key:"addListener",value:function(t){this.listeners.includes(t)||this.listeners.push(t)}},{key:"removeListener",value:function(t){var e=this.listeners.indexOf(t);-1!==e&&this.listeners.splice(e,1)}},{key:"notifyEvent",value:function(t,e,n,r){"function"==typeof t[e]&&t[e](n,r)}},{key:"notifyStart",value:function(){var t,e,n=this;t=M.getInstance().networkType,this.sessionReport.addNetworkType(t),e=M.getInstance().mute,this.listeners.forEach((function(r){n.notifyEvent(r,"onStart",t,e)}))}},{key:"notifyRedirectionEnd",value:function(){var t=this;this.listeners.forEach((function(e){t.notifyEvent(e,"onRedirectionEnd")}))}},{key:"notifyFirstImage",value:function(t,e){var n=this;this.firstImageCalled?y.getInstance().printErrorLogs("BpkSession","Implementation error: PlayerEventListener.onSessionStart() already called. If you don't attach any player, please remove this call, SmartLib is now handling it automatically.",this.id):(this.firstImageCalled=!0,void 0!==this.adSession&&this.adSession.hasAdParameters()?void 0!==this.playerAdapter?!0===this.playerAdapter.getCapabilities().adTracking?(y.getInstance().printDebugLogs("BpkSession","Ad tracking enabled",this.id),this.addListener(this.adTrackingManager)):y.getInstance().printDebugLogs("BpkSession","Ad tracking disabled (player not compatible)",this.id):y.getInstance().printDebugLogs("BpkSession","Ad tracking disabled (no player attached)",this.id):y.getInstance().printDebugLogs("BpkSession","Ad tracking disabled (adSession disabled)",this.id),this.listeners.forEach((function(r){n.notifyEvent(r,"onFirstImage",t,e)})))}},{key:"notifyLayerSwitch",value:function(t){var e=this;this.listeners.forEach((function(n){e.notifyEvent(n,"onLayerSwitch",t)}))}},{key:"notifyPause",value:function(){var t=this;this.listeners.forEach((function(e){t.notifyEvent(e,"onPause")}))}},{key:"notifyResume",value:function(){var t=this;this.listeners.forEach((function(e){t.notifyEvent(e,"onResume")}))}},{key:"notifyBufferingStart",value:function(){var t=this;this.listeners.forEach((function(e){t.notifyEvent(e,"onBufferingStart")}))}},{key:"notifyBufferingEnd",value:function(t){var e=this;this.listeners.forEach((function(n){e.notifyEvent(n,"onBufferingEnd",t)}))}},{key:"notifyStallEnd",value:function(){var t=this;this.listeners.forEach((function(e){t.notifyEvent(e,"onStallEnd")}))}},{key:"notifyRebufferingEnd",value:function(){var t=this;this.listeners.forEach((function(e){t.notifyEvent(e,"onRebufferingEnd")}))}},{key:"notifySeek",value:function(t,e){var n=this;this.listeners.forEach((function(r){n.notifyEvent(r,"onSeek",t,e)}))}},{key:"notifyStop",value:function(t){var e=this;this.listeners.forEach((function(n){e.notifyEvent(n,"onStop",t)}))}},{key:"notifyStartSessionReportUpdateRequested",value:function(t){var e=this;this.listeners.forEach((function(n){e.notifyEvent(n,"onStartSessionReportUpdateRequested",t)}))}},{key:"notifyKeepaliveSessionReportRequested",value:function(t){var e=this;this.listeners.forEach((function(n){e.notifyEvent(n,"onKeepaliveSessionReportUpdateRequested",t)}))}},{key:"notifyEndSessionReportUpdateRequested",value:function(t){var e=this;this.listeners.forEach((function(n){e.notifyEvent(n,"onEndSessionReportUpdateRequested",t)}))}},{key:"notifyVolumeChanged",value:function(t){var e=this;this.listeners.forEach((function(n){e.notifyEvent(n,"onVolumeChanged",t)}))}},{key:"onNetworkAvailable",value:function(t){y.getInstance().printVerboseLogs("BpkSession","Received event onNetworkAvailable type:"+t),this.sessionReport.addNetworkType(t)}}])&&kn(e.prototype,n),t}();function In(t){return(In="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Dn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Rn(t,e){return(Rn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Tn(t,e){return!e||"object"!==In(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _n(t){return(_n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}An.NANOCDN_STATUS_UNAVAILABLE=1,An.NANOCDN_STATUS_DETECTED_NOT_USED=2,An.NANOCDN_STATUS_USED=3;var Nn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Rn(t,e)}(i,t);var e,n,r=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=_n(t);if(e){var i=_n(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Tn(this,n)}}(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=r.call(this,t)).startCalled=void 0,e.startCalled=!1,e}return e=i,(n=[{key:"getQuery",value:function(){var t=this.smartLib.nanoCDNHostManager.getCurrentNanoCDNHost(),e=t?"nanoCDN host: "+t:"No nanoCDN found";y.getInstance().printInfoLogs("BpkProxySession",e+" ("+S+")"),this.initPlayerAdapter(),this.initManagers(),this.notifyStart();var n="bk-ml=1";return void 0!==t&&0!==t.length&&(n+="&nanocdnhost="+t,this.sessionReport.nanoCDNStatus=An.NANOCDN_STATUS_DETECTED_NOT_USED),y.getInstance().printInfoLogs("BpkProxySession","getQuery result : "+n),n}},{key:"start",value:function(t,e){if(this.startCalled)y.getInstance().printErrorLogs("BpkProxySession","Implementation error: SmartLib.startStreamingSession(...) already called.");else{y.getInstance().printInfoLogs("BpkProxySession","Starting streaming session..."),this.startCalled=!0,this.sessionReport.requestedURL=t,this.sessionReport.redirectedURL=e;var n=this.smartLib.getParameters(),r={broadpeakDomainNames:n.broadpeakDomainNames,forceTeardown:n.forceTeardown};this.handleRedirectedURL(r)}}}])&&Dn(e.prototype,n),i}(An);function Ln(t){return(Ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function On(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n(54);var Pn=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.session=void 0,this.webOSVersion=void 0,"undefined"!=typeof webOS&&webOS.deviceInfo((function(t){e.webOSVersion=t.sdkVersion}))}var e,n,r;return e=t,r=[{key:"checkPlayer",value:function(t,e){return y.getInstance().printErrorLogs("BpkPlayerAdapter","Implementation error: static checkPlayer not implemented for this adapter."),!1}}],(n=[{key:"getName",value:function(){return""}},{key:"getVersion",value:function(){return""}},{key:"getOSName",value:function(){return"undefined"!=typeof device&&void 0!==device.platform?device.platform:"undefined"!=typeof webOS||"object"===("undefined"==typeof navigator?"undefined":Ln(navigator))&&void 0!==navigator.userAgent&&-1!==navigator.userAgent.indexOf("Web0S")?"webOS":"undefined"!=typeof tizen||"object"===("undefined"==typeof navigator?"undefined":Ln(navigator))&&void 0!==navigator.userAgent&&-1!==navigator.userAgent.indexOf("Tizen")?"Tizen":"undefined"!=typeof window&&void 0!==window.navigator&&void 0!==window.navigator.platform?window.navigator.platform:"NA"}},{key:"getOSVersion",value:function(){var t;if("undefined"!=typeof device&&void 0!==device.version)t=device.version;else if("undefined"!=typeof webOS)t=this.webOSVersion;else{if("undefined"!=typeof tizen&&void 0!==tizen.systeminfo)return tizen.systeminfo.getCapability("http://tizen.org/feature/platform.version");"undefined"!=typeof window&&void 0!==window.navigator&&void 0!==window.navigator.appVersion&&(t=window.navigator.appVersion)}void 0===t&&(t="");var e=t.replace(/ /g,"_").replace(/;/g,"_");return e.length>=30?e.substring(0,30):0===e.length?"NA":e}},{key:"getDeviceType",value:function(){return"undefined"!=typeof cast&&void 0!==cast.receiver?"chromecast":"undefined"!=typeof tizen&&void 0!==tizen.systeminfo||"undefined"!=typeof webOS||"object"===("undefined"==typeof navigator?"undefined":Ln(navigator))&&void 0!==navigator.userAgent&&-1!==navigator.userAgent.indexOf("Web0S")?"tv":""}},{key:"getBitrate",value:function(){return-1}},{key:"getPosition",value:function(){return 0}},{key:"getDuration",value:function(){return 0}},{key:"getVolume",value:function(){return 1}},{key:"getCapabilities",value:function(){return{adTracking:!1}}},{key:"initSessionPlayerObjects",value:function(){}},{key:"releaseSessionPlayerObjects",value:function(){}},{key:"onKeepaliveSessionReportUpdateRequested",value:function(t){t.playerName=this.getName(),t.playerVersion=this.getVersion(),t.osName=this.getOSName(),t.osVersion=this.getOSVersion(),t.deviceType=this.getDeviceType()}},{key:"onEndSessionReportUpdateRequested",value:function(t){t.playerName=this.getName(),t.playerVersion=this.getVersion(),t.osName=this.getOSName(),t.osVersion=this.getOSVersion(),t.deviceType=this.getDeviceType()}},{key:"notifyFirstImage",value:function(){void 0!==this.session?this.session.notifyFirstImage(this.getBitrate(),this.getPosition()):y.getInstance().printErrorLogs("BpkPlayerAdapter","Implementation error: SmartLib.getURL(...) or SmartLib.getQuery()/SmartLib.startStreamingSession(...) should be called prior to onSessionStart event. This event is called when the first image is displayed.")}},{key:"notifyPause",value:function(){void 0!==this.session?this.session.notifyPause():y.getInstance().printErrorLogs("BpkPlayerAdapter","Implementation error: SmartLib.getURL(...) or SmartLib.getQuery()/SmartLib.startStreamingSession(...) should be called prior to onSessionPause event.")}},{key:"notifyResume",value:function(){void 0!==this.session?this.session.notifyResume():y.getInstance().printErrorLogs("BpkPlayerAdapter","Implementation error: SmartLib.getURL(...) or SmartLib.getQuery()/SmartLib.startStreamingSession(...) should be called prior to onSessionResume event.")}},{key:"notifyLayerSwitch",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getBitrate();void 0!==this.session?this.session.notifyLayerSwitch(t):y.getInstance().printErrorLogs("BpkPlayerAdapter","Implementation error: SmartLib.getURL(...) or SmartLib.getQuery()/SmartLib.startStreamingSession(...) should be called prior to onLayerSwitch event.")}},{key:"notifySeek",value:function(t,e){void 0!==this.session?this.session.notifySeek(t,e):y.getInstance().printErrorLogs("BpkPlayerAdapter","Implementation error: SmartLib.getURL(...) or SmartLib.getQuery()/SmartLib.startStreamingSession(...) should be called prior to onSeek event.")}},{key:"notifyStallStart",value:function(){void 0!==this.session?this.session.notifyBufferingStart():y.getInstance().printErrorLogs("BpkPlayerAdapter","Implementation error: SmartLib.getURL(...) or SmartLib.getQuery()/SmartLib.startStreamingSession(...) should be called prior to onStallStart event.")}},{key:"notifyStallEnd",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];void 0!==this.session?this.session.notifyBufferingEnd(t):y.getInstance().printErrorLogs("BpkPlayerAdapter","Implementation error: SmartLib.getURL(...) or SmartLib.getQuery()/SmartLib.startStreamingSession(...) should be called prior to onStallEnd event.")}},{key:"notifyVolumeChanged",value:function(t){void 0!==this.session?this.session.notifyVolumeChanged(t):y.getInstance().printErrorLogs("BpkPlayerAdapter","Implementation error: SmartLib.getURL(...) or SmartLib.getQuery()/SmartLib.startStreamingSession(...) should be called prior to onVolumeChanged event.")}},{key:"attachPlayer",value:function(t,e){return y.getInstance().printErrorLogs("BpkPlayerAdapter","Implementation error: attachPlayer not implemented for this adapter."),!1}},{key:"detachPlayer",value:function(){y.getInstance().printErrorLogs("BpkPlayerAdapter","Implementation error: detachPlayer not implemented for this adapter.")}},{key:"attachSession",value:function(t){this.session=t}},{key:"detachSession",value:function(){this.session=void 0}},{key:"setStatusCode",value:function(t){void 0!==this.session&&(this.session.sessionReport.statusCode=t)}},{key:"setPlayerErrorCode",value:function(t){void 0!==this.session&&(this.session.sessionReport.playerErrorCode=String(t))}}])&&On(e.prototype,n),r&&On(e,r),t}();function wn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Cn=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,(n=[{key:"getPlayerName",value:function(){return""}},{key:"getVersion",value:function(){return""}},{key:"getOSName",value:function(){return""}},{key:"getDeviceVersion",value:function(){return""}},{key:"getDeviceType",value:function(){return""}},{key:"getCurrentPosition",value:function(){return 0}},{key:"getTotalDuration",value:function(){return 0}},{key:"getCurrentBitrate",value:function(){return 0}}])&&wn(e,n),t}();function Mn(t){return(Mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n(215);var xn=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,(n=[{key:"getMethods",value:function(t){for(var e=Object.getOwnPropertyNames(t),n=[],r=0;r<e.length;r++)-1===["caller","callee","arguments"].indexOf(e[r])&&"function"==typeof t[e[r]]&&n.push(e[r]);return n}},{key:"hasMethods",value:function(t,e){var n=!0;return void 0!==t&&(e.forEach((function(e){"function"!=typeof t[e]&&(n=!1)})),n)}},{key:"hasTypeOrNull",value:function(t,e){return Mn(t)===e||null===t}}])&&Bn(e,n),t}();function Un(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var jn=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,(n=[{key:"addPlayerAdapter",value:function(e){-1===t.playerAdapters.indexOf(e)&&t.playerAdapters.push(e)}},{key:"removePlayerAdapter",value:function(e){var n=t.playerAdapters.indexOf(e);-1!==n&&t.playerAdapters.splice(n,1)}},{key:"isStarted",value:function(){var e=t.playerAdapters;return e.length>0&&void 0!==e[e.length-1].session&&e[e.length-1].session.metricsManager.started}},{key:"isPlaying",value:function(){var e=t.playerAdapters;return e.length>0&&void 0!==e[e.length-1].session&&e[e.length-1].session.metricsManager.playing}},{key:"isBuffering",value:function(){var e=t.playerAdapters;return e.length>0&&void 0!==e[e.length-1].session&&e[e.length-1].session.metricsManager.buffering}},{key:"onSessionStart",value:function(){var e=t.playerAdapters;e.length>0?e.forEach((function(t){return t.notifyFirstImage()})):y.getInstance().printErrorLogs("BpkPlayerEventListener","Implementation error: SmartLib.attachPlayer(...) should be called prior to onSessionStart event. If you don't attach any player, please remove this call, SmartLib is now handling it automatically.")}},{key:"onSessionPause",value:function(){var e=t.playerAdapters;e.length>0?e.forEach((function(t){return t.notifyPause()})):y.getInstance().printErrorLogs("BpkPlayerEventListener","Implementation error: SmartLib.attachPlayer(...) should be called prior to onSessionPause event.")}},{key:"onSessionResume",value:function(){var e=t.playerAdapters;e.length>0?e.forEach((function(t){return t.notifyResume()})):y.getInstance().printErrorLogs("BpkPlayerEventListener","Implementation error: SmartLib.attachPlayer(...) should be called prior to onSessionResume event.")}},{key:"onLayerSwitch",value:function(e){var n=t.playerAdapters;n.length>0?n.forEach((function(t){return t.notifyLayerSwitch(e)})):y.getInstance().printErrorLogs("BpkPlayerEventListener","Implementation error: SmartLib.attachPlayer(...) should be called prior to onLayerSwitch event.")}},{key:"onSeek",value:function(e,n){var r=t.playerAdapters;r.length>0?r.forEach((function(t){return t.notifySeek(e,n)})):y.getInstance().printErrorLogs("BpkPlayerEventListener","Implementation error: SmartLib.attachPlayer(...) should be called prior to onSeek event.")}},{key:"onStallStart",value:function(){var e=t.playerAdapters;e.length>0?e.forEach((function(t){return t.notifyStallStart()})):y.getInstance().printErrorLogs("BpkPlayerEventListener","Implementation error: SmartLib.attachPlayer(...) should be called prior to onStallStart event.")}},{key:"onStallEnd",value:function(e){var n=t.playerAdapters;n.length>0?n.forEach((function(t){return t.notifyStallEnd(e)})):y.getInstance().printErrorLogs("BpkPlayerEventListener","Implementation error: SmartLib.attachPlayer(...) should be called prior to onStallEnd event.")}}])&&Un(e,n),t}();function Fn(t){return(Fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Hn(t,e,n){return(Hn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Wn(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Vn(t,e){return(Vn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Yn(t,e){return!e||"object"!==Fn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Wn(t){return(Wn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}jn.playerAdapters=[];var qn=0,Kn="__private_"+qn+++"_genericPlayerMethods",Qn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Vn(t,e)}(o,t);var e,n,r,i=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Wn(t);if(e){var i=Wn(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yn(this,n)}}(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this)).player=void 0,t.listener=void 0,t}return e=o,r=[{key:"checkPlayer",value:function(t,e){return xn.hasMethods(t,function(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}(o,Kn)[Kn])}}],(n=[{key:"getName",value:function(){return this.player.getPlayerName()}},{key:"getVersion",value:function(){return this.player.getVersion()}},{key:"getOSName",value:function(){return this.player.getOSName()}},{key:"getOSVersion",value:function(){return this.player.getDeviceVersion()}},{key:"getDeviceType",value:function(){return this.player.getDeviceType()}},{key:"getBitrate",value:function(){return this.player.getCurrentBitrate()}},{key:"getPosition",value:function(){return this.player.getCurrentPosition()}},{key:"getDuration",value:function(){return this.player.getTotalDuration()}},{key:"getCapabilities",value:function(){return"function"==typeof this.player.getCapabilities?this.player.getCapabilities():Hn(Wn(o.prototype),"getCapabilities",this).call(this)}},{key:"attachPlayer",value:function(t,e){return!!o.checkPlayer(t,e)&&(this.player=t,this.listener=e,jn.addPlayerAdapter(this),!0)}},{key:"detachPlayer",value:function(){jn.removePlayerAdapter(this),this.player=void 0,this.listener=void 0}}])&&Gn(e.prototype,n),r&&Gn(e,r),o}(Pn);function zn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Object.defineProperty(Qn,Kn,{writable:!0,value:xn.getMethods(Cn)});var Jn=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.smartLib=void 0,this.options=void 0,this.adSession=void 0,this.id=void 0,this.date=void 0,this.handler=void 0,this.playerAdapter=void 0,this.stopped=void 0,this.smartLib=e,this.options=n,this.id=m.randomIntFromInterval(1e4,99999),this.date=Date.now(),this.stopped=!1}var e,n;return e=t,(n=[{key:"attachPlayer",value:function(t,e){t instanceof Qn?y.getInstance().printErrorLogs("BpkStreamingSession","SmartLib Generic is not yet compatible, please ask Broadpeak for further information.",this.id):void 0!==t?void 0===this.handler?(this.playerAdapter=t,y.getInstance().printInfoLogs("BpkStreamingSession","Player "+this.playerAdapter.getName()+" attached",this.id)):y.getInstance().printErrorLogs("BpkStreamingSession","Exception: attachPlayer error, you cannot attach a player when a session is running.",this.id):y.getInstance().printWarnLogs("BpkStreamingSession","Try to attach a player, but it is not recognized",this.id)}},{key:"setOption",value:function(t,e){void 0===this.handler?(y.getInstance().printDebugLogs("BpkStreamingSession","Setting session option "+dn.optionToString(t)+" to "+dn.valueToString(t,e),this.id),this.options.set(t,e)):y.getInstance().printErrorLogs("BpkStreamingSession","Exception: setOption error, you cannot set an option when a session is running.",this.id)}},{key:"setAdEventsListener",value:function(t){void 0===this.adSession&&(this.adSession=new Se(this.smartLib)),this.adSession.setAdEventsListener(t)}},{key:"setAdParameter",value:function(t,e){void 0===this.adSession&&(this.adSession=new Se(this.smartLib)),this.adSession.setAdParameter(t,e)}},{key:"setEventCallbackEnabled",value:function(t){void 0===this.adSession&&(this.adSession=new Se(this.smartLib)),this.adSession.setEventCallbackEnabled(t)}},{key:"getURL",value:function(t){var e=this;return y.getInstance().printInfoLogs("BpkStreamingSession","getURL with "+t,this.id),void 0===this.handler?it.typeParameter(t,"string","Error: requestedURL should be a string")&&it.stringNonEmpty(t,"Error: requestedURL is empty")?(this.handler=this.smartLib.sessionManager.createSessionHandler(this),this.handler.adSession=this.adSession,void 0!==this.adSession&&(this.adSession.session=this.handler),this.handler.start(t).then((function(t){return e.stopped?(y.getInstance().printDebugLogs("BpkStreamingSession","The session has been stopped while creating it.",e.id),e.handler.stop(),Ur.error(Ur.RESULT_SESSION_HAS_BEEN_STOPPED_DURING_REQUEST)):t}))):Promise.resolve(Ur.error(Ur.RESULT_API_PARAMETER_FORMAT_ERROR)):(y.getInstance().printErrorLogs("BpkStreamingSession","Exception: getURL error, the session is already running.",this.id),Promise.resolve(Ur.error(Ur.RESULT_REQUEST_ALREADY_DONE)))}},{key:"getQuery",value:function(){return y.getInstance().printInfoLogs("BpkStreamingSession","getQuery",this.id),void 0===this.handler?(this.handler=this.smartLib.sessionManager.createProxySessionHandler(this),this.handler.getQuery()):(y.getInstance().printErrorLogs("BpkStreamingSession","Exception: getQuery error, the session is already running.",this.id),"")}},{key:"startStreamingSession",value:function(t,e){return y.getInstance().printInfoLogs("BpkStreamingSession","startStreamingSession with "+t+" and "+e,this.id),!(!it.typeParameter(t,"string","Error: requestedURL should be a string")||!it.typeParameter(e,"string","Error: redirectedURL should be a string")||(void 0===this.handler?(y.getInstance().printErrorLogs("BpkStreamingSession","Exception: startSteamingSession error, getQuery() should be called prior to startStreamingSession(...)"),1):this.handler instanceof Nn?(this.handler.start(t,e),0):(y.getInstance().printErrorLogs("BpkStreamingSession","Exception: startSteamingSession error, startStreamingSession(...) cannot be called once getURL(...) has been called"),1)))}},{key:"stopStreamingSession",value:function(t){return void 0!==t?y.getInstance().printInfoLogs("BpkStreamingSession","Stopping streaming session with statusCode "+t+"...",this.id):y.getInstance().printInfoLogs("BpkStreamingSession","Stopping streaming session...",this.id),void 0!==this.handler&&(this.stopped?y.getInstance().printErrorLogs("BpkStreamingSession","Exception: stopStreamingSession error, the session is not running",this.id):this.handler.stop(t)),void 0!==this.playerAdapter&&this.playerAdapter.detachPlayer(),this.stopped=!0,this.handler}}])&&zn(e.prototype,n),t}();function Xn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var $n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.smartLib=void 0,this.sessions=void 0}var e,n;return e=t,(n=[{key:"init",value:function(t){this.smartLib=t,this.sessions=[]}},{key:"createStreamingSession",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;this.cleanFinishedSessions();var n=new Jn(this.smartLib,dn.create(t,e));return this.sessions.push(n),this.sessions.length>10&&y.getInstance().printWarnLogs("BpkSessionMgr","There are "+this.sessions.length+" active sessions. Use session.stopStreamingSession() to free up memory."),n}},{key:"cleanFinishedSessions",value:function(){for(var e=this.sessions.length-1;e>=0;e--){var n,r=this.sessions[e];void 0===r.handler&&Date.now()-r.date>t.UNSTARTED_SESSION_MAX_DURATION?(null===(n=r.playerAdapter)||void 0===n||n.detachPlayer(),this.sessions.splice(e,1)):r.stopped&&this.sessions.splice(e,1)}}},{key:"createSessionHandler",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,e=new An(this.smartLib);return void 0!==t?(e.id=t.id,e.options=t.options,e.playerAdapter=t.playerAdapter):e.options=new dn,e}},{key:"createProxySessionHandler",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,e=new Nn(this.smartLib);return void 0!==t?(e.id=t.id,e.options=t.options,e.playerAdapter=t.playerAdapter):e.options=new dn,e}},{key:"release",value:function(){this.cleanFinishedSessions(),this.sessions.forEach((function(t){t.stopStreamingSession()})),this.sessions=[]}}])&&Xn(e.prototype,n),t}();$n.UNSTARTED_SESSION_MAX_DURATION=36e4;var Zn=n(153);function tr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var er=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hostIP=void 0,this.nbSessions=void 0,this.maxNbSessionsN=void 0,this.ratio=void 0,this.jsonAccountId=void 0,this.hostIP="",this.nbSessions=0,this.maxNbSessions=t.NANOCDNDESCR_DEFAULT_MAX_SESSION,this.ratio=0,this.jsonAccountId=""}var e,n,r;return e=t,r=[{key:"parseNanoCDNStatusResponse",value:function(e,n){var r,i,o=Object(Zn.fromXML)(e);if(void 0!==o[t.NANOCDNDESCR_NANOCDN_TAG]){if((r=new t).hostIP=n,void 0!==o[t.NANOCDNDESCR_NANOCDN_TAG][t.NANOCDNDESCR_SESSIONS_TAG]&&(void 0!==o[t.NANOCDNDESCR_NANOCDN_TAG][t.NANOCDNDESCR_SESSIONS_TAG][t.NANOCDNDESCR_SESSIONS_NUMBER_PARAM]&&(i=parseInt(o[t.NANOCDNDESCR_NANOCDN_TAG][t.NANOCDNDESCR_SESSIONS_TAG][t.NANOCDNDESCR_SESSIONS_NUMBER_PARAM],10),isNaN(i)||(r.nbSessions=i)),void 0!==o[t.NANOCDNDESCR_NANOCDN_TAG][t.NANOCDNDESCR_SESSIONS_TAG][t.NANOCDNDESCR_SESSIONS_LIMIT_PARAM]&&(i=parseInt(o[t.NANOCDNDESCR_NANOCDN_TAG][t.NANOCDNDESCR_SESSIONS_TAG][t.NANOCDNDESCR_SESSIONS_LIMIT_PARAM],10),isNaN(i)||(r.maxNbSessions=i))),void 0!==o[t.NANOCDNDESCR_NANOCDN_TAG][t.NANOCDNDESCR_ACCESSTOKEN_TAG]){var s={};for(var a in o[t.NANOCDNDESCR_NANOCDN_TAG][t.NANOCDNDESCR_ACCESSTOKEN_TAG])s[a.substring(1)]=o[t.NANOCDNDESCR_NANOCDN_TAG][t.NANOCDNDESCR_ACCESSTOKEN_TAG][a];r.jsonAccountId=JSON.stringify(s)}r.processRatio()}return r}}],(n=[{key:"processRatio",value:function(){this.ratio=this.maxNbSessions/(this.nbSessions+1)}}])&&tr(e.prototype,n),r&&tr(e,r),t}();function nr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}er.NANOCDNDESCR_NANOCDN_TAG="nanocdn",er.NANOCDNDESCR_SESSIONS_TAG="sessions",er.NANOCDNDESCR_SESSIONS_NUMBER_PARAM="@number",er.NANOCDNDESCR_SESSIONS_LIMIT_PARAM="@limit",er.NANOCDNDESCR_MULTICAST_TAG="multicasts",er.NANOCDNDESCR_ACCESSTOKEN_TAG="access-token",er.NANOCDNDESCR_DEFAULT_MAX_SESSION=50;var rr=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.nanoCDNHostManager=void 0,this.nanoCDNHost=void 0,this.retry=void 0,this.retryDelay=void 0,this.active=void 0,this.waiting=void 0,this.job=void 0,this.nanoCDNHostManager=e,this.nanoCDNHost=n,this.retry=0,this.retryDelay=6e4,this.active=!0,this.waiting=!1,this.job=void 0}var e,n;return e=t,(n=[{key:"start",value:function(){var t=this;y.getInstance().printDebugLogs("BpkHostResolvingAsyncTask","Starting resolving nanoCDN with host: '"+this.nanoCDNHost+"'"),V.getInstance().requestNanoCDNStatus(this.nanoCDNHost).then((function(e){if(200===e.httpStatus){var n=er.parseNanoCDNStatusResponse(e.body,t.nanoCDNHost);if(void 0===n)throw new Error("Can't resolve nanoCDN:'"+t.nanoCDNHost+"' status:"+e.httpStatus);return y.getInstance().printDebugLogs("BpkHostResolvingAsyncTask","Checking nanoCDN result: host: "+n.hostIP+" session: "+n.nbSessions+" limit: "+n.maxNbSessions+" jsonid:"+n.jsonAccountId),n}throw new Error("Can't resolve nanoCDN:'"+t.nanoCDNHost+"' status:"+e.httpStatus)})).then((function(e){t.active&&(y.getInstance().printInfoLogs("BpkHostResolvingAsyncTask","Found nanoCDN with host: '"+t.nanoCDNHost+"'"),e.jsonAccountId.length>0&&y.getInstance().printInfoLogs("BpkHostResolvingAsyncTask","Found json account id: '"+e.jsonAccountId+"'"),t.nanoCDNHostManager.addNanoCDN(e),t.active=!1,t.nanoCDNHostManager.removeHostResolvingAsyncTask(t.nanoCDNHost))})).catch((function(e){t.active&&(t.nanoCDNHostManager.removeNanoCDN(t.nanoCDNHost),t.retry++,y.getInstance().printDebugLogs("BpkHostResolvingAsyncTask",e.message+" retry:"+t.retry),-1===t.retryDelay?(y.getInstance().printInfoLogs("BpkHostResolvingAsyncTask","Can't found nanoCDN with host: '"+t.nanoCDNHost+"'"),t.active=!1,t.nanoCDNHostManager.removeHostResolvingAsyncTask(t.nanoCDNHost)):(t.waiting=!0,t.job=N.getInstance().asyncDelay(t.retryDelay,(function(){t.waiting=!1,t.active&&t.start()}))))}))}},{key:"stop",value:function(){this.active&&y.getInstance().printDebugLogs("BpkHostResolvingAsyncTask","Host resolving stopped for '"+this.nanoCDNHost+"'"),this.active=!1,N.getInstance().cancel(this.job)}},{key:"setResolvingRetryDelay",value:function(t){this.retryDelay=t}}])&&nr(e.prototype,n),t}(),ir=function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.name=void 0,this.ipAddress=void 0,this.nanoCDNDescr=void 0,this.name=e,this.ipAddress=n,this.nanoCDNDescr=r};function or(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var sr=0;function ar(t){return"__private_"+sr+++"_"+t}function ur(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function cr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function lr(t,e,n){return e&&cr(t.prototype,e),n&&cr(t,n),t}var fr=function(){function t(){ur(this,t)}return lr(t,null,[{key:"start",value:function(t){}},{key:"stop",value:function(){}}]),t}(),hr=ar("instance"),dr=ar("mdnsHandler"),pr=ar("started"),vr=ar("services"),yr=function(){function t(){ur(this,t),Object.defineProperty(this,dr,{writable:!0,value:fr}),this.smartLib=void 0,Object.defineProperty(this,pr,{writable:!0,value:void 0}),Object.defineProperty(this,vr,{writable:!0,value:void 0}),or(this,pr)[pr]=!1,or(this,vr)[vr]=[]}return lr(t,null,[{key:"getInstance",value:function(){return or(t,hr)[hr]||(or(t,hr)[hr]=new t),or(t,hr)[hr]}}]),lr(t,[{key:"init",value:function(t){or(this,dr)[dr]=t}},{key:"release",value:function(){}},{key:"attachInstance",value:function(t){this.smartLib=t}},{key:"start",value:function(){or(this,dr)[dr]===fr?y.getInstance().printErrorLogs("BpkMdnsMgr","Exception: nanoCDN discovery is not available for that platform"):or(this,pr)[pr]?y.getInstance().printVerboseLogs("BpkMdnsMgr","mDNS discovery already started"):(y.getInstance().printInfoLogs("BpkMdnsMgr","mDNS discovery starting..."),or(this,dr)[dr].start(t.MDNS_NANOCDN_SERVICE_TYPE),or(this,pr)[pr]=!0)}},{key:"stop",value:function(){!0===or(this,pr)[pr]&&(or(this,pr)[pr]=!1,or(this,dr)[dr].stop(),y.getInstance().printInfoLogs("BpkMdnsMgr","mDNS discovery stopped"))}},{key:"onServiceFound",value:function(t,e){var n=this;y.getInstance().printDebugLogs("BpkMdnsMgr","Found service "+t+" ip:"+e),V.getInstance().requestNanoCDNStatus(e).then((function(t){if(200===t.httpStatus){var n=er.parseNanoCDNStatusResponse(t.body,e);if(void 0===n)throw new Error("Can't resolve nanoCDN:'"+e+"' status:"+t.httpStatus);return y.getInstance().printDebugLogs("BpkMdnsMgr","Checking nanoCDN result: host: "+n.hostIP+" session: "+n.nbSessions+" limit: "+n.maxNbSessions+" jsonid:"+n.jsonAccountId),n}throw new Error("Can't resolve nanoCDN:'"+e+"' status:"+t.httpStatus)})).then((function(r){y.getInstance().printInfoLogs("BpkMdnsMgr","Found nanoCDN with host: '"+e+"'"),r.jsonAccountId.length>0&&y.getInstance().printInfoLogs("BpkMdnsMgr","Found json account id: '"+r.jsonAccountId+"'"),n.smartLib.nanoCDNHostManager.addNanoCDN(r),void 0===n.getService(t,e)&&or(n,vr)[vr].push(new ir(t,e,r)),y.getInstance().printInfoLogs("BpkMdnsMgr","Registered nanoCDN with host: '"+e+"'")})).catch((function(t){y.getInstance().printInfoLogs("BpkMdnsMgr",t.message)}))}},{key:"onServiceLost",value:function(t,e){var n=this.getService(t,e);void 0===n&&this.removeService(n)}},{key:"getService",value:function(t,e){for(var n=0;n<or(this,vr)[vr].length;n++){var r=or(this,vr)[vr][n];if(r.name===t&&r.ipAddress===e)return r}}},{key:"removeService",value:function(t){y.getInstance().printDebugLogs("BpkMdnsMgr","Lost service "+t.name+" ip:"+t.ipAddress),this.smartLib.nanoCDNHostManager.removeNanoCDN(t.ipAddress);var e=or(this,vr)[vr].indexOf(t);-1!==e&&or(this,vr)[vr].splice(e,1)}}]),t}();function gr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Er(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Object.defineProperty(yr,hr,{writable:!0,value:void 0}),yr.MDNS_NANOCDN_SERVICE_TYPE="_nanocdn._tcp.local.";var Sr=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.smartLib=void 0,this.state=void 0,this.nanoCDNHostResolvingTasks=void 0,this.nanoCDNHostConfigured=void 0,this.currentNanoCDNHost=void 0,this.nanoCDNList=void 0,this.nanoCDNReceiver=void 0,this.nanoCDNResolvingRetryDelay=void 0,this.lastHostResolvingDate=void 0,this.state=t.STATE_NONE,this.nanoCDNHostResolvingTasks={},this.nanoCDNHostConfigured="",this.currentNanoCDNHost="",this.nanoCDNList=[],this.nanoCDNReceiver=void 0,this.nanoCDNResolvingRetryDelay=t.DEFAULT_NANOCDN_RESOLVING_RETRY_DELAY,this.lastHostResolvingDate=0}var e,n;return e=t,(n=[{key:"init",value:function(t,e){this.smartLib=t,null==e&&(e=""),-1!==e.indexOf("*")&&(e=e.replace("*","127.0.0.1,discover")),this.nanoCDNHostConfigured!==e&&(this.nanoCDNHostConfigured=e,this.clearHostResolution(),this.launchHostResolution())}},{key:"registerNanoCDNReceiver",value:function(t){this.nanoCDNReceiver=null==t?void 0:t}},{key:"setNanoCDNResolvingRetryDelay",value:function(t){var e=parseInt(t,10);for(var n in e>=0&&e<1e3?(this.nanoCDNResolvingRetryDelay=1e3,y.getInstance().printWarnLogs("BpkNanoCDNHostMgr","nanoCDN resolving retry delay has been increased to 1000ms (minimum delay)")):e<=-1?(this.nanoCDNResolvingRetryDelay=-1,y.getInstance().printDebugLogs("BpkNanoCDNHostMgr","nanoCDN resolving retry has been disabled")):this.nanoCDNResolvingRetryDelay=e,this.nanoCDNHostResolvingTasks)if(this.nanoCDNHostResolvingTasks[n].waiting){this.nanoCDNHostResolvingTasks[n].stop();var r=new rr(this,n);r.setResolvingRetryDelay(this.nanoCDNResolvingRetryDelay),r.start(),this.nanoCDNHostResolvingTasks[n]=r}else this.nanoCDNHostResolvingTasks[n].setResolvingRetryDelay(this.nanoCDNResolvingRetryDelay)}},{key:"launchHostResolution",value:function(){if(void 0!==this.nanoCDNHostConfigured&&0!==this.nanoCDNHostConfigured.length){this.state=t.STATE_IDLING;for(var e=this.nanoCDNHostConfigured.split(","),n=0;n<e.length;n++){var r=e[n];r===t.NANOCDN_HOST_DISCOVER?(this.state=t.STATE_DISCOVERING,this.lastHostResolvingDate=Date.now(),yr.getInstance().start()):M.getInstance().appInBackground||(this.state=t.STATE_RESOLVING,this.lastHostResolvingDate=Date.now(),this.resolveNanoCDNHost(r))}}}},{key:"refreshHostResolution",value:function(){var e=this;if(void 0!==this.nanoCDNHostConfigured&&0!==this.nanoCDNHostConfigured.length&&this.nanoCDNHostConfigured===t.NANOCDN_HOST_DISCOVER){var n=function(t){return function(t){if(Array.isArray(t))return gr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return gr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gr(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(this.nanoCDNList),r=[];this.state=t.STATE_DISCOVERING,this.lastHostResolvingDate=Date.now();for(var i=function(t){var i=n[t];r.push(V.getInstance().requestNanoCDNStatus(i.hostIP).then((function(t){200!==t.httpStatus&&e.removeNanoCDN(i.hostIP)})))},o=0;o<n.length;o++)i(o);Promise.all(r).then((function(){yr.getInstance().stop(),yr.getInstance().start()}))}}},{key:"clearHostResolution",value:function(){for(var e in this.state=t.STATE_IDLING,this.nanoCDNHostResolvingTasks)this.nanoCDNHostResolvingTasks[e].stop(),delete this.nanoCDNHostResolvingTasks[e];yr.getInstance().stop(),this.clearNanoCDNList(),this.lastHostResolvingDate=0}},{key:"resolveNanoCDNHost",value:function(t){if(y.getInstance().printInfoLogs("BpkNanoCDNHostMgr","Initializing nanoCDN resolving with '"+t+"'"),null!=t&&0!==t.length){void 0!==this.nanoCDNHostResolvingTasks[t]&&(this.nanoCDNHostResolvingTasks[t].stop(),delete this.nanoCDNHostResolvingTasks[t]);var e=new rr(this,t);e.setResolvingRetryDelay(this.nanoCDNResolvingRetryDelay),e.start(),this.nanoCDNHostResolvingTasks[t]=e}else y.getInstance().printInfoLogs("BpkNanoCDNHostMgr","nanoCDN host resolving is not required for '"+t+"'")}},{key:"removeHostResolvingAsyncTask",value:function(t){void 0!==this.nanoCDNHostResolvingTasks[t]&&(this.nanoCDNHostResolvingTasks[t].stop(),delete this.nanoCDNHostResolvingTasks[t])}},{key:"getCurrentNanoCDNHost",value:function(){return(void 0===this.currentNanoCDNHost||null===this.currentNanoCDNHost||0===this.currentNanoCDNHost.length)&&this.nanoCDNList.length>0?this.nanoCDNList[0].hostIP:this.currentNanoCDNHost}},{key:"setCurrentNanoCDNHost",value:function(t){this.currentNanoCDNHost=t}},{key:"addNanoCDN",value:function(t){for(var e=!1,n=0;n<this.nanoCDNList.length;n++)if(this.nanoCDNList[n].hostIP===t.hostIP){e=!0,this.nanoCDNList.splice(n,1);break}for(var r=!1,i=0,o=0===this.nanoCDNList.length,s=0;s<this.nanoCDNList.length&&!r;s++)t.ratio>this.nanoCDNList[s].ratio&&(r=!0,i=s);if(r?this.nanoCDNList.splice(i,0,t):this.nanoCDNList.push(t),o&&!e){var a=t.jsonAccountId;y.getInstance().printInfoLogs("BpkNanoCDNHostMgr","onNanoCDNFound '"+a+"'"+(void 0===this.nanoCDNReceiver?" (no receiver)":"")),void 0!==this.nanoCDNReceiver&&"function"==typeof this.nanoCDNReceiver.onNanoCDNFound&&this.nanoCDNReceiver.onNanoCDNFound(a)}}},{key:"removeNanoCDN",value:function(t){for(var e=!1,n=0;n<this.nanoCDNList.length&&!e;n++)if(this.nanoCDNList[n].hostIP===t){e=!0,this.nanoCDNList.splice(n,1);break}0===this.nanoCDNList.length&&e&&(y.getInstance().printInfoLogs("BpkNanoCDNHostMgr","onNanoCDNLost"+(void 0===this.nanoCDNReceiver?" (no receiver)":"")),void 0!==this.nanoCDNReceiver&&"function"==typeof this.nanoCDNReceiver.onNanoCDNLost&&this.nanoCDNReceiver.onNanoCDNLost()),this.getCurrentNanoCDNHost()===t&&(this.currentNanoCDNHost="")}},{key:"getNanoCDNHostList",value:function(){for(var t=[],e=0;e<this.nanoCDNList.length;e++)t.push(this.nanoCDNList[e].hostIP);return t}},{key:"getNanoCDNWithHost",value:function(t){for(var e=0;e<this.nanoCDNList.length;e++)if(this.nanoCDNList[e].hostIP===t)return this.nanoCDNList[e]}},{key:"clearNanoCDNList",value:function(){0!==this.nanoCDNList.length&&(this.nanoCDNList=[],this.currentNanoCDNHost="",y.getInstance().printInfoLogs("BpkNanoCDNHostMgr","onNanoCDNLost"+(void 0===this.nanoCDNReceiver?" (no receiver)":"")),void 0!==this.nanoCDNReceiver&&"function"==typeof this.nanoCDNReceiver.onNanoCDNLost&&this.nanoCDNReceiver.onNanoCDNLost())}},{key:"release",value:function(){this.clearHostResolution(),this.nanoCDNHostConfigured=""}},{key:"onForeground",value:function(){if(Date.now()-this.lastHostResolvingDate>1e3){var e=this.nanoCDNHostConfigured.split(",").length;0!==this.nanoCDNList.length&&this.nanoCDNList.length===e||this.nanoCDNHostConfigured===t.NANOCDN_HOST_DISCOVER||!0!==M.getInstance().networkAvailable?this.nanoCDNHostConfigured===t.NANOCDN_HOST_DISCOVER&&!0===M.getInstance().networkAvailable&&this.refreshHostResolution():(this.clearHostResolution(),this.launchHostResolution())}else y.getInstance().printDebugLogs("BpkNanoCDNHostMgr","Received event onForeground but ignored")}},{key:"onBackground",value:function(){Object.keys(this.nanoCDNHostResolvingTasks).length>0&&(y.getInstance().printDebugLogs("BpkNanoCDNHostMgr","Host resolving will be resumed when the app will be restored"),this.clearHostResolution()),this.lastHostResolvingDate=0}},{key:"onNetworkAvailable",value:function(t){Date.now()-this.lastHostResolvingDate>1e3?(y.getInstance().printDebugLogs("BpkNanoCDNHostMgr","Received event onNetworkAvailable. networkType:"+t),this.clearHostResolution(),this.launchHostResolution()):y.getInstance().printDebugLogs("BpkNanoCDNHostMgr","Received event onNetworkAvailable but ignored")}},{key:"onNetworkLost",value:function(){y.getInstance().printDebugLogs("BpkNanoCDNHostMgr","Received event onNetworkLost"),this.clearHostResolution()}}])&&Er(e.prototype,n),t}();function br(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function mr(t,e,n){return e&&br(t.prototype,e),n&&br(t,n),t}Sr.DEFAULT_NANOCDN_RESOLVING_RETRY_DELAY=6e4,Sr.NANOCDN_HOST_DISCOVER="discover",Sr.STATE_NONE=0,Sr.STATE_IDLING=1,Sr.STATE_DISCOVERING=2,Sr.STATE_RESOLVING=3;var kr=function(){function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.smartLib=void 0}return mr(t,null,[{key:"getInstance",value:function(){return Br.getInstance().adManager}}]),mr(t,[{key:"init",value:function(t){this.smartLib=t}},{key:"release",value:function(){}},{key:"setPalParameters",value:function(t,e,n,r,i,o,s,a,u,c,l){this.smartLib.internalAdManager.setPalParameters(t,e,n,r,i,o,s,a,u,c,l)}},{key:"setOMPartner",value:function(t,e){this.smartLib.internalAdManager.setOMPartner(t,e)}},{key:"setAdParameter",value:function(t,e){this.smartLib.internalAdManager.adSession.setAdParameter(t,e)}},{key:"setEventCallbackEnabled",value:function(t){this.smartLib.internalAdManager.eventCallbackEnabled=t,this.smartLib.internalAdManager.adSession.setEventCallbackEnabled(t)}},{key:"setAdEventsListener",value:function(t){this.smartLib.internalAdManager.adEventsListener=t,this.smartLib.internalAdManager.adSession.setAdEventsListener(t)}}]),t}();function Ar(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ir(t,e,n){return e&&Ar(t.prototype,e),n&&Ar(t,n),t}function Dr(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var Rr=0;function Tr(t){return"__private_"+Rr+++"_"+t}var _r="BpkSmartLib",Nr=Tr("instance"),Lr=Tr("initialized"),Or=Tr("parameters"),Pr=Tr("options"),wr=Tr("setAnalyticsAddress"),Cr=Tr("setNanoCDNHost"),Mr=Tr("setBroadpeakDomainNames"),Br=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Object.defineProperty(this,Lr,{writable:!0,value:void 0}),Object.defineProperty(this,Or,{writable:!0,value:void 0}),Object.defineProperty(this,Pr,{writable:!0,value:void 0}),this.sessionManager=void 0,this.nanoCDNHostManager=void 0,this.adManager=void 0,this.internalAdManager=void 0,this.session=void 0,Object.defineProperty(this,wr,{writable:!0,value:function(t){null!=t&&0!==t.length?t.endsWith("/")?Dr(e,Or)[Or].analyticsAddress=t:Dr(e,Or)[Or].analyticsAddress=t+"/":Dr(e,Or)[Or].analyticsAddress=""}}),Object.defineProperty(this,Cr,{writable:!0,value:function(t){null!=t&&0!==t.length?Dr(e,Or)[Or].nanoCDNHost=t:Dr(e,Or)[Or].nanoCDNHost=""}}),Object.defineProperty(this,Mr,{writable:!0,value:function(t){null!=t&&0!==t.length?Dr(e,Or)[Or].broadpeakDomainNames=t:Dr(e,Or)[Or].broadpeakDomainNames=""}}),Dr(this,Lr)[Lr]=!1,Dr(this,Or)[Or]={analyticsAddress:"",nanoCDNHost:"",broadpeakDomainNames:"",forceTeardown:t.FORCE_TEARDOWN_DEFAULT,uuid:"",userAgent:void 0,deviceType:"",customParameters:{}},Dr(this,Pr)[Pr]=new dn,this.sessionManager=new $n,this.nanoCDNHostManager=new Sr,this.adManager=new kr,this.internalAdManager=new me}return Ir(t,null,[{key:"getInstance",value:function(){return Dr(t,Nr)[Nr]||(Dr(t,Nr)[Nr]=new t),Dr(t,Nr)[Nr]}}]),Ir(t,[{key:"init",value:function(e,n,r,i){return y.getInstance().printInfoLogs(_r,"Init SmartLib..."),y.getInstance().printInfoLogs(_r,"Version: "+S),Dr(this,Lr)[Lr]?(y.getInstance().printErrorLogs(_r,"Error: SmartLib already initialized, please use SmartLib.release() before initializing."),!1):void 0!==i?(y.getInstance().printErrorLogs(_r,"Error: this init method has been removed, please use SmartLib.init(analyticsAddress, nanoCDNHost, broadpeakDomainNames) instead."),!1):it.typeOrNullParameter(e,"string","Error: analyticsAddress should be a string or null")&&it.typeOrNullParameter(n,"string","Error: nanoCDNHost should be a string or null")&&it.typeOrNullParameter(r,"string","Error: broadpeakDomainNames should be a string or null")?(Dr(this,wr)[wr](e),Dr(this,Cr)[Cr](n),Dr(this,Mr)[Mr](r),this.setForceTeardown(t.FORCE_TEARDOWN_DEFAULT),Dr(this,Pr)[Pr]=new dn,y.getInstance().printInfoLogs(_r,"Parameters:analyticsAddress="+e+", nanoCDNHost="+n+", broadpeakDomainNames="+r),this.sessionManager.init(this),this.nanoCDNHostManager.init(this,n),this.adManager.init(this),this.internalAdManager.init(this),V.getInstance().attachInstance(this),et.getInstance().attachInstance(this),yr.getInstance().attachInstance(this),Xe.getInstance().attachInstance(this),Sn.getInstance().attachInstance(this),M.getInstance().init(this),M.getInstance().addListener(this.nanoCDNHostManager),Dr(this,Lr)[Lr]=!0,!0):(y.getInstance().printErrorLogs(_r,"Error: initialization aborted"),!1)}},{key:"getURL",value:function(t,e){return void 0!==this.session&&(y.getInstance().printErrorLogs(_r,"Exception: A session is already running, please use SmartLib.stopStreamingSession(...) before. Stopping the current one..."),this.stopStreamingSession()),y.getInstance().printInfoLogs(_r,"getURL with "+t),void 0===e&&(e=function(){}),it.typeParameter(e,"function","Error: callback should be a function")?Dr(this,Lr)[Lr]?it.typeParameter(t,"string","Error: requestedURL should be a string")&&it.stringNonEmpty(t,"Error: requestedURL is empty")?(this.session=this.sessionManager.createSessionHandler(),this.session.options=dn.create(Dr(this,Pr)[Pr]),this.session.playerAdapter=et.getInstance().getPlayerAdapter(),this.session.adSession=this.internalAdManager.adSession,void 0!==this.internalAdManager.adSession&&(this.internalAdManager.adSession.session=this.session),this.internalAdManager.adSession=new Se,this.internalAdManager.adSession.setEventCallbackEnabled(this.internalAdManager.eventCallbackEnabled),this.internalAdManager.adSession.setAdEventsListener(this.internalAdManager.adEventsListener),this.session.start(t,e)):(e(""),Promise.resolve("")):(y.getInstance().printErrorLogs(_r,"Exception: Implementation error, SmartLib.init(...) should be called prior to SmartLib.getURL(...)"),e(""),Promise.resolve("")):Promise.resolve("")}},{key:"getQuery",value:function(){return void 0!==this.session&&(y.getInstance().printErrorLogs(_r,"Exception: A session is already running, please use SmartLib.stopStreamingSession(...) before. Stopping the current one..."),this.stopStreamingSession()),y.getInstance().printInfoLogs(_r,"getQuery"),Dr(this,Lr)[Lr]?(this.session=this.sessionManager.createProxySessionHandler(),this.session.options=dn.create(Dr(this,Pr)[Pr]),this.session.playerAdapter=et.getInstance().getPlayerAdapter(),this.session.getQuery()):(y.getInstance().printErrorLogs(_r,"Exception: Implementation error, SmartLib.init(...) should be called prior to SmartLib.getQuery(...)"),"")}},{key:"startStreamingSession",value:function(t,e){return y.getInstance().printInfoLogs(_r,"startStreamingSession with "+t+" and "+e),Dr(this,Lr)[Lr]?!(!it.typeParameter(t,"string","Error: contentURL should be a string")||!it.typeParameter(e,"string","Error: redirectedURL should be a string")||(void 0===this.session?(y.getInstance().printErrorLogs(_r,"Exception: Implementation error, SmartLib.getQuery() should be called prior to SmartLib.startStreamingSession(...)"),1):this.session instanceof Nn?(this.session.start(t,e),0):(y.getInstance().printErrorLogs(_r,"Exception: Implementation error, SmartLib.startStreamingSession(...) cannot be called with SmartLib.getURL(...)"),1))):(y.getInstance().printErrorLogs(_r,"Exception: Implementation error, SmartLib.init(...) should be called prior to SmartLib.startStreamingSession(...)"),!1)}},{key:"stopStreamingSession",value:function(t){void 0!==t?y.getInstance().printInfoLogs(_r,"Stopping streaming session with statusCode "+t+"..."):y.getInstance().printInfoLogs(_r,"Stopping streaming session...");var e=this.session;return void 0!==this.session?(this.session.stop(t),this.session=void 0):y.getInstance().printDebugLogs(_r,"Stopping streaming session aborted, no session started"),e}},{key:"createStreamingSession",value:function(t){if(Dr(this,Lr)[Lr]){var e=void 0===t;e&&(t=Dr(this,Pr)[Pr]);var n=this.sessionManager.createStreamingSession(Dr(this,Pr)[Pr],t);return e?y.getInstance().printInfoLogs(_r,"Creating streaming session...",n.id):(y.getInstance().printInfoLogs(_r,"Creating streaming session with options...",n.id),t.printUpdates(_r,"",n.id)),n}y.getInstance().printErrorLogs(_r,"Exception: Implementation error, SmartLib.init(...) should be called prior to SmartLib.createStreamingSession(...)")}},{key:"release",value:function(){Dr(this,Lr)[Lr]&&(y.getInstance().printInfoLogs(_r,"Releasing SmartLib..."),this.stopStreamingSession(),this.internalAdManager.release(),this.adManager.release(),this.nanoCDNHostManager.release(),this.sessionManager.release(),M.getInstance().release(),yr.getInstance().release(),et.getInstance().release(),V.getInstance().release(),Dr(this,Lr)[Lr]=!1)}},{key:"attachPlayer",value:function(t,e){void 0!==t?(et.getInstance().setPlayerAdapter(t),void 0!==this.session&&y.getInstance().printErrorLogs(_r,"Exception: You cannot attach a player when a session is running, this player will be used for the next session.")):y.getInstance().printWarnLogs(_r,"Try to attach a player, but it is not recognized")}},{key:"detachPlayer",value:function(){return void 0!==this.session?(y.getInstance().printErrorLogs(_r,"Exception: You cannot detach the player when a session is running"),!1):(et.getInstance().setPlayerAdapter(void 0),!0)}},{key:"getMetricsManager",value:function(){if(void 0!==this.session)return this.session.metricsManager}},{key:"getListener",value:function(){return et.getInstance().getPlayerAdapter()}},{key:"getVersion",value:function(){return S}},{key:"getParameters",value:function(){return Dr(this,Or)[Or]}},{key:"setUUID",value:function(t){it.typeParameter(t,"string","Error: uuid should be a string")&&(t.length>32?Dr(this,Or)[Or].uuid=t.substring(0,32):Dr(this,Or)[Or].uuid=t)}},{key:"setUserAgent",value:function(t){it.typeOrUndefinedParameter(t,"string","Error: userAgent should be a string")&&(Dr(this,Or)[Or].userAgent=t)}},{key:"setDeviceType",value:function(t){it.typeParameter(t,"string","Error: deviceType should be a string")&&(Dr(this,Or)[Or].deviceType=t)}},{key:"setCustomParameter",value:function(t,e){"string"==typeof t&&"string"==typeof e?Dr(this,Or)[Or].customParameters[t]=it.toBkAString(e):y.getInstance().printErrorLogs(_r,"Error: Only string values are accepted for custom parameters")}},{key:"resetCustomParameters",value:function(){Dr(this,Or)[Or].customParameters={}}},{key:"setForceTeardown",value:function(e){"number"==typeof e?Dr(this,Or)[Or].forceTeardown=e>=1?t.FORCE_TEARDOWN_ENABLED:e<=-1?t.FORCE_TEARDOWN_DISABLED:t.FORCE_TEARDOWN_DEFAULT:y.getInstance().printErrorLogs(_r,"Exception: parameter forceTeardown must be SmartLib.FORCE_TEARDOWN_DISABLED, SmartLib.FORCE_TEARDOWN_DEFAULT or SmartLib.FORCE_TEARDOWN_ENABLED")}},{key:"setNanoCDNResolvingRetryDelay",value:function(t){y.getInstance().printVerboseLogs(_r,"Updating nanoCDN resolving retry asyncDelay to "+t+"ms"),this.nanoCDNHostManager.setNanoCDNResolvingRetryDelay(t)}},{key:"registerNanoCDNReceiver",value:function(t){this.nanoCDNHostManager.registerNanoCDNReceiver(t)}},{key:"setOption",value:function(t,e){y.getInstance().printDebugLogs(_r,"Setting global option "+dn.optionToString(t)+" to "+dn.valueToString(t,e)),Dr(this,Pr)[Pr].set(t,e)}}]),t}();function xr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Object.defineProperty(Br,Nr,{writable:!0,value:void 0}),Br.FORCE_TEARDOWN_DISABLED=-1,Br.FORCE_TEARDOWN_DEFAULT=0,Br.FORCE_TEARDOWN_ENABLED=1,Br.BPSessionEndsNormally=200,Br.BPFormatNotSupportedError=3001,Br.BPDecodingError=3002,Br.BPNetworkingError=3003,Br.BPAccessRightError=3004,Br.BPUnspecifiedError=3005;var Ur=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.url=void 0,this.errorCode=void 0,this.url=e,this.errorCode=n}var e,n,r;return e=t,r=[{key:"success",value:function(e){return new t(e,t.RESULT_NO_ERROR)}},{key:"error",value:function(e){return new t("",e)}},{key:"getErrorMessage",value:function(e){switch(e){case t.RESULT_NO_ERROR:return"Result success. A streaming session has been created.";case t.RESULT_NO_STREAMING_URL_FOUND:return"Request error. No streaming URL has been found.";case t.RESULT_CDN_RESPONSE_UNREADABLE:return"Request error. The CDN response is unreadable.";case t.RESULT_REQUESTED_URL_NOT_FOUND_ON_CDN:return"Request error. Content not found on the CDN.";case t.RESULT_REQUESTED_URL_NOT_FOUND_ON_NANOCDN:return"Request error. Content not found on the nanoCDN.";case t.RESULT_REQUESTED_URL_CDN_ERROR:return"Request error. The CDN returned an unknown error.";case t.RESULT_API_PARAMETER_FORMAT_ERROR:return"Api error. A method parameter does not have the right format.";case t.RESULT_API_NOT_INITIALIZED:return"Api error. SmartLib init not called";case t.RESULT_SESSION_HAS_BEEN_STOPPED_DURING_REQUEST:return"Workflow error. The session has been stopped during request.";case t.RESULT_REQUEST_ALREADY_DONE:return"Workflow error. The request has already been done for that session."}return"No error message for the error code "+e}}],(n=[{key:"getURL",value:function(){return this.url}},{key:"isError",value:function(){return this.errorCode!==t.RESULT_NO_ERROR}},{key:"getErrorCode",value:function(){return this.errorCode}},{key:"getErrorMessage",value:function(){return t.getErrorMessage(this.errorCode)}}])&&xr(e.prototype,n),r&&xr(e,r),t}();Ur.RESULT_NO_ERROR=0,Ur.RESULT_NO_STREAMING_URL_FOUND=-100,Ur.RESULT_CDN_RESPONSE_UNREADABLE=-101,Ur.RESULT_REQUESTED_URL_NOT_FOUND_ON_CDN=-102,Ur.RESULT_REQUESTED_URL_NOT_FOUND_ON_NANOCDN=-103,Ur.RESULT_REQUESTED_URL_CDN_ERROR=-104,Ur.RESULT_API_PARAMETER_FORMAT_ERROR=-400,Ur.RESULT_API_NOT_INITIALIZED=-401,Ur.RESULT_SESSION_HAS_BEEN_STOPPED_DURING_REQUEST=-500,Ur.RESULT_REQUEST_ALREADY_DONE=-501},function(t,e,n){var r=n(2),i=n(27).f,o=n(24),s=n(29),a=n(89),u=n(119),c=n(69);t.exports=function(t,e){var n,l,f,h,d,p=t.target,v=t.global,y=t.stat;if(n=v?r:y?r[p]||a(p,{}):(r[p]||{}).prototype)for(l in e){if(h=e[l],f=t.noTargetGet?(d=i(n,l))&&d.value:n[l],!c(v?l:p+(y?".":"#")+l,t.forced)&&void 0!==f){if(typeof h==typeof f)continue;u(h,f)}(t.sham||f&&f.sham)&&o(h,"sham",!0),s(n,l,h,t)}}},function(t,e,n){(function(e){var n=function(t){return t&&t.Math==Math&&t};t.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof e&&e)||function(){return this}()||Function("return this")()}).call(this,n(117))},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){var r=n(97),i=n(29),o=n(166);r||i(Object.prototype,"toString",o,{unsafe:!0})},function(t,e,n){"use strict";var r,i=n(145),o=n(16),s=n(2),a=n(10),u=n(18),c=n(73),l=n(24),f=n(29),h=n(20).f,d=n(51),p=n(60),v=n(6),y=n(67),g=s.Int8Array,E=g&&g.prototype,S=s.Uint8ClampedArray,b=S&&S.prototype,m=g&&d(g),k=E&&d(E),A=Object.prototype,I=A.isPrototypeOf,D=v("toStringTag"),R=y("TYPED_ARRAY_TAG"),T=i&&!!p&&"Opera"!==c(s.opera),_=!1,N={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},L=function(t){return a(t)&&u(N,c(t))};for(r in N)s[r]||(T=!1);if((!T||"function"!=typeof m||m===Function.prototype)&&(m=function(){throw TypeError("Incorrect invocation")},T))for(r in N)s[r]&&p(s[r],m);if((!T||!k||k===A)&&(k=m.prototype,T))for(r in N)s[r]&&p(s[r].prototype,k);if(T&&d(b)!==k&&p(b,k),o&&!u(k,D))for(r in _=!0,h(k,D,{get:function(){return a(this)?this[R]:void 0}}),N)s[r]&&l(s[r],R,r);t.exports={NATIVE_ARRAY_BUFFER_VIEWS:T,TYPED_ARRAY_TAG:_&&R,aTypedArray:function(t){if(L(t))return t;throw TypeError("Target is not a typed array")},aTypedArrayConstructor:function(t){if(p){if(I.call(m,t))return t}else for(var e in N)if(u(N,r)){var n=s[e];if(n&&(t===n||I.call(n,t)))return t}throw TypeError("Target is not a typed array constructor")},exportTypedArrayMethod:function(t,e,n){if(o){if(n)for(var r in N){var i=s[r];i&&u(i.prototype,t)&&delete i.prototype[t]}k[t]&&!n||f(k,t,n?e:T&&E[t]||e)}},exportTypedArrayStaticMethod:function(t,e,n){var r,i;if(o){if(p){if(n)for(r in N)(i=s[r])&&u(i,t)&&delete i[t];if(m[t]&&!n)return;try{return f(m,t,n?e:T&&g[t]||e)}catch(t){}}for(r in N)!(i=s[r])||i[t]&&!n||f(i,t,e)}},isView:function(t){var e=c(t);return"DataView"===e||u(N,e)},isTypedArray:L,TypedArray:m,TypedArrayPrototype:k}},function(t,e,n){var r=n(2),i=n(92),o=n(18),s=n(67),a=n(95),u=n(123),c=i("wks"),l=r.Symbol,f=u?l:l&&l.withoutSetter||s;t.exports=function(t){return o(c,t)||(a&&o(l,t)?c[t]=l[t]:c[t]=f("Symbol."+t)),c[t]}},function(t,e,n){"use strict";var r=n(28),i=n(72),o=n(59),s=n(35),a=n(128),u=s.set,c=s.getterFor("Array Iterator");t.exports=a(Array,"Array",(function(t,e){u(this,{type:"Array Iterator",target:r(t),index:0,kind:e})}),(function(){var t=c(this),e=t.target,n=t.kind,r=t.index++;return!e||r>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:e[r],done:!1}:{value:[r,e[r]],done:!1}}),"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},function(t,e,n){var r=n(32),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},function(t,e,n){"use strict";var r=n(1),i=n(2),o=n(42),s=n(41),a=n(16),u=n(95),c=n(123),l=n(3),f=n(18),h=n(70),d=n(10),p=n(17),v=n(21),y=n(28),g=n(48),E=n(47),S=n(50),b=n(71),m=n(43),k=n(125),A=n(94),I=n(27),D=n(20),R=n(87),T=n(24),_=n(29),N=n(92),L=n(66),O=n(68),P=n(67),w=n(6),C=n(126),M=n(127),B=n(57),x=n(35),U=n(25).forEach,j=L("hidden"),F=w("toPrimitive"),G=x.set,H=x.getterFor("Symbol"),V=Object.prototype,Y=i.Symbol,W=o("JSON","stringify"),q=I.f,K=D.f,Q=k.f,z=R.f,J=N("symbols"),X=N("op-symbols"),$=N("string-to-symbol-registry"),Z=N("symbol-to-string-registry"),tt=N("wks"),et=i.QObject,nt=!et||!et.prototype||!et.prototype.findChild,rt=a&&l((function(){return 7!=S(K({},"a",{get:function(){return K(this,"a",{value:7}).a}})).a}))?function(t,e,n){var r=q(V,e);r&&delete V[e],K(t,e,n),r&&t!==V&&K(V,e,r)}:K,it=function(t,e){var n=J[t]=S(Y.prototype);return G(n,{type:"Symbol",tag:t,description:e}),a||(n.description=e),n},ot=c?function(t){return"symbol"==typeof t}:function(t){return Object(t)instanceof Y},st=function(t,e,n){t===V&&st(X,e,n),p(t);var r=g(e,!0);return p(n),f(J,r)?(n.enumerable?(f(t,j)&&t[j][r]&&(t[j][r]=!1),n=S(n,{enumerable:E(0,!1)})):(f(t,j)||K(t,j,E(1,{})),t[j][r]=!0),rt(t,r,n)):K(t,r,n)},at=function(t,e){p(t);var n=y(e),r=b(n).concat(ft(n));return U(r,(function(e){a&&!ut.call(n,e)||st(t,e,n[e])})),t},ut=function(t){var e=g(t,!0),n=z.call(this,e);return!(this===V&&f(J,e)&&!f(X,e))&&(!(n||!f(this,e)||!f(J,e)||f(this,j)&&this[j][e])||n)},ct=function(t,e){var n=y(t),r=g(e,!0);if(n!==V||!f(J,r)||f(X,r)){var i=q(n,r);return!i||!f(J,r)||f(n,j)&&n[j][r]||(i.enumerable=!0),i}},lt=function(t){var e=Q(y(t)),n=[];return U(e,(function(t){f(J,t)||f(O,t)||n.push(t)})),n},ft=function(t){var e=t===V,n=Q(e?X:y(t)),r=[];return U(n,(function(t){!f(J,t)||e&&!f(V,t)||r.push(J[t])})),r};u||(_((Y=function(){if(this instanceof Y)throw TypeError("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,e=P(t),n=function(t){this===V&&n.call(X,t),f(this,j)&&f(this[j],e)&&(this[j][e]=!1),rt(this,e,E(1,t))};return a&&nt&&rt(V,e,{configurable:!0,set:n}),it(e,t)}).prototype,"toString",(function(){return H(this).tag})),_(Y,"withoutSetter",(function(t){return it(P(t),t)})),R.f=ut,D.f=st,I.f=ct,m.f=k.f=lt,A.f=ft,C.f=function(t){return it(w(t),t)},a&&(K(Y.prototype,"description",{configurable:!0,get:function(){return H(this).description}}),s||_(V,"propertyIsEnumerable",ut,{unsafe:!0}))),r({global:!0,wrap:!0,forced:!u,sham:!u},{Symbol:Y}),U(b(tt),(function(t){M(t)})),r({target:"Symbol",stat:!0,forced:!u},{for:function(t){var e=String(t);if(f($,e))return $[e];var n=Y(e);return $[e]=n,Z[n]=e,n},keyFor:function(t){if(!ot(t))throw TypeError(t+" is not a symbol");if(f(Z,t))return Z[t]},useSetter:function(){nt=!0},useSimple:function(){nt=!1}}),r({target:"Object",stat:!0,forced:!u,sham:!a},{create:function(t,e){return void 0===e?S(t):at(S(t),e)},defineProperty:st,defineProperties:at,getOwnPropertyDescriptor:ct}),r({target:"Object",stat:!0,forced:!u},{getOwnPropertyNames:lt,getOwnPropertySymbols:ft}),r({target:"Object",stat:!0,forced:l((function(){A.f(1)}))},{getOwnPropertySymbols:function(t){return A.f(v(t))}}),W&&r({target:"JSON",stat:!0,forced:!u||l((function(){var t=Y();return"[null]"!=W([t])||"{}"!=W({a:t})||"{}"!=W(Object(t))}))},{stringify:function(t,e,n){for(var r,i=[t],o=1;arguments.length>o;)i.push(arguments[o++]);if(r=e,(d(e)||void 0!==t)&&!ot(t))return h(e)||(e=function(t,e){if("function"==typeof r&&(e=r.call(this,t,e)),!ot(e))return e}),i[1]=e,W.apply(null,i)}}),Y.prototype[F]||T(Y.prototype,F,Y.prototype.valueOf),B(Y,"Symbol"),O[j]=!0},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,n){"use strict";var r=n(1),i=n(16),o=n(2),s=n(18),a=n(10),u=n(20).f,c=n(119),l=o.Symbol;if(i&&"function"==typeof l&&(!("description"in l.prototype)||void 0!==l().description)){var f={},h=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),e=this instanceof h?new l(t):void 0===t?l():l(t);return""===t&&(f[e]=!0),e};c(h,l);var d=h.prototype=l.prototype;d.constructor=h;var p=d.toString,v="Symbol(test)"==String(l("test")),y=/^Symbol\((.*)\)[^)]+$/;u(d,"description",{configurable:!0,get:function(){var t=a(this)?this.valueOf():this,e=p.call(t);if(s(f,t))return"";var n=v?e.slice(7,-1):e.replace(y,"$1");return""===n?void 0:n}}),r({global:!0,forced:!0},{Symbol:h})}},function(t,e,n){n(127)("iterator")},function(t,e,n){"use strict";var r=n(132).charAt,i=n(35),o=n(128),s=i.set,a=i.getterFor("String Iterator");o(String,"String",(function(t){s(this,{type:"String Iterator",string:String(t),index:0})}),(function(){var t,e=a(this),n=e.string,i=e.index;return i>=n.length?{value:void 0,done:!0}:(t=r(n,i),e.index+=t.length,{value:t,done:!1})}))},function(t,e,n){var r=n(2),i=n(133),o=n(7),s=n(24),a=n(6),u=a("iterator"),c=a("toStringTag"),l=o.values;for(var f in i){var h=r[f],d=h&&h.prototype;if(d){if(d[u]!==l)try{s(d,u,l)}catch(t){d[u]=l}if(d[c]||s(d,c,f),i[f])for(var p in o)if(d[p]!==o[p])try{s(d,p,o[p])}catch(t){d[p]=o[p]}}}},function(t,e,n){"use strict";var r=n(29),i=n(17),o=n(3),s=n(108),a=RegExp.prototype,u=a.toString,c=o((function(){return"/a/b"!=u.call({source:"a",flags:"b"})})),l="toString"!=u.name;(c||l)&&r(RegExp.prototype,"toString",(function(){var t=i(this),e=String(t.source),n=t.flags;return"/"+e+"/"+String(void 0===n&&t instanceof RegExp&&!("flags"in a)?s.call(t):n)}),{unsafe:!0})},function(t,e,n){var r=n(3);t.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(t,e,n){var r=n(10);t.exports=function(t){if(!r(t))throw TypeError(String(t)+" is not an object");return t}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){"use strict";var r=n(1),i=n(56).indexOf,o=n(75),s=n(33),a=[].indexOf,u=!!a&&1/[1].indexOf(1,-0)<0,c=o("indexOf"),l=s("indexOf",{ACCESSORS:!0,1:0});r({target:"Array",proto:!0,forced:u||!c||!l},{indexOf:function(t){return u?a.apply(this,arguments)||0:i(this,t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,n){var r=n(16),i=n(118),o=n(17),s=n(48),a=Object.defineProperty;e.f=r?a:function(t,e,n){if(o(t),e=s(e,!0),o(n),i)try{return a(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){var r=n(31);t.exports=function(t){return Object(r(t))}},function(t,e,n){"use strict";var r=n(1),i=n(76);r({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(0);function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.playerAdapter=void 0,this.listener=void 0,this.pollPeriod=void 0,this.pollLastDate=void 0,this.pollPlayerInterval=void 0,this.lastPosition=void 0,this.expectedPosition=void 0,this.playerAdapter=e,this.listener=n,this.pollPeriod=t.POLLING_PERIOD,this.pollPlayerInterval=null,this.expectedPosition=0,this.pollLastDate=0}var e,n;return e=t,(n=[{key:"start",value:function(){var t=this;this.expectedPosition=this.playerAdapter.getPosition(),this.pollLastDate=Date.now(),null!==this.pollPlayerInterval&&clearInterval(this.pollPlayerInterval),this.pollPlayerInterval=setInterval((function(){t.pollPlayerPosition()}),this.pollPeriod)}},{key:"stop",value:function(){null!==this.pollPlayerInterval&&(clearInterval(this.pollPlayerInterval),this.pollPlayerInterval=null)}},{key:"forcePollPlayerPosition",value:function(){this.expectedPosition=this.expectedPosition-this.pollPeriod+(Date.now()-this.pollLastDate),this.pollPlayerPosition()}},{key:"pollPlayerPosition",value:function(){this.lastPosition=this.playerAdapter.getPosition();var t=this.expectedPosition+2*this.pollPeriod,e=this.expectedPosition-2*this.pollPeriod;(this.lastPosition<e||this.lastPosition>t)&&void 0!==this.listener&&"function"==typeof this.listener.handleSeek&&!0===this.listener.handleSeek(this.expectedPosition,this.lastPosition)&&r.h.getInstance().printDebugLogs("BpkPlayerStateManager","Player is seeking ("+r.c.formatTime(this.expectedPosition)+" to "+r.c.formatTime(this.lastPosition)+")"),this.expectedPosition=this.lastPosition+this.pollPeriod,this.pollLastDate=Date.now()}},{key:"getPositionBeforeSeek",value:function(){return this.lastPosition}}])&&i(e.prototype,n),t}();o.POLLING_PERIOD=500},function(t,e,n){var r=n(16),i=n(20),o=n(47);t.exports=r?function(t,e,n){return i.f(t,e,o(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var r=n(58),i=n(55),o=n(21),s=n(8),a=n(96),u=[].push,c=function(t){var e=1==t,n=2==t,c=3==t,l=4==t,f=6==t,h=5==t||f;return function(d,p,v,y){for(var g,E,S=o(d),b=i(S),m=r(p,v,3),k=s(b.length),A=0,I=y||a,D=e?I(d,k):n?I(d,0):void 0;k>A;A++)if((h||A in b)&&(E=m(g=b[A],A,S),t))if(e)D[A]=E;else if(E)switch(t){case 3:return!0;case 5:return g;case 6:return A;case 2:u.call(D,g)}else if(l)return!1;return f?-1:c||l?l:D}};t.exports={forEach:c(0),map:c(1),filter:c(2),some:c(3),every:c(4),find:c(5),findIndex:c(6)}},function(t,e,n){var r=n(1),i=n(42),o=n(44),s=n(17),a=n(10),u=n(50),c=n(207),l=n(3),f=i("Reflect","construct"),h=l((function(){function t(){}return!(f((function(){}),[],t)instanceof t)})),d=!l((function(){f((function(){}))})),p=h||d;r({target:"Reflect",stat:!0,forced:p,sham:p},{construct:function(t,e){o(t),s(e);var n=arguments.length<3?t:o(arguments[2]);if(d&&!h)return f(t,e,n);if(t==n){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var r=[null];return r.push.apply(r,e),new(c.apply(t,r))}var i=n.prototype,l=u(a(i)?i:Object.prototype),p=Function.apply.call(t,l,e);return a(p)?p:l}})},function(t,e,n){var r=n(16),i=n(87),o=n(47),s=n(28),a=n(48),u=n(18),c=n(118),l=Object.getOwnPropertyDescriptor;e.f=r?l:function(t,e){if(t=s(t),e=a(e,!0),c)try{return l(t,e)}catch(t){}if(u(t,e))return o(!i.f.call(t,e),t[e])}},function(t,e,n){var r=n(55),i=n(31);t.exports=function(t){return r(i(t))}},function(t,e,n){var r=n(2),i=n(24),o=n(18),s=n(89),a=n(90),u=n(35),c=u.get,l=u.enforce,f=String(String).split("String");(t.exports=function(t,e,n,a){var u,c=!!a&&!!a.unsafe,h=!!a&&!!a.enumerable,d=!!a&&!!a.noTargetGet;"function"==typeof n&&("string"!=typeof e||o(n,"name")||i(n,"name",e),(u=l(n)).source||(u.source=f.join("string"==typeof e?e:""))),t!==r?(c?!d&&t[e]&&(h=!0):delete t[e],h?t[e]=n:i(t,e,n)):h?t[e]=n:s(e,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&c(this).source||a(this)}))},function(t,e,n){var r=n(1),i=n(3),o=n(21),s=n(51),a=n(130);r({target:"Object",stat:!0,forced:i((function(){s(1)})),sham:!a},{getPrototypeOf:function(t){return s(o(t))}})},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t}},function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},function(t,e,n){var r=n(16),i=n(3),o=n(18),s=Object.defineProperty,a={},u=function(t){throw t};t.exports=function(t,e){if(o(a,t))return a[t];e||(e={});var n=[][t],c=!!o(e,"ACCESSORS")&&e.ACCESSORS,l=o(e,0)?e[0]:u,f=o(e,1)?e[1]:void 0;return a[t]=!!n&&!i((function(){if(c&&!r)return!0;var t={length:-1};c?s(t,1,{enumerable:!0,get:u}):t[1]=1,n.call(t,l,f)}))}},function(t,e,n){"use strict";var r=n(109),i=n(106),o=n(17),s=n(31),a=n(52),u=n(110),c=n(8),l=n(111),f=n(76),h=n(3),d=[].push,p=Math.min,v=!h((function(){return!RegExp(4294967295,"y")}));r("split",2,(function(t,e,n){var r;return r="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,n){var r=String(s(this)),o=void 0===n?4294967295:n>>>0;if(0===o)return[];if(void 0===t)return[r];if(!i(t))return e.call(r,t,o);for(var a,u,c,l=[],h=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),p=0,v=new RegExp(t.source,h+"g");(a=f.call(v,r))&&!((u=v.lastIndex)>p&&(l.push(r.slice(p,a.index)),a.length>1&&a.index<r.length&&d.apply(l,a.slice(1)),c=a[0].length,p=u,l.length>=o));)v.lastIndex===a.index&&v.lastIndex++;return p===r.length?!c&&v.test("")||l.push(""):l.push(r.slice(p)),l.length>o?l.slice(0,o):l}:"0".split(void 0,0).length?function(t,n){return void 0===t&&0===n?[]:e.call(this,t,n)}:e,[function(e,n){var i=s(this),o=null==e?void 0:e[t];return void 0!==o?o.call(e,i,n):r.call(String(i),e,n)},function(t,i){var s=n(r,t,this,i,r!==e);if(s.done)return s.value;var f=o(t),h=String(this),d=a(f,RegExp),y=f.unicode,g=(f.ignoreCase?"i":"")+(f.multiline?"m":"")+(f.unicode?"u":"")+(v?"y":"g"),E=new d(v?f:"^(?:"+f.source+")",g),S=void 0===i?4294967295:i>>>0;if(0===S)return[];if(0===h.length)return null===l(E,h)?[h]:[];for(var b=0,m=0,k=[];m<h.length;){E.lastIndex=v?m:0;var A,I=l(E,v?h:h.slice(m));if(null===I||(A=p(c(E.lastIndex+(v?0:m)),h.length))===b)m=u(h,m,y);else{if(k.push(h.slice(b,m)),k.length===S)return k;for(var D=1;D<=I.length-1;D++)if(k.push(I[D]),k.length===S)return k;m=b=A}}return k.push(h.slice(b)),k}]}),!v)},function(t,e,n){var r,i,o,s=n(161),a=n(2),u=n(10),c=n(24),l=n(18),f=n(91),h=n(66),d=n(68),p=a.WeakMap;if(s){var v=f.state||(f.state=new p),y=v.get,g=v.has,E=v.set;r=function(t,e){return e.facade=t,E.call(v,t,e),e},i=function(t){return y.call(v,t)||{}},o=function(t){return g.call(v,t)}}else{var S=h("state");d[S]=!0,r=function(t,e){return e.facade=t,c(t,S,e),e},i=function(t){return l(t,S)?t[S]:{}},o=function(t){return l(t,S)}}t.exports={set:r,get:i,has:o,enforce:function(t){return o(t)?i(t):r(t,{})},getterFor:function(t){return function(e){var n;if(!u(e)||(n=i(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return n}}}},function(t,e,n){"use strict";var r=n(1),i=n(142);r({target:"Array",proto:!0,forced:[].forEach!=i},{forEach:i})},function(t,e,n){"use strict";var r=n(1),i=n(49),o=n(32),s=n(8),a=n(21),u=n(96),c=n(63),l=n(64),f=n(33),h=l("splice"),d=f("splice",{ACCESSORS:!0,0:0,1:2}),p=Math.max,v=Math.min;r({target:"Array",proto:!0,forced:!h||!d},{splice:function(t,e){var n,r,l,f,h,d,y=a(this),g=s(y.length),E=i(t,g),S=arguments.length;if(0===S?n=r=0:1===S?(n=0,r=g-E):(n=S-2,r=v(p(o(e),0),g-E)),g+n-r>9007199254740991)throw TypeError("Maximum allowed length exceeded");for(l=u(y,r),f=0;f<r;f++)(h=E+f)in y&&c(l,f,y[h]);if(l.length=r,n<r){for(f=E;f<g-r;f++)d=f+n,(h=f+r)in y?y[d]=y[h]:delete y[d];for(f=g;f>g-r+n;f--)delete y[f-1]}else if(n>r)for(f=g-r;f>E;f--)d=f+n-1,(h=f+r-1)in y?y[d]=y[h]:delete y[d];for(f=0;f<n;f++)y[f+E]=arguments[f+2];return y.length=g-r+n,l}})},function(t,e,n){var r=n(2),i=n(133),o=n(142),s=n(24);for(var a in i){var u=r[a],c=u&&u.prototype;if(c&&c.forEach!==o)try{s(c,"forEach",o)}catch(t){c.forEach=o}}},function(t,e,n){"use strict";var r=n(1),i=n(3),o=n(70),s=n(10),a=n(21),u=n(8),c=n(63),l=n(96),f=n(64),h=n(6),d=n(104),p=h("isConcatSpreadable"),v=d>=51||!i((function(){var t=[];return t[p]=!1,t.concat()[0]!==t})),y=f("concat"),g=function(t){if(!s(t))return!1;var e=t[p];return void 0!==e?!!e:o(t)};r({target:"Array",proto:!0,forced:!v||!y},{concat:function(t){var e,n,r,i,o,s=a(this),f=l(s,0),h=0;for(e=-1,r=arguments.length;e<r;e++)if(g(o=-1===e?s:arguments[e])){if(h+(i=u(o.length))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(n=0;n<i;n++,h++)n in o&&c(f,h,o[n])}else{if(h>=9007199254740991)throw TypeError("Maximum allowed index exceeded");c(f,h++,o)}return f.length=h,f}})},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e){t.exports=!1},function(t,e,n){var r=n(121),i=n(2),o=function(t){return"function"==typeof t?t:void 0};t.exports=function(t,e){return arguments.length<2?o(r[t])||o(i[t]):r[t]&&r[t][e]||i[t]&&i[t][e]}},function(t,e,n){var r=n(122),i=n(93).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,i)}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t}},function(t,e,n){"use strict";var r=n(109),i=n(17),o=n(21),s=n(8),a=n(32),u=n(31),c=n(110),l=n(111),f=Math.max,h=Math.min,d=Math.floor,p=/\$([$&'`]|\d\d?|<[^>]*>)/g,v=/\$([$&'`]|\d\d?)/g;r("replace",2,(function(t,e,n,r){var y=r.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,g=r.REPLACE_KEEPS_$0,E=y?"$":"$0";return[function(n,r){var i=u(this),o=null==n?void 0:n[t];return void 0!==o?o.call(n,i,r):e.call(String(i),n,r)},function(t,r){if(!y&&g||"string"==typeof r&&-1===r.indexOf(E)){var o=n(e,t,this,r);if(o.done)return o.value}var u=i(t),d=String(this),p="function"==typeof r;p||(r=String(r));var v=u.global;if(v){var b=u.unicode;u.lastIndex=0}for(var m=[];;){var k=l(u,d);if(null===k)break;if(m.push(k),!v)break;""===String(k[0])&&(u.lastIndex=c(d,s(u.lastIndex),b))}for(var A,I="",D=0,R=0;R<m.length;R++){k=m[R];for(var T=String(k[0]),_=f(h(a(k.index),d.length),0),N=[],L=1;L<k.length;L++)N.push(void 0===(A=k[L])?A:String(A));var O=k.groups;if(p){var P=[T].concat(N,_,d);void 0!==O&&P.push(O);var w=String(r.apply(void 0,P))}else w=S(T,d,_,N,O,r);_>=D&&(I+=d.slice(D,_)+w,D=_+T.length)}return I+d.slice(D)}];function S(t,n,r,i,s,a){var u=r+t.length,c=i.length,l=v;return void 0!==s&&(s=o(s),l=p),e.call(a,l,(function(e,o){var a;switch(o.charAt(0)){case"$":return"$";case"&":return t;case"`":return n.slice(0,r);case"'":return n.slice(u);case"<":a=s[o.slice(1,-1)];break;default:var l=+o;if(0===l)return e;if(l>c){var f=d(l/10);return 0===f?e:f<=c?void 0===i[f-1]?o.charAt(1):i[f-1]+o.charAt(1):e}a=i[l-1]}return void 0===a?"":a}))}}))},function(t,e,n){var r=n(1),i=n(3),o=n(28),s=n(27).f,a=n(16),u=i((function(){s(1)}));r({target:"Object",stat:!0,forced:!a||u,sham:!a},{getOwnPropertyDescriptor:function(t,e){return s(o(t),e)}})},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){var r=n(10);t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){var r=n(32),i=Math.max,o=Math.min;t.exports=function(t,e){var n=r(t);return n<0?i(n+e,0):o(n,e)}},function(t,e,n){var r,i=n(17),o=n(162),s=n(93),a=n(68),u=n(124),c=n(88),l=n(66)("IE_PROTO"),f=function(){},h=function(t){return"<script>"+t+"<\/script>"},d=function(){try{r=document.domain&&new ActiveXObject("htmlfile")}catch(t){}var t,e;d=r?function(t){t.write(h("")),t.close();var e=t.parentWindow.Object;return t=null,e}(r):((e=c("iframe")).style.display="none",u.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(h("document.F=Object")),t.close(),t.F);for(var n=s.length;n--;)delete d.prototype[s[n]];return d()};a[l]=!0,t.exports=Object.create||function(t,e){var n;return null!==t?(f.prototype=i(t),n=new f,f.prototype=null,n[l]=t):n=d(),void 0===e?n:o(n,e)}},function(t,e,n){var r=n(18),i=n(21),o=n(66),s=n(130),a=o("IE_PROTO"),u=Object.prototype;t.exports=s?Object.getPrototypeOf:function(t){return t=i(t),r(t,a)?t[a]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,e,n){var r=n(17),i=n(44),o=n(6)("species");t.exports=function(t,e){var n,s=r(t).constructor;return void 0===s||null==(n=r(s)[o])?e:i(n)}},function(t,e,n){var r=n(1),i=n(21),o=n(71);r({target:"Object",stat:!0,forced:n(3)((function(){o(1)}))},{keys:function(t){return o(i(t))}})},function(t,e,n){var r=n(1),i=n(10),o=n(17),s=n(18),a=n(27),u=n(51);r({target:"Reflect",stat:!0},{get:function t(e,n){var r,c,l=arguments.length<3?e:arguments[2];return o(e)===l?e[n]:(r=a.f(e,n))?s(r,"value")?r.value:void 0===r.get?void 0:r.get.call(l):i(c=u(e))?t(c,n,l):void 0}})},function(t,e,n){var r=n(3),i=n(40),o="".split;t.exports=r((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==i(t)?o.call(t,""):Object(t)}:Object},function(t,e,n){var r=n(28),i=n(8),o=n(49),s=function(t){return function(e,n,s){var a,u=r(e),c=i(u.length),l=o(s,c);if(t&&n!=n){for(;c>l;)if((a=u[l++])!=a)return!0}else for(;c>l;l++)if((t||l in u)&&u[l]===n)return t||l||0;return!t&&-1}};t.exports={includes:s(!0),indexOf:s(!1)}},function(t,e,n){var r=n(20).f,i=n(18),o=n(6)("toStringTag");t.exports=function(t,e,n){t&&!i(t=n?t:t.prototype,o)&&r(t,o,{configurable:!0,value:e})}},function(t,e,n){var r=n(44);t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 0:return function(){return t.call(e)};case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}}},function(t,e){t.exports={}},function(t,e,n){var r=n(17),i=n(164);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),e=n instanceof Array}catch(t){}return function(n,o){return r(n),i(o),e?t.call(n,o):n.__proto__=o,n}}():void 0)},function(t,e,n){"use strict";var r,i,o,s,a=n(1),u=n(41),c=n(2),l=n(42),f=n(167),h=n(29),d=n(134),p=n(57),v=n(98),y=n(10),g=n(44),E=n(99),S=n(90),b=n(168),m=n(102),k=n(52),A=n(136).set,I=n(169),D=n(170),R=n(171),T=n(139),_=n(172),N=n(35),L=n(69),O=n(6),P=n(103),w=n(104),C=O("species"),M="Promise",B=N.get,x=N.set,U=N.getterFor(M),j=f,F=c.TypeError,G=c.document,H=c.process,V=l("fetch"),Y=T.f,W=Y,q=!!(G&&G.createEvent&&c.dispatchEvent),K="function"==typeof PromiseRejectionEvent,Q=L(M,(function(){if(S(j)===String(j)){if(66===w)return!0;if(!P&&!K)return!0}if(u&&!j.prototype.finally)return!0;if(w>=51&&/native code/.test(j))return!1;var t=j.resolve(1),e=function(t){t((function(){}),(function(){}))};return(t.constructor={})[C]=e,!(t.then((function(){}))instanceof e)})),z=Q||!m((function(t){j.all(t).catch((function(){}))})),J=function(t){var e;return!(!y(t)||"function"!=typeof(e=t.then))&&e},X=function(t,e){if(!t.notified){t.notified=!0;var n=t.reactions;I((function(){for(var r=t.value,i=1==t.state,o=0;n.length>o;){var s,a,u,c=n[o++],l=i?c.ok:c.fail,f=c.resolve,h=c.reject,d=c.domain;try{l?(i||(2===t.rejection&&et(t),t.rejection=1),!0===l?s=r:(d&&d.enter(),s=l(r),d&&(d.exit(),u=!0)),s===c.promise?h(F("Promise-chain cycle")):(a=J(s))?a.call(s,f,h):f(s)):h(r)}catch(t){d&&!u&&d.exit(),h(t)}}t.reactions=[],t.notified=!1,e&&!t.rejection&&Z(t)}))}},$=function(t,e,n){var r,i;q?((r=G.createEvent("Event")).promise=e,r.reason=n,r.initEvent(t,!1,!0),c.dispatchEvent(r)):r={promise:e,reason:n},!K&&(i=c["on"+t])?i(r):"unhandledrejection"===t&&R("Unhandled promise rejection",n)},Z=function(t){A.call(c,(function(){var e,n=t.facade,r=t.value;if(tt(t)&&(e=_((function(){P?H.emit("unhandledRejection",r,n):$("unhandledrejection",n,r)})),t.rejection=P||tt(t)?2:1,e.error))throw e.value}))},tt=function(t){return 1!==t.rejection&&!t.parent},et=function(t){A.call(c,(function(){var e=t.facade;P?H.emit("rejectionHandled",e):$("rejectionhandled",e,t.value)}))},nt=function(t,e,n){return function(r){t(e,r,n)}},rt=function(t,e,n){t.done||(t.done=!0,n&&(t=n),t.value=e,t.state=2,X(t,!0))},it=function(t,e,n){if(!t.done){t.done=!0,n&&(t=n);try{if(t.facade===e)throw F("Promise can't be resolved itself");var r=J(e);r?I((function(){var n={done:!1};try{r.call(e,nt(it,n,t),nt(rt,n,t))}catch(e){rt(n,e,t)}})):(t.value=e,t.state=1,X(t,!1))}catch(e){rt({done:!1},e,t)}}};Q&&(j=function(t){E(this,j,M),g(t),r.call(this);var e=B(this);try{t(nt(it,e),nt(rt,e))}catch(t){rt(e,t)}},(r=function(t){x(this,{type:M,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=d(j.prototype,{then:function(t,e){var n=U(this),r=Y(k(this,j));return r.ok="function"!=typeof t||t,r.fail="function"==typeof e&&e,r.domain=P?H.domain:void 0,n.parent=!0,n.reactions.push(r),0!=n.state&&X(n,!1),r.promise},catch:function(t){return this.then(void 0,t)}}),i=function(){var t=new r,e=B(t);this.promise=t,this.resolve=nt(it,e),this.reject=nt(rt,e)},T.f=Y=function(t){return t===j||t===o?new i(t):W(t)},u||"function"!=typeof f||(s=f.prototype.then,h(f.prototype,"then",(function(t,e){var n=this;return new j((function(t,e){s.call(n,t,e)})).then(t,e)}),{unsafe:!0}),"function"==typeof V&&a({global:!0,enumerable:!0,forced:!0},{fetch:function(t){return D(j,V.apply(c,arguments))}}))),a({global:!0,wrap:!0,forced:Q},{Promise:j}),p(j,M,!1,!0),v(M),o=l(M),a({target:M,stat:!0,forced:Q},{reject:function(t){var e=Y(this);return e.reject.call(void 0,t),e.promise}}),a({target:M,stat:!0,forced:u||Q},{resolve:function(t){return D(u&&this===o?j:this,t)}}),a({target:M,stat:!0,forced:z},{all:function(t){var e=this,n=Y(e),r=n.resolve,i=n.reject,o=_((function(){var n=g(e.resolve),o=[],s=0,a=1;b(t,(function(t){var u=s++,c=!1;o.push(void 0),a++,n.call(e,t).then((function(t){c||(c=!0,o[u]=t,--a||r(o))}),i)})),--a||r(o)}));return o.error&&i(o.value),n.promise},race:function(t){var e=this,n=Y(e),r=n.reject,i=_((function(){var i=g(e.resolve);b(t,(function(t){i.call(e,t).then(n.resolve,r)}))}));return i.error&&r(i.value),n.promise}})},function(t,e,n){"use strict";var r=n(1),i=n(10),o=n(70),s=n(49),a=n(8),u=n(28),c=n(63),l=n(6),f=n(64),h=n(33),d=f("slice"),p=h("slice",{ACCESSORS:!0,0:0,1:2}),v=l("species"),y=[].slice,g=Math.max;r({target:"Array",proto:!0,forced:!d||!p},{slice:function(t,e){var n,r,l,f=u(this),h=a(f.length),d=s(t,h),p=s(void 0===e?h:e,h);if(o(f)&&("function"!=typeof(n=f.constructor)||n!==Array&&!o(n.prototype)?i(n)&&null===(n=n[v])&&(n=void 0):n=void 0,n===Array||void 0===n))return y.call(f,d,p);for(r=new(void 0===n?Array:n)(g(p-d,0)),l=0;d<p;d++,l++)d in f&&c(r,l,f[d]);return r.length=l,r}})},function(t,e,n){"use strict";var r=n(48),i=n(20),o=n(47);t.exports=function(t,e,n){var s=r(e);s in t?i.f(t,s,o(0,n)):t[s]=n}},function(t,e,n){var r=n(3),i=n(6),o=n(104),s=i("species");t.exports=function(t){return o>=51||!r((function(){var e=[];return(e.constructor={})[s]=function(){return{foo:1}},1!==e[t](Boolean).foo}))}},function(t,e,n){var r=n(16),i=n(20).f,o=Function.prototype,s=o.toString,a=/^\s*function ([^ (]*)/;r&&!("name"in o)&&i(o,"name",{configurable:!0,get:function(){try{return s.call(this).match(a)[1]}catch(t){return""}}})},function(t,e,n){var r=n(92),i=n(67),o=r("keys");t.exports=function(t){return o[t]||(o[t]=i(t))}},function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++n+r).toString(36)}},function(t,e){t.exports={}},function(t,e,n){var r=n(3),i=/#|\.prototype\./,o=function(t,e){var n=a[s(t)];return n==c||n!=u&&("function"==typeof e?r(e):!!e)},s=o.normalize=function(t){return String(t).replace(i,".").toLowerCase()},a=o.data={},u=o.NATIVE="N",c=o.POLYFILL="P";t.exports=o},function(t,e,n){var r=n(40);t.exports=Array.isArray||function(t){return"Array"==r(t)}},function(t,e,n){var r=n(122),i=n(93);t.exports=Object.keys||function(t){return r(t,i)}},function(t,e,n){var r=n(6),i=n(50),o=n(20),s=r("unscopables"),a=Array.prototype;null==a[s]&&o.f(a,s,{configurable:!0,value:i(null)}),t.exports=function(t){a[s][t]=!0}},function(t,e,n){var r=n(97),i=n(40),o=n(6)("toStringTag"),s="Arguments"==i(function(){return arguments}());t.exports=r?i:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),o))?n:s?i(e):"Object"==(r=i(e))&&"function"==typeof e.callee?"Arguments":r}},function(t,e,n){"use strict";var r=n(1),i=n(55),o=n(28),s=n(75),a=[].join,u=i!=Object,c=s("join",",");r({target:"Array",proto:!0,forced:u||!c},{join:function(t){return a.call(o(this),void 0===t?",":t)}})},function(t,e,n){"use strict";var r=n(3);t.exports=function(t,e){var n=[][t];return!!n&&r((function(){n.call(null,e||function(){throw 1},1)}))}},function(t,e,n){"use strict";var r,i,o=n(108),s=n(141),a=RegExp.prototype.exec,u=String.prototype.replace,c=a,l=(r=/a/,i=/b*/g,a.call(r,"a"),a.call(i,"a"),0!==r.lastIndex||0!==i.lastIndex),f=s.UNSUPPORTED_Y||s.BROKEN_CARET,h=void 0!==/()??/.exec("")[1];(l||h||f)&&(c=function(t){var e,n,r,i,s=this,c=f&&s.sticky,d=o.call(s),p=s.source,v=0,y=t;return c&&(-1===(d=d.replace("y","")).indexOf("g")&&(d+="g"),y=String(t).slice(s.lastIndex),s.lastIndex>0&&(!s.multiline||s.multiline&&"\n"!==t[s.lastIndex-1])&&(p="(?: "+p+")",y=" "+y,v++),n=new RegExp("^(?:"+p+")",d)),h&&(n=new RegExp("^"+p+"$(?!\\s)",d)),l&&(e=s.lastIndex),r=a.call(c?n:s,y),c?r?(r.input=r.input.slice(v),r[0]=r[0].slice(v),r.index=s.lastIndex,s.lastIndex+=r[0].length):s.lastIndex=0:l&&r&&(s.lastIndex=s.global?r.index+r[0].length:e),h&&r&&r.length>1&&u.call(r[0],n,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)})),r}),t.exports=c},function(t,e,n){"use strict";var r=n(1),i=n(56).includes,o=n(72);r({target:"Array",proto:!0,forced:!n(33)("indexOf",{ACCESSORS:!0,1:0})},{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),o("includes")},function(t,e,n){"use strict";var r=n(1),i=n(105),o=n(31);r({target:"String",proto:!0,forced:!n(107)("includes")},{includes:function(t){return!!~String(o(this)).indexOf(i(t),arguments.length>1?arguments[1]:void 0)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return b})),n(9),n(11),n(12),n(39),n(19),n(7),n(46),n(30),n(4),n(26),n(54),n(15),n(13),n(14);var r=n(0),i=n(23);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=d(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d(t);if(e){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f(this,n)}}function f(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?h(t):e}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var v=0;function y(t){return"__private_"+v+++"_"+t}var g="BpkShakaPlayerAdapter",E=y("player"),S=y("listener"),b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(v,t);var e,n,o,f=l(v);function v(){var t;s(this,v);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t=f.call.apply(f,[this].concat(n)),Object.defineProperty(h(t),E,{writable:!0,value:void 0}),Object.defineProperty(h(t),S,{writable:!0,value:void 0}),t.started=void 0,t.bitrate=void 0,t.playingEventReceived=void 0,t.playerStateManager=void 0,t.playerListeners=void 0,t}return e=v,o=[{key:"attachLibrary",value:function(t){void 0!==t.util&&void 0!==t.Player?(r.h.getInstance().printDebugLogs(g,"Shaka Player library attached"),v.library=t):r.h.getInstance().printErrorLogs(g,"Try to attach a library, but it is not recognized")}},{key:"checkPlayer",value:function(t,e){if("undefined"!=typeof window&&void 0!==window.shaka&&(v.library=window.shaka),"function"==typeof t.getConfiguration){var n=t.getConfiguration();if(void 0!==n.manifest&&void 0!==n.streaming)return!0}return!1}}],(n=[{key:"onPlayEvent",value:function(){this.started&&this.notifyResume()}},{key:"onPlayingEvent",value:function(){this.playingEventReceived=!0,this.started||(p(this,E)[E].isBuffering()?r.h.getInstance().printDebugLogs(g,"Player is still buffering, first image event not yet triggered"):(this.started=!0,this.playerStateManager.start(),this.notifyFirstImage()))}},{key:"onPauseEvent",value:function(){this.notifyPause()}},{key:"onBuffering",value:function(){var t=p(this,E)[E].isBuffering();this.started?t?(void 0!==this.playerStateManager&&this.playerStateManager.forcePollPlayerPosition(),this.notifyStallStart()):(this.notifyStallEnd(),this.setStatusCode(r.n.BPSessionEndsNormally),this.setPlayerErrorCode("")):!t&&this.playingEventReceived&&(this.started=!0,this.playerStateManager.start(),this.notifyFirstImage())}},{key:"onLayerSwitchEvent",value:function(){var t=this.getBitrate();t!==this.bitrate&&(this.bitrate=t,this.notifyLayerSwitch(t))}},{key:"handleSeek",value:function(t,e){this.notifySeek(t,e)}},{key:"onErrorEvent",value:function(t){t.detail.severity===v.library.util.Error.Severity.CRITICAL&&(this.setStatusCode(this.getErrorCode(t.detail)),this.setPlayerErrorCode(t.detail.code))}},{key:"getName",value:function(){return"Shaka Player"}},{key:"getVersion",value:function(){var t=v.library.Player.version.substring(0,32),e=t.indexOf(" ");return e>=0?t.substring(0,e):t}},{key:"getDeviceType",value:function(){var t=u(d(v.prototype),"getDeviceType",this).call(this);return 0===t.length&&(t="browser"),t}},{key:"getBitrate",value:function(){if(void 0!==p(this,E)[E])for(var t=p(this,E)[E].getVariantTracks(),e=0;e<t.length;e++){var n=t[e];if(!0===n.active)return Math.round(n.bandwidth/1e3)}return 0}},{key:"getPosition",value:function(){return void 0!==p(this,E)[E]?Math.round(1e3*p(this,E)[E].getMediaElement().currentTime):0}},{key:"getDuration",value:function(){return void 0===p(this,E)[E]||p(this,E)[E].isLive()?0:Math.round(1e3*p(this,E)[E].getMediaElement().duration)}},{key:"getCapabilities",value:function(){return{adTracking:!0}}},{key:"getErrorCode",value:function(t){switch(t.category){case v.library.util.Error.Category.NETWORK:return r.n.BPNetworkingError;case v.library.util.Error.Category.TEXT:case v.library.util.Error.Category.MEDIA:case v.library.util.Error.Category.MANIFEST:return r.n.BPFormatNotSupportedError;case v.library.util.Error.Category.STREAMING:return r.n.BPDecodingError;case v.library.util.Error.Category.DRM:return r.n.BPAccessRightError;case v.library.util.Error.Category.PLAYER:case v.library.util.Error.Category.CAST:case v.library.util.Error.Category.STORAGE:default:return r.n.BPUnspecifiedError}}},{key:"initSessionPlayerObjects",value:function(){this.started=!1,this.bitrate=0,this.playingEventReceived=!1,void 0!==p(this,E)[E]&&(void 0!==this.playerStateManager&&this.playerStateManager.stop(),this.playerStateManager=new i.a(this,this),this.playerListeners=[this.onPlayEvent.bind(this),this.onPauseEvent.bind(this),this.onBuffering.bind(this),this.onLayerSwitchEvent.bind(this),this.onErrorEvent.bind(this),this.onPlayingEvent.bind(this)],p(this,E)[E].getMediaElement().addEventListener("play",this.playerListeners[0]),p(this,E)[E].getMediaElement().addEventListener("pause",this.playerListeners[1]),p(this,E)[E].addEventListener("buffering",this.playerListeners[2]),p(this,E)[E].addEventListener("adaptation",this.playerListeners[3]),p(this,E)[E].addEventListener("error",this.playerListeners[4]),p(this,E)[E].getMediaElement().addEventListener("playing",this.playerListeners[5]))}},{key:"releaseSessionPlayerObjects",value:function(){void 0!==this.playerStateManager&&(this.playerStateManager.stop(),this.playerStateManager=void 0),void 0!==p(this,E)[E]&&void 0!==this.playerListeners&&6===this.playerListeners.length&&(p(this,E)[E].getMediaElement().removeEventListener("play",this.playerListeners[0]),p(this,E)[E].getMediaElement().removeEventListener("pause",this.playerListeners[1]),p(this,E)[E].removeEventListener("buffering",this.playerListeners[2]),p(this,E)[E].removeEventListener("adaptation",this.playerListeners[3]),p(this,E)[E].removeEventListener("error",this.playerListeners[4]),p(this,E)[E].getMediaElement().removeEventListener("playing",this.playerListeners[5]))}},{key:"attachPlayer",value:function(t,e){return!!v.checkPlayer(t,e)&&(void 0===v.library&&r.h.getInstance().printErrorLogs(g,"Player library not attached to the adapter, please call ShakaPlayerAdapter.attachLibrary(shaka) before attachPlayer"),p(this,E)[E]=t,p(this,S)[S]=e,!0)}},{key:"detachPlayer",value:function(){this.releaseSessionPlayerObjects(),p(this,E)[E]=void 0,p(this,S)[S]=void 0}}])&&a(e.prototype,n),o&&a(e,o),v}(r.i);b.library=void 0},function(t,e,n){"use strict";n.d(e,"a",(function(){return b})),n(9),n(11),n(12),n(39),n(7),n(65),n(46),n(30),n(4),n(26),n(54),n(15),n(13),n(14);var r=n(0),i=n(23);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=d(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d(t);if(e){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f(this,n)}}function f(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?h(t):e}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var v=0;function y(t){return"__private_"+v+++"_"+t}var g="BpkDashJsPlayerAdapter",E=y("player"),S=y("listener"),b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(y,t);var e,n,f,v=l(y);function y(){var t;s(this,y);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t=v.call.apply(v,[this].concat(n)),Object.defineProperty(h(t),E,{writable:!0,value:void 0}),Object.defineProperty(h(t),S,{writable:!0,value:void 0}),t.started=void 0,t.paused=void 0,t.buffering=void 0,t.seeking=void 0,t.seekBeginPosition=void 0,t.lastLayer=void 0,t.playerStateManager=void 0,t.playerListener=void 0,t}return e=y,f=[{key:"attachLibrary",value:function(t){void 0!==t.MediaPlayer&&void 0!==t.Version?(r.h.getInstance().printDebugLogs(g,"Dash.js library attached"),y.library=t):r.h.getInstance().printErrorLogs(g,"Try to attach a library, but it is not recognized")}},{key:"checkPlayer",value:function(t,e){return"undefined"!=typeof window&&void 0!==window.dashjs&&(y.library=window.dashjs),"object"===o(y.library)&&"function"==typeof t.getDashMetrics&&"function"==typeof t.getClassName&&"MediaPlayer"===t.getClassName()}}],(n=[{key:"handleEvent",value:function(t){if("playbackPlaying"===t.type)this.started?(this.buffering&&(this.notifyStallEnd(),this.setStatusCode(r.n.BPSessionEndsNormally),this.buffering=!1,this.seeking=!1),this.paused&&(this.notifyResume(),this.paused=!1)):(this.playerStateManager.start(),this.started=!0,this.notifyFirstImage());else if("playbackPaused"===t.type)this.started&&(!this.buffering&&p(this,E)[E].isSeeking()?(this.seeking=!0,this.buffering=!0,this.seekBeginPosition=this.playerStateManager.getPositionBeforeSeek(),this.notifyStallStart(),this.seeking&&this.notifySeek(this.seekBeginPosition,this.getPosition())):this.buffering&&p(this,E)[E].isSeeking()&&!this.seeking?(this.seeking=!0,this.seekBeginPosition=this.playerStateManager.getPositionBeforeSeek(),this.notifySeek(this.seekBeginPosition,this.getPosition())):p(this,E)[E].isPaused()&&!this.paused&&(this.paused=!0,this.notifyPause()));else if("playbackWaiting"===t.type||"bufferStalled"===t.type&&"video"===t.mediaType)this.started&&!this.buffering&&(p(this,E)[E].isSeeking()&&(this.seeking=!0,this.seekBeginPosition=this.playerStateManager.getPositionBeforeSeek()),this.buffering=!0,this.notifyStallStart(),this.seeking&&this.notifySeek(this.seekBeginPosition,this.getPosition()));else if("bufferLoaded"===t.type&&"video"===t.mediaType)this.started&&this.paused&&(this.notifyStallEnd(),this.setStatusCode(r.n.BPSessionEndsNormally),this.buffering=!1,this.seeking=!1);else if("qualityChangeRendered"===t.type){var e=this.getBitrate();e!==this.lastLayer&&(this.lastLayer=e,this.notifyLayerSwitch(e))}else"error"===t.type&&"object"===o(t.error)&&"DashJSError"===t.error.constructor.name&&(r.h.getInstance().printErrorLogs(g,"Player encountered an error : "+t.error.code),this.setStatusCode(this.getErrorCode(t.error)),this.setPlayerErrorCode(t.error.code))}},{key:"handleSeek",value:function(t,e){this.notifySeek(t,e)}},{key:"getName",value:function(){return"Dash.js"}},{key:"getVersion",value:function(){return y.library.Version.substring(0,32)}},{key:"getDeviceType",value:function(){var t=u(d(y.prototype),"getDeviceType",this).call(this);return 0===t.length&&(t="browser"),t}},{key:"getBitrate",value:function(){if(void 0!==p(this,E)[E]&&p(this,E)[E].isReady()){var t=p(this,E)[E].getQualityFor("video"),e=p(this,E)[E].getQualityFor("audio"),n=p(this,E)[E].getBitrateInfoListFor("video"),r=p(this,E)[E].getBitrateInfoListFor("audio"),i=0;return t<n.length&&(i=Math.round(n[t].bitrate/1e3)),e<r.length&&(i+=Math.round(r[e].bitrate/1e3)),i}return 0}},{key:"getPosition",value:function(){return void 0!==p(this,E)[E]?Math.round(1e3*p(this,E)[E].time()):0}},{key:"getDuration",value:function(){return void 0===p(this,E)[E]||p(this,E)[E].isDynamic()?0:Math.round(1e3*p(this,E)[E].duration())}},{key:"getCapabilities",value:function(){return{adTracking:!0}}},{key:"getErrorCode",value:function(t){var e=y.library.MediaPlayer.errors;switch(t.code){case e.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE:return r.n.BPFormatNotSupportedError;case e.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE:case e.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE:case e.SEGMENTS_UPDATE_FAILED_ERROR_CODE:case e.SEGMENTS_UNAVAILABLE_ERROR_CODE:case e.SEGMENT_BASE_LOADER_ERROR_CODE:case e.TIME_SYNC_FAILED_ERROR_CODE:case e.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE:case e.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE:case e.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE:case e.APPEND_ERROR_CODE:case e.REMOVE_ERROR_CODE:case e.DATA_UPDATE_FAILED_ERROR_CODE:return r.n.BPDecodingError;case e.CAPABILITY_MEDIASOURCE_ERROR_CODE:return r.n.BPFormatNotSupportedError;case e.CAPABILITY_MEDIAKEYS_ERROR_CODE:return r.n.BPAccessRightError;case e.DOWNLOAD_ERROR_ID_MANIFEST_CODE:case e.DOWNLOAD_ERROR_ID_SIDX_CODE:case e.DOWNLOAD_ERROR_ID_CONTENT_CODE:case e.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE:case e.DOWNLOAD_ERROR_ID_XLINK_CODE:return r.n.BPNetworkingError;case e.MANIFEST_ERROR_ID_CODEC_CODE:case e.MANIFEST_ERROR_ID_PARSE_CODE:case e.MANIFEST_ERROR_ID_NOSTREAMS_CODE:case e.TIMED_TEXT_ERROR_ID_PARSE_CODE:return r.n.BPDecodingError;case e.MANIFEST_ERROR_ID_MULTIPLEXED_CODE:case e.MEDIASOURCE_TYPE_UNSUPPORTED_CODE:return r.n.BPFormatNotSupportedError}return t.code>=e.MEDIA_KEYERR_CODE?r.n.BPAccessRightError:r.n.BPUnspecifiedError}},{key:"initSessionPlayerObjects",value:function(){this.started=!1,this.paused=!1,this.buffering=!1,this.seeking=!1,this.seekBeginPosition=0,this.lastLayer=0,void 0!==p(this,E)[E]&&(void 0!==this.playerStateManager&&this.playerStateManager.stop(),this.playerStateManager=new i.a(this,this),this.playerListener=this.handleEvent.bind(this),p(this,E)[E].on(y.library.MediaPlayer.events.PLAYBACK_PLAYING,this.playerListener,this),p(this,E)[E].on(y.library.MediaPlayer.events.PLAYBACK_PAUSED,this.playerListener,this),p(this,E)[E].on(y.library.MediaPlayer.events.BUFFER_EMPTY,this.playerListener,this),p(this,E)[E].on(y.library.MediaPlayer.events.QUALITY_CHANGE_RENDERED,this.playerListener,this),p(this,E)[E].on(y.library.MediaPlayer.events.ERROR,this.playerListener,this),p(this,E)[E].on(y.library.MediaPlayer.events.PLAYBACK_WAITING,this.playerListener,this),p(this,E)[E].on(y.library.MediaPlayer.events.BUFFER_LOADED,this.playerListener,this))}},{key:"releaseSessionPlayerObjects",value:function(){void 0!==this.playerStateManager&&(this.playerStateManager.stop(),this.playerStateManager=void 0),void 0!==p(this,E)[E]&&void 0!==this.playerListener&&(p(this,E)[E].off(y.library.MediaPlayer.events.PLAYBACK_PLAYING,this.playerListener,this),p(this,E)[E].off(y.library.MediaPlayer.events.PLAYBACK_PAUSED,this.playerListener,this),p(this,E)[E].off(y.library.MediaPlayer.events.BUFFER_EMPTY,this.playerListener,this),p(this,E)[E].off(y.library.MediaPlayer.events.QUALITY_CHANGE_RENDERED,this.playerListener,this),p(this,E)[E].off(y.library.MediaPlayer.events.ERROR,this.playerListener,this),p(this,E)[E].off(y.library.MediaPlayer.events.PLAYBACK_WAITING,this.playerListener,this),p(this,E)[E].off(y.library.MediaPlayer.events.BUFFER_LOADED,this.playerListener,this))}},{key:"attachPlayer",value:function(t,e){return!!y.checkPlayer(t,e)&&(void 0===y.library&&r.h.getInstance().printErrorLogs(g,"Player library not attached to the adapter, please call DashJsPlayerAdapter.attachLibrary(dashjs) before attachPlayer"),p(this,E)[E]=t,p(this,S)[S]=e,!0)}},{key:"detachPlayer",value:function(){this.releaseSessionPlayerObjects(),p(this,E)[E]=void 0,p(this,S)[S]=void 0}}])&&a(e.prototype,n),f&&a(e,f),y}(r.i);b.library=void 0},function(t,e,n){"use strict";n.d(e,"a",(function(){return S})),n(9),n(11),n(12),n(39),n(7),n(46),n(30),n(4),n(26),n(54),n(15),n(13),n(14);var r=n(0),i=n(23);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=d(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d(t);if(e){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f(this,n)}}function f(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?h(t):e}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var v=0;function y(t){return"__private_"+v+++"_"+t}var g=y("player"),E=y("listener"),S=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(y,t);var e,n,f,v=l(y);function y(){var t;s(this,y);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t=v.call.apply(v,[this].concat(n)),Object.defineProperty(h(t),g,{writable:!0,value:void 0}),Object.defineProperty(h(t),E,{writable:!0,value:void 0}),t.started=void 0,t.paused=void 0,t.waiting=void 0,t.seeking=void 0,t.playerStateManager=void 0,t.playerListeners=void 0,t}return e=y,f=[{key:"checkPlayer",value:function(t,e){return"object"===o(t.seekable)&&"function"==typeof t.play}}],(n=[{key:"onPlayingEvent",value:function(){this.started?(this.paused&&this.notifyResume(),this.seeking&&(this.playerStateManager.forcePollPlayerPosition(),this.notifyStallEnd(),this.waiting=!1),this.waiting&&this.notifyStallEnd()):(this.playerStateManager.start(),this.started=!0,this.notifyFirstImage()),this.paused=!1,this.waiting=!1,this.seeking=!1}},{key:"onPlayEvent",value:function(){this.paused&&this.notifyResume(),this.paused=!1}},{key:"onPauseEvent",value:function(){(!p(this,g)[g].seeking||p(this,g)[g].seeking&&this.seeking)&&(this.notifyPause(),this.paused=!0)}},{key:"onWaitingEvent",value:function(){p(this,g)[g].seeking||this.waiting||this.seeking||(this.notifyStallStart(),this.waiting=!0)}},{key:"onSeekingEvent",value:function(){this.seeking||(this.notifyStallStart(),this.playerStateManager.forcePollPlayerPosition(),this.seeking=!0)}},{key:"onProgressEvent",value:function(){this.paused&&(this.seeking&&(this.notifyStallEnd(!1),this.seeking=!1,this.waiting=!1),this.waiting&&(this.notifyStallEnd(!1),this.waiting=!1))}},{key:"onErrorEvent",value:function(){var t=p(this,g)[g].error;this.setStatusCode(this.getErrorCode(t)),this.setPlayerErrorCode(t.code),r.h.getInstance().printWarnLogs("BpkHTML5PlayerAdapter","Player error:"+t.message+" (code: "+t.code+")")}},{key:"handleSeek",value:function(t,e){this.notifySeek(t,e)}},{key:"getName",value:function(){return"HTML5"}},{key:"getVersion",value:function(){return""}},{key:"getDeviceType",value:function(){var t=u(d(y.prototype),"getDeviceType",this).call(this);return 0===t.length&&(t="browser"),t}},{key:"getBitrate",value:function(){return-1}},{key:"getPosition",value:function(){return void 0!==p(this,g)[g]?Math.round(1e3*p(this,g)[g].currentTime):0}},{key:"getDuration",value:function(){return void 0!==p(this,g)[g]&&isFinite(p(this,g)[g].duration)?Math.round(1e3*p(this,g)[g].duration):0}},{key:"getCapabilities",value:function(){return{adTracking:!1}}},{key:"getErrorCode",value:function(t){switch(t.code){case 1:return r.n.BPUnspecifiedError;case 2:return r.n.BPNetworkingError;case 3:return r.n.BPDecodingError;case 4:return r.n.BPFormatNotSupportedError;default:return r.n.BPUnspecifiedError}}},{key:"initSessionPlayerObjects",value:function(){this.started=!1,this.paused=!1,this.waiting=!1,this.seeking=!1,void 0!==p(this,g)[g]&&(void 0!==this.playerStateManager&&this.playerStateManager.stop(),this.playerStateManager=new i.a(this,this),this.playerListeners=[this.onPlayingEvent.bind(this),this.onPlayEvent.bind(this),this.onPauseEvent.bind(this),this.onWaitingEvent.bind(this),this.onSeekingEvent.bind(this),this.onProgressEvent.bind(this),this.onErrorEvent.bind(this)],p(this,g)[g].addEventListener("playing",this.playerListeners[0]),p(this,g)[g].addEventListener("play",this.playerListeners[1]),p(this,g)[g].addEventListener("pause",this.playerListeners[2]),p(this,g)[g].addEventListener("waiting",this.playerListeners[3]),p(this,g)[g].addEventListener("seeking",this.playerListeners[4]),p(this,g)[g].addEventListener("progress",this.playerListeners[5]),p(this,g)[g].addEventListener("error",this.playerListeners[6]))}},{key:"releaseSessionPlayerObjects",value:function(){void 0!==this.playerStateManager&&(this.playerStateManager.stop(),this.playerStateManager=void 0),void 0!==p(this,g)[g]&&void 0!==this.playerListeners&&this.playerListeners.length>0&&(p(this,g)[g].removeEventListener("playing",this.playerListeners[0]),p(this,g)[g].removeEventListener("play",this.playerListeners[1]),p(this,g)[g].removeEventListener("pause",this.playerListeners[2]),p(this,g)[g].removeEventListener("waiting",this.playerListeners[3]),p(this,g)[g].removeEventListener("seeking",this.playerListeners[4]),p(this,g)[g].removeEventListener("progress",this.playerListeners[5]),p(this,g)[g].removeEventListener("error",this.playerListeners[6]))}},{key:"attachPlayer",value:function(t,e){return!!y.checkPlayer(t,e)&&(p(this,g)[g]=t,p(this,E)[E]=e,!0)}},{key:"detachPlayer",value:function(){this.releaseSessionPlayerObjects(),p(this,g)[g]=void 0,p(this,E)[E]=void 0}}])&&a(e.prototype,n),f&&a(e,f),y}(r.i)},function(t,e,n){"use strict";n.d(e,"a",(function(){return g})),n(9),n(11),n(12),n(39),n(19),n(7),n(114),n(216),n(30),n(4),n(26),n(22),n(15),n(13),n(34),n(14);var r=n(0),i=n(23);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function c(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var l=0;function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function d(t,e,n){return e&&h(t.prototype,e),n&&h(t,n),t}var p="BpkAVPlayAdapter",v=function(){function t(e){f(this,t),this.adapter=void 0,this.listener=void 0,this.lastPosition=void 0,this.waitToStartTask=void 0,this.adapter=e,this.listener=e.listener,this.waitToStartTask=void 0}return d(t,[{key:"onEvent",value:function(t,e,n){void 0!==this.listener&&"function"==typeof this.listener[t]&&this.listener[t](e,n)}},{key:"onbufferingstart",value:function(){this.onEvent("onbufferingstart"),this.adapter.started&&!this.adapter.stalling&&this.adapter.notifyStallStart(),this.adapter.buffering=!0}},{key:"onbufferingprogress",value:function(t){this.onEvent("onbufferingprogress",t)}},{key:"tryToStart",value:function(){this.adapter.player.getDuration(),this.adapter.player.getCurrentStreamInfo(),this.adapter.player.getCurrentTime(),this.adapter.player.getStreamingProperty("IS_LIVE"),r.h.getInstance().printDebugLogs(p,"Player fully initialized, starting the session..."),this.adapter.playerStateManager.start(),this.adapter.started=!0,this.adapter.notifyFirstImage()}},{key:"onbufferingcomplete",value:function(){var t=this;if(this.onEvent("onbufferingcomplete"),this.adapter.started)this.adapter.stalling=!1,this.adapter.playerStateManager.forcePollPlayerPosition(),this.adapter.notifyStallEnd();else if(void 0===this.waitToStartTask){this.waitToStartTask={};try{this.tryToStart()}catch(e){this.waitToStartTask=setInterval((function(){try{t.tryToStart(),clearInterval(t.waitToStartTask)}catch(t){}}),100)}}this.adapter.buffering=!1}},{key:"oncurrentplaytime",value:function(t){this.onEvent("oncurrentplaytime",t),this.adapter.started&&(this.adapter.paused||(this.lastPosition===t?this.adapter.stalling||(this.adapter.stalling=!0,this.adapter.notifyStallStart()):(this.adapter.stalling=!1,this.adapter.buffering||this.adapter.notifyStallEnd(!this.adapter.paused)),this.lastPosition=t))}},{key:"onstreamcompleted",value:function(){this.onEvent("onstreamcompleted")}},{key:"onevent",value:function(t,e){switch(this.onEvent("onevent",t,e),t){case"PLAYER_MSG_BITRATE_CHANGE":if("string"==typeof e&&-1!==e.indexOf("BITRATE:")){var n=e.split(":")[1],i=Math.round(Number.parseInt(n,10)/1e3);i<=256?(this.adapter.nextBitrate=-1,r.h.getInstance().printWarnLogs(p,"Ignoring current bitrate "+i+"kbps because it is too low to be a video layer.")):(this.adapter.nextBitrate=Math.round(Number.parseInt(n,10)/1e3),this.adapter.appliedBitrate=this.adapter.nextBitrate,this.adapter.notifyLayerSwitch())}else{var o=JSON.parse(this.adapter.player.getCurrentStreamInfo()[0].extra_info),s=Math.round(Number.parseInt(o.Bit_rate,10)/1e3);this.adapter.nextBitrate=s,-1===this.adapter.appliedBitrate&&(this.adapter.appliedBitrate=this.adapter.nextBitrate)}break;case"PLAYER_MSG_RESOLUTION_CHANGED":if(-1===this.adapter.nextBitrate){var a=JSON.parse(this.adapter.player.getCurrentStreamInfo()[0].extra_info),u=Math.round(Number.parseInt(a.Bit_rate,10)/1e3);this.adapter.nextBitrate=u}this.adapter.appliedBitrate=this.adapter.nextBitrate,this.adapter.notifyLayerSwitch()}}},{key:"onerror",value:function(t){if(this.onEvent("onerror",t),this.adapter.setStatusCode(this.adapter.getErrorCode(t)),t.indexOf("PLAYER_ERROR_")>=0){var e=t.substr(13);this.adapter.setPlayerErrorCode(e)}r.h.getInstance().printWarnLogs(p,"Player error: "+t)}},{key:"ondrmevent",value:function(t,e){this.onEvent("ondrmevent",t,e)}},{key:"onsubtitlechange",value:function(){this.onEvent("onsubtitlechange")}}]),t}(),y="__private_"+l+++"_playerNativeFunctions",g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=u(t);if(e){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return a(this,n)}}(n);function n(){var t;f(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))).player=void 0,t.listener=void 0,t.started=void 0,t.paused=void 0,t.stalling=void 0,t.buffering=void 0,t.nextBitrate=void 0,t.appliedBitrate=void 0,t.playerStateManager=void 0,t.playerListener=void 0,t}return d(n,[{key:"onPlayEvent",value:function(){this.started&&(this.notifyResume(),this.paused=!1)}},{key:"onPauseEvent",value:function(){this.started&&(this.notifyPause(),this.paused=!0)}},{key:"onSeekToEvent",value:function(){var t=this;this.playerStateManager.forcePollPlayerPosition(),this.playerListener.oncurrentplaytime(this.getPosition()),setTimeout((function(){t.playerListener.oncurrentplaytime(t.getPosition())}),2)}},{key:"onJumpForwardEvent",value:function(){this.onSeekToEvent()}},{key:"onJumpBackwardEvent",value:function(){this.onSeekToEvent()}},{key:"handleSeek",value:function(t,e){this.notifySeek(t,e)}},{key:"getName",value:function(){return"AVPlay"}},{key:"getVersion",value:function(){return void 0!==this.player?this.player.getVersion():""}},{key:"getDeviceType",value:function(){return"tv"}},{key:"getBitrate",value:function(){return this.appliedBitrate}},{key:"getPosition",value:function(){if(void 0!==this.player)try{return this.player.getCurrentTime()}catch(t){return r.h.getInstance().printDebugLogs(p,"getPosition error : "+JSON.stringify(t)),0}return 0}},{key:"getDuration",value:function(){if(void 0!==this.player&&!this.isLive())try{return this.player.getDuration()}catch(t){return r.h.getInstance().printDebugLogs(p,"getDuration error : "+JSON.stringify(t)),0}return 0}},{key:"getCapabilities",value:function(){return{adTracking:!0}}},{key:"isLive",value:function(){try{return void 0!==this.player&&"1"===this.player.getStreamingProperty("IS_LIVE")}catch(t){return r.h.getInstance().printDebugLogs(p,"isLive error : "+JSON.stringify(t)),!0}}},{key:"getErrorCode",value:function(t){switch(t){case"PLAYER_ERROR_NO_SUCH_FILE":case"PLAYER_ERROR_INVALID_URI":case"PLAYER_ERROR_CONNECTION_FAILED":return r.n.BPNetworkingError;case"PLAYER_ERROR_NOT_SUPPORTED_FILE":return r.n.BPFormatNotSupportedError}return r.n.BPSessionEndsNormally}},{key:"initSessionPlayerObjects",value:function(){var t=this;this.started=!1,this.paused=!1,this.buffering=!0,this.stalling=!1,this.nextBitrate=-1,this.appliedBitrate=-1,void 0!==this.player&&(void 0!==this.playerStateManager&&this.playerStateManager.stop(),this.playerStateManager=new i.a(this,this),void 0===c(n,y)[y]&&(c(n,y)[y]={},c(n,y)[y].play=this.player.play,c(n,y)[y].pause=this.player.pause,c(n,y)[y].seekTo=this.player.seekTo,c(n,y)[y].jumpForward=this.player.jumpForward,c(n,y)[y].jumpBackward=this.player.jumpBackward),this.playerListener=new v(this),this.player.setListener(this.playerListener),this.player.play=function(){c(n,y)[y].play(),t.onPlayEvent()},this.player.pause=function(){c(n,y)[y].pause(),t.onPauseEvent()},this.player.seekTo=function(e,r,i){void 0===r&&void 0===i?c(n,y)[y].seekTo(e):void 0!==r&&void 0===i?c(n,y)[y].seekTo(e,r):c(n,y)[y].seekTo(e,r,i),t.onSeekToEvent(e)},this.player.jumpForward=function(e,r,i){void 0===r&&void 0===i?c(n,y)[y].jumpForward(e):void 0!==r&&void 0===i?c(n,y)[y].jumpForward(e,r):c(n,y)[y].jumpForward(e,r,i),t.onJumpForwardEvent(e)},this.player.jumpBackward=function(e,r,i){void 0===r&&void 0===i?c(n,y)[y].jumpBackward(e):void 0!==r&&void 0===i?c(n,y)[y].jumpBackward(e,r):c(n,y)[y].jumpBackward(e,r,i),t.onJumpBackwardEvent(e)})}},{key:"releaseSessionPlayerObjects",value:function(){void 0!==this.playerStateManager&&(this.playerStateManager.stop(),this.playerStateManager=void 0),void 0!==this.player&&(void 0!==this.playerListener&&clearInterval(this.playerListener.waitToStartTask),this.player.setListener(this.listener),void 0!==c(n,y)[y]&&(this.player.play=c(n,y)[y].play,this.player.pause=c(n,y)[y].pause,this.player.seekTo=c(n,y)[y].seekTo,this.player.jumpForward=c(n,y)[y].jumpForward,this.player.jumpBackward=c(n,y)[y].jumpBackward))}},{key:"attachPlayer",value:function(t,e){return!!n.checkPlayer(t,e)&&(this.player=t,this.listener=e,!0)}},{key:"detachPlayer",value:function(){this.releaseSessionPlayerObjects(),this.player=void 0,this.listener=void 0}}],[{key:"checkPlayer",value:function(t,e){return"function"==typeof t.getTotalTrackInfo&&"function"==typeof t.getCurrentStreamInfo}}]),n}(r.i);Object.defineProperty(g,y,{writable:!0,value:void 0})},function(t,e,n){"use strict";n.d(e,"a",(function(){return S})),n(9),n(11),n(12),n(39),n(19),n(7),n(30),n(4),n(26),n(22),n(15),n(13),n(34),n(14);var r=n(0),i=n(23);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=h(t);if(e){var i=h(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l(this,n)}}function l(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?f(t):e}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var p=0;function v(t){return"__private_"+p+++"_"+t}var y="BpkSagemcomDIW387Adapter",g=v("player"),E=v("listener"),S=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(h,t);var e,n,o,l=c(h);function h(){var t;s(this,h);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t=l.call.apply(l,[this].concat(n)),Object.defineProperty(f(t),g,{writable:!0,value:void 0}),Object.defineProperty(f(t),E,{writable:!0,value:void 0}),t.mediaStartTime=0,t.mediaDuration=0,t.started=void 0,t.paused=void 0,t.playerStateManager=void 0,t.playerListener=void 0,t}return e=h,o=[{key:"checkPlayer",value:function(t,e){return void 0!==t.Get&&void 0!==t.session&&void 0!==t.event}}],(n=[{key:"handlePlayerEvent",value:function(t){switch(t){case 36896:case 4162:!1===this.started&&(this.started=!0,this.playerStateManager.start(),this.notifyFirstImage());break;case 4096:case 36865:case 36898:case 4114:this.setMediaInfo(0,0);break;case 38401:case 4168:this.paused=!0,this.notifyPause();break;case 38400:case 4169:this.paused=!1,this.notifyResume();break;case 37376:case 37377:case 37378:case 37379:case 37380:case 37392:this.setStatusCode(r.n.BPDecodingError),this.setPlayerErrorCode(t),this.setMediaInfo(0,0);break;case 37381:this.setStatusCode(r.n.BPFormatNotSupportedError),this.setPlayerErrorCode(t),this.setMediaInfo(0,0);break;case 37382:case 38721:case 38722:this.setStatusCode(r.n.BPAccessRightError),this.setPlayerErrorCode(t),this.setMediaInfo(0,0);break;case 37120:case 37121:case 37122:case 37123:case 37124:this.setStatusCode(r.n.BPNetworkingError),this.setPlayerErrorCode(t),this.setMediaInfo(0,0);break;case 4196:void 0!==this.playerStateManager&&this.playerStateManager.forcePollPlayerPosition(),this.notifyStallStart();break;case 4197:this.notifyStallEnd(!this.paused);break;case 38704:case 4307:this.notifyLayerSwitch()}}},{key:"handleEvent",value:function(t){if(void 0!==d(this,g)[g]){var e=d(this,g)[g].event.getSource(t.keyCodeVal).split(":");if(e.length>=2){var n=parseInt(e[1],10);"live_livePlayerWidget"!==e[0]&&(r.h.getInstance().printDebugLogs(y,"Processing event 0x"+n.toString(16)),this.handlePlayerEvent(n))}else parseInt(t,10)}}},{key:"handleSeek",value:function(t,e){this.notifySeek(t,e)}},{key:"getName",value:function(){var t=this.executeSystemCommand("INFO","LOADER_VERSION");return-1!==t.indexOf("DIW387")?"Sagemcom DIW387":-1!==t.indexOf("DIW384")?"Sagemcom DIW384":"Sagemcom DIW387"}},{key:"getVersion",value:function(){return this.executeSystemCommand("INFO","SOFTWARE_VERSION")}},{key:"getDeviceType",value:function(){return"stb"}},{key:"getBitrate",value:function(){if(void 0!==d(this,g)[g]&&void 0!==h.handle){var t=this.executeSessionCommand("VARIANT","CURRENT"),e=-1;if("string"==typeof t&&""!==t){if(!(h.handle.indexOf("avplayer")>-1)){var n=t.split(":");return null!==n&&n.length>0&&(e=n[2]),isNaN(e)?-1:Math.round(parseInt(e,10)/1e3)}for(var r=t.split(","),i=0;i<r.length;i++)if(r[i].indexOf("bandwidth:")>-1){var o=r[i].split(":");if(o.length>=2)return isNaN(o[1])?-1:Math.round(parseInt(o[1],10)/1e3)}}return-1}return-1}},{key:"getPosition",value:function(){if(void 0!==d(this,g)[g]){var t=this.executeSessionCommand("POSITION","SEC");return""===t?-1:t>=946684800&&this.mediaStartTime>0?t-this.mediaStartTime:1e3*t}return 0}},{key:"getDuration",value:function(){if(void 0!==d(this,g)[g]){var t=this.executeSessionCommand("DURATION","SEC");return""===t?-1:t>=9007199254740991?this.mediaDuration:1e3*t}return 0}},{key:"getCapabilities",value:function(){return{adTracking:!1}}},{key:"transformResult",value:function(t){return isNaN(t)?t:parseInt(t,10)}},{key:"executeSystemCommand",value:function(t,e){try{var n=d(this,g)[g].Get(t,e).toString().split(";");return 1===n.length?this.transformResult(n[0]):n.length>=2&&"0"===n[0]?this.transformResult(n[1]):""}catch(t){return console.log(t),""}}},{key:"executeSessionCommand",value:function(t,e){try{var n=d(this,g)[g].session.Get(h.handle,t,e).toString().split(";");return 1===n.length?this.transformResult(n[0]):n.length>=2&&"0"===n[0]?this.transformResult(n[1]):""}catch(t){return console.log(t),""}}},{key:"setInstanceName",value:function(t){r.h.getInstance().printDebugLogs(y,"Setting instance name to "+t),h.handle="string"==typeof t?t:""}},{key:"onPlayerEvent",value:function(t){if(r.h.getInstance().printDebugLogs(y,"Processing "+t.session_name+" "+t.event_hex),void 0!==d(this,g)[g]){var e=t.session_name;if(("avplayerSession"===e||"HLS_VOD"===e)&&void 0!==t.event_hex){var n=String(t.event_hex);if(n.length>=5){var i=parseInt(n.substr(1,4),16);this.handlePlayerEvent(i)}}}else r.h.getInstance().printWarnLogs(y,"Cannot handle event if no player attached")}},{key:"setMediaInfo",value:function(t,e){this.mediaStartTime=t,this.mediaDuration=e}},{key:"initSessionPlayerObjects",value:function(){this.started=!1,this.paused=!1,this.mediaStartTime=0,this.mediaDuration=0,void 0!==d(this,g)[g]&&(void 0!==this.playerStateManager&&this.playerStateManager.stop(),this.playerStateManager=new i.a(this,this))}},{key:"releaseSessionPlayerObjects",value:function(){void 0!==this.playerStateManager&&(this.playerStateManager.stop(),this.playerStateManager=void 0)}},{key:"attachPlayer",value:function(t,e){return!!h.checkPlayer(t,e)&&(d(this,g)[g]=t,this.playerListener=this.handleEvent.bind(this),document.addEventListener("keypress",this.playerListener,!1),!0)}},{key:"detachPlayer",value:function(){this.releaseSessionPlayerObjects(),void 0!==d(this,g)[g]&&(document.removeEventListener("keypress",this.playerListener),this.playerListener=void 0,d(this,g)[g]=void 0),d(this,E)[E]=void 0}}])&&a(e.prototype,n),o&&a(e,o),h}(r.i);S.handle=void 0},function(t,e,n){"use strict";n.d(e,"a",(function(){return S})),n(9),n(11),n(12),n(39),n(7),n(46),n(30),n(4),n(26),n(54),n(22),n(15),n(13),n(113),n(14);var r=n(0),i=n(23);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=d(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d(t);if(e){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f(this,n)}}function f(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?h(t):e}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var v=0;function y(t){return"__private_"+v+++"_"+t}var g=y("player"),E=y("listener"),S=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(y,t);var e,n,f,v=l(y);function y(){var t;s(this,y);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t=v.call.apply(v,[this].concat(n)),Object.defineProperty(h(t),g,{writable:!0,value:void 0}),Object.defineProperty(h(t),E,{writable:!0,value:void 0}),t.started=void 0,t.buffering=void 0,t.playerStateManager=void 0,t.playerListener=void 0,t}return e=y,f=[{key:"checkPlayer",value:function(t,e){return"number"==typeof t.playPosition&&"number"==typeof t.playState}}],(n=[{key:"onPlayStateChange",value:function(t){switch(t){case 0:break;case 1:this.started?(!0===this.buffering&&(this.buffering=!1,this.notifyStallEnd(!0)),this.notifyResume(),this.setStatusCode(r.n.BPSessionEndsNormally),this.setPlayerErrorCode("")):(this.started=!0,this.playerStateManager.start(),this.notifyFirstImage());break;case 2:!0===this.buffering&&(this.buffering=!1,this.notifyStallEnd(!0)),this.notifyPause();break;case 3:break;case 4:this.started&&(void 0!==this.playerStateManager&&this.playerStateManager.forcePollPlayerPosition(),this.buffering=!0,this.notifyStallStart());break;case 5:break;case 6:r.h.getInstance().printErrorLogs("BpkHbbTV1PlayerAdapter","On player error : "+p(this,g)[g].error),this.setStatusCode(this.getErrorCode(p(this,g)[g].error)),this.setPlayerErrorCode(p(this,g)[g].error)}}},{key:"handleSeek",value:function(t,e){!1===this.buffering&&(this.buffering=!0,this.notifyStallStart()),this.notifySeek(t,e)}},{key:"getName",value:function(){return"HbbTV"}},{key:"getVersion",value:function(){if("object"===("undefined"==typeof navigator?"undefined":o(navigator))&&void 0!==navigator.userAgent){var t=navigator.userAgent.match("HbbTV/([0-9.]*)");if(null!==t)return t[1]}return"1.X"}},{key:"getDeviceType",value:function(){var t=u(d(y.prototype),"getDeviceType",this).call(this);return 0===t.length&&(t="tv"),t}},{key:"getBitrate",value:function(){return-1}},{key:"getPosition",value:function(){return void 0!==p(this,g)[g]?Math.round(p(this,g)[g].playPosition):0}},{key:"getDuration",value:function(){return void 0!==p(this,g)[g]&&0!==p(this,g)[g].playTime&&p(this,g)[g].playTime!==1/0?Math.round(p(this,g)[g].playTime):0}},{key:"getCapabilities",value:function(){return{adTracking:!0}}},{key:"getErrorCode",value:function(t){switch(t){case 0:return r.n.BPFormatNotSupportedError;case 1:return r.n.BPNetworkingError;case 2:return r.n.BPUnspecifiedError;case 3:case 4:return r.n.BPDecodingError;case 5:case 6:return r.n.BPNetworkingError}return r.n.BPUnspecifiedError}},{key:"initSessionPlayerObjects",value:function(){var t=this;this.started=!1,this.buffering=!1,void 0!==p(this,g)[g]&&(void 0!==this.playerStateManager&&this.playerStateManager.stop(),this.playerStateManager=new i.a(this,this),this.playerListener=p(this,g)[g].onPlayStateChange,p(this,g)[g].onPlayStateChange=function(e){t.onPlayStateChange(e),"function"==typeof t.playerListener&&t.playerListener(e)})}},{key:"releaseSessionPlayerObjects",value:function(){void 0!==this.playerStateManager&&(this.playerStateManager.stop(),this.playerStateManager=void 0),void 0!==p(this,g)[g]&&(p(this,g)[g].onPlayStateChange=this.playerListener)}},{key:"attachPlayer",value:function(t,e){return!!y.checkPlayer(t,e)&&(p(this,g)[g]=t,p(this,E)[E]=e,!0)}},{key:"detachPlayer",value:function(){this.releaseSessionPlayerObjects(),p(this,g)[g]=void 0,p(this,E)[E]=void 0}}])&&a(e.prototype,n),f&&a(e,f),y}(r.i)},function(t,e,n){"use strict";n.d(e,"a",(function(){return d})),n(9),n(11),n(12),n(39),n(7),n(46),n(30),n(4),n(26),n(54),n(15),n(13),n(14);var r=n(0),i=n(23);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=h(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=h(t);if(e){var i=h(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f(this,n)}}function f(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(d,t);var e,n,o,f=l(d);function d(){var t;s(this,d);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=f.call.apply(f,[this].concat(n))).player=void 0,t.listener=void 0,t.started=void 0,t.paused=void 0,t.buffering=void 0,t.seeking=void 0,t.bitrate=void 0,t.seekStart=void 0,t.seekEnd=void 0,t.playerStateManager=void 0,t.playerListeners=void 0,t}return e=d,o=[{key:"checkPlayer",value:function(t,e){var n;return void 0!==(null===(n=t.Event)||void 0===n?void 0:n.Core)}}],(n=[{key:"handleSeek",value:function(t,e){return!0===this.seeking?(this.notifySeek(t,e),!0):(!1===this.seeking&&(this.seekStart=t,this.seekEnd=e),!1)}},{key:"onSeekingEvent",value:function(){this.seeking=!0,void 0!==this.seekStart&&void 0!==this.seekEnd&&(this.notifySeek(this.seekStart,this.seekEnd),this.seekStart=void 0,this.seekEnd=void 0)}},{key:"onSeekedEvent",value:function(){this.seeking=!1}},{key:"onPlayheadUpdated",value:function(t){}},{key:"onPlaybackInfoUpdated",value:function(t){var e=Math.floor(t.payload.selectedVideoTrack.bandwidth/1e3);e>0&&e!==this.bitrate&&(this.bitrate=e,this.notifyLayerSwitch(e))}},{key:"onPlayingEvent",value:function(t){!1===this.started?(this.started=!0,this.playerStateManager.start(),this.notifyFirstImage()):(!0===this.paused&&(this.paused=!1,this.notifyResume()),this.onStallEndEvent())}},{key:"onPlayEvent",value:function(t){!0===this.started&&!0===this.paused&&(this.paused=!1,this.notifyResume())}},{key:"onPauseEvent",value:function(t){!0===this.started&&!1===this.paused&&(this.paused=!0,this.notifyPause())}},{key:"onStallStartEvent",value:function(t){!0===this.started&&!1===this.buffering&&(this.buffering=!0,this.notifyStallStart(),void 0!==this.playerStateManager&&this.playerStateManager.forcePollPlayerPosition())}},{key:"onStallEndEvent",value:function(t){!0===this.started&&!0===this.buffering&&(this.buffering=!1,void 0!==this.playerStateManager&&this.playerStateManager.forcePollPlayerPosition(),this.notifyStallEnd(!this.paused),this.setStatusCode(r.n.BPSessionEndsNormally),this.setPlayerErrorCode(""))}},{key:"onErrorEvent",value:function(t){console.log("ON ERROR",this.player.Error),t.payload.severity===this.player.Error.Severity.CRITICAL&&(r.h.getInstance().printErrorLogs("BpkKalturaPlayerAdapter","On player error "+t.payload.code),this.setStatusCode(this.getErrorCode(t.payload)),this.setPlayerErrorCode(t.payload.code))}},{key:"getName",value:function(){return"Kaltura"}},{key:"getVersion",value:function(){var t,e;return void 0!==(null===(t=this.player)||void 0===t||null===(e=t._provider)||void 0===e?void 0:e._playerVersion)?this.player._provider._playerVersion:"Unknown"}},{key:"getDeviceType",value:function(){var t=u(h(d.prototype),"getDeviceType",this).call(this);return 0===t.length&&(t="browser"),t}},{key:"getBitrate",value:function(){return this.bitrate}},{key:"getPosition",value:function(){return void 0!==this.player?Math.round(1e3*this.player.currentTime):0}},{key:"getDuration",value:function(){return void 0===this.player||this.player.isLive()?0:Math.round(1e3*this.player.duration)}},{key:"getCapabilities",value:function(){return{adTracking:!1}}},{key:"getErrorCode",value:function(t){var e=this.player.Error.Category;switch(t.category){case e.NETWORK:return r.n.BPNetworkingError;case e.TEXT:case e.MEDIA:case e.MANIFEST:return r.n.BPFormatNotSupportedError;case e.STREAMING:return r.n.BPDecodingError;case e.DRM:return r.n.BPAccessRightError;case e.PLAYER:case e.ADS:case e.STORAGE:case e.CAST:case e.VR:return r.n.BPUnspecifiedError}return r.n.BPUnspecifiedError}},{key:"initSessionPlayerObjects",value:function(){var t=this;this.started=!1,this.paused=!1,this.buffering=!1,this.seeking=!1,this.bitrate=-1,this.seekStart=void 0,this.seekEnd=void 0,void 0!==this.player&&(void 0!==this.playerStateManager&&this.playerStateManager.stop(),this.playerStateManager=new i.a(this,this),this.playerListeners=[function(e){t.onPlayheadUpdated(e)},function(e){t.onPlaybackInfoUpdated(e)},function(e){t.onPlayingEvent(e)},function(e){t.onPlayEvent(e)},function(e){t.onPauseEvent(e)},function(e){t.onSeekingEvent(),t.onStallStartEvent(e)},function(e){t.onStallStartEvent(e)},function(e){t.onStallEndEvent(e)},function(e){t.onSeekedEvent(),t.onStallEndEvent(e)},function(e){t.onErrorEvent(e)}],this.player.addEventListener(this.player.Event.Core.VIDEO_TRACK_CHANGED,this.playerListeners[1]),this.player.addEventListener(this.player.Event.Core.PLAYING,this.playerListeners[2]),this.player.addEventListener(this.player.Event.Core.PLAY,this.playerListeners[3]),this.player.addEventListener(this.player.Event.Core.PAUSE,this.playerListeners[4]),this.player.addEventListener(this.player.Event.Core.SEEKING,this.playerListeners[5]),this.player.addEventListener(this.player.Event.Core.WAITING,this.playerListeners[6]),this.player.addEventListener(this.player.Event.Core.STALLED,this.playerListeners[7]),this.player.addEventListener(this.player.Event.Core.SEEKED,this.playerListeners[8]),this.player.addEventListener(this.player.Event.Core.ERROR,this.playerListeners[9]))}},{key:"releaseSessionPlayerObjects",value:function(){void 0!==this.playerStateManager&&(this.playerStateManager.stop(),this.playerStateManager=void 0),void 0!==this.player&&void 0!==this.playerListeners&&10===this.playerListeners.length&&(this.player.removeEventListener(this.player.Event.Core.VIDEO_TRACK_CHANGED,this.playerListeners[1]),this.player.removeEventListener(this.player.Event.Core.PLAYING,this.playerListeners[2]),this.player.removeEventListener(this.player.Event.Core.PLAY,this.playerListeners[3]),this.player.removeEventListener(this.player.Event.Core.PAUSE,this.playerListeners[4]),this.player.removeEventListener(this.player.Event.Core.SEEKING,this.playerListeners[5]),this.player.removeEventListener(this.player.Event.Core.WAITING,this.playerListeners[6]),this.player.removeEventListener(this.player.Event.Core.STALLED,this.playerListeners[7]),this.player.removeEventListener(this.player.Event.Core.SEEKED,this.playerListeners[8]),this.player.removeEventListener(this.player.Event.Core.ERROR,this.playerListeners[9]))}},{key:"attachPlayer",value:function(t,e){return!!d.checkPlayer(t,e)&&(this.player=t,this.listener=e,!0)}},{key:"detachPlayer",value:function(){this.releaseSessionPlayerObjects(),this.player=void 0,this.listener=void 0}}])&&a(e.prototype,n),o&&a(e,o),d}(r.i)},function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return b})),n(9),n(11),n(12),n(7),n(131),n(4),n(13),n(14);var r=n(0),i=n(154),o=n(155),s=n(156),a=n(157),u=n(158),c=n.n(u);function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e,n){return e&&f(t.prototype,e),n&&f(t,n),t}function d(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var p=0;function v(t){return"__private_"+p+++"_"+t}var y=v("instance"),g=v("initialized"),E=v("loggerHandler"),S=v("playerManagerHandler"),b=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,g,{writable:!0,value:void 0}),Object.defineProperty(this,E,{writable:!0,value:void 0}),Object.defineProperty(this,S,{writable:!0,value:void 0}),d(this,g)[g]=!1,d(this,E)[E]=new i.a}return h(e,null,[{key:"getInstance",value:function(){return d(e,y)[y]||(d(e,y)[y]=new e),d(e,y)[y]}}]),h(e,[{key:"init",value:function(){if(!d(this,g)[g]){d(this,g)[g]=!0;var n=Date.now();this.log(r.g.VERBOSE,e.TAG,"Loading engine..."),this.log(r.g.VERBOSE,e.TAG,"Version: "+a.a),this.registerSystemFunctions(),this.registerPlayerAdapters(),"object"===("undefined"==typeof window?"undefined":l(window))?this.registerSmartLibFunctions(window):(this.registerSmartLibFunctions(),"undefined"==typeof XMLHttpRequest&&(t.XMLHttpRequest=c()("xmlhttprequest").XMLHttpRequest)),this.log(r.g.VERBOSE,e.TAG,"Took "+(Date.now()-n)+"ms to load")}}},{key:"registerSystemFunctions",value:function(){this.log(r.g.VERBOSE,e.TAG,"Registering system functions..."),r.h.getInstance().init(d(this,E)[E]),r.l.getInstance().init(new o.a)}},{key:"registerPlayerAdapters",value:function(){d(this,S)[S]=new s.a}},{key:"registerSmartLibFunctions",value:function(t){var e=this;r.n.prototype.defaultAttachPlayer=r.n.prototype.attachPlayer,r.n.prototype.attachPlayer=function(t,n){r.k.getInstance().init(d(e,S)[S]);var i=d(e,S)[S].attachPlayer(t,n);this.defaultAttachPlayer(i)},r.o.prototype.defaultAttachPlayer=r.o.prototype.attachPlayer,r.o.prototype.attachPlayer=function(t,n){r.k.getInstance().init(d(e,S)[S]);var i=d(e,S)[S].attachPlayer(t,n);this.defaultAttachPlayer(i)},"object"===l(t)&&(t.SmartLib=Object.assign(r.n.getInstance(),r.n),t.SmartLib.getInstance=function(){return r.n.getInstance()},t.LoggerManager=r.h,t.PlayerEventListener=r.j,t.GenericPlayerApi=r.e,t.PlayerApiImp={getVersion:function(){var t=r.k.getInstance().getPlayerAdapter();return void 0!==t&&"function"==typeof t.getVersion?t.getVersion():"undefined"},getErrorCode:function(t){var e=r.k.getInstance().getPlayerAdapter();return void 0!==e&&"function"==typeof e.getErrorCode?e.getErrorCode(t):r.n.BPUnspecifiedError}},t.StreamingSession=r.o,t.StreamingSessionOptions=r.p,t.StreamingSessionResult=r.q,t.AdManager=r.a)}},{key:"log",value:function(t,e,n){d(this,E)[E].log(t,e,n)}}]),e}();b.TAG="BpkCoreEngine",Object.defineProperty(b,y,{writable:!0,value:void 0})}).call(this,n(117))},function(t,e,n){"use strict";var r={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,o=i&&!r.call({1:2},1);e.f=o?function(t){var e=i(this,t);return!!e&&e.enumerable}:r},function(t,e,n){var r=n(2),i=n(10),o=r.document,s=i(o)&&i(o.createElement);t.exports=function(t){return s?o.createElement(t):{}}},function(t,e,n){var r=n(2),i=n(24);t.exports=function(t,e){try{i(r,t,e)}catch(n){r[t]=e}return e}},function(t,e,n){var r=n(91),i=Function.toString;"function"!=typeof r.inspectSource&&(r.inspectSource=function(t){return i.call(t)}),t.exports=r.inspectSource},function(t,e,n){var r=n(2),i=n(89),o=r["__core-js_shared__"]||i("__core-js_shared__",{});t.exports=o},function(t,e,n){var r=n(41),i=n(91);(t.exports=function(t,e){return i[t]||(i[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.7.0",mode:r?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(t,e){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var r=n(3);t.exports=!!Object.getOwnPropertySymbols&&!r((function(){return!String(Symbol())}))},function(t,e,n){var r=n(10),i=n(70),o=n(6)("species");t.exports=function(t,e){var n;return i(t)&&("function"!=typeof(n=t.constructor)||n!==Array&&!i(n.prototype)?r(n)&&null===(n=n[o])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===e?0:e)}},function(t,e,n){var r={};r[n(6)("toStringTag")]="z",t.exports="[object z]"===String(r)},function(t,e,n){"use strict";var r=n(42),i=n(20),o=n(6),s=n(16),a=o("species");t.exports=function(t){var e=r(t),n=i.f;s&&e&&!e[a]&&n(e,a,{configurable:!0,get:function(){return this}})}},function(t,e){t.exports=function(t,e,n){if(!(t instanceof e))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return t}},function(t,e,n){var r=n(6),i=n(59),o=r("iterator"),s=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||s[o]===t)}},function(t,e,n){var r=n(73),i=n(59),o=n(6)("iterator");t.exports=function(t){if(null!=t)return t[o]||t["@@iterator"]||i[r(t)]}},function(t,e,n){var r=n(6)("iterator"),i=!1;try{var o=0,s={next:function(){return{done:!!o++}},return:function(){i=!0}};s[r]=function(){return this},Array.from(s,(function(){throw 2}))}catch(t){}t.exports=function(t,e){if(!e&&!i)return!1;var n=!1;try{var o={};o[r]=function(){return{next:function(){return{done:n=!0}}}},t(o)}catch(t){}return n}},function(t,e,n){var r=n(40),i=n(2);t.exports="process"==r(i.process)},function(t,e,n){var r,i,o=n(2),s=n(138),a=o.process,u=a&&a.versions,c=u&&u.v8;c?i=(r=c.split("."))[0]+r[1]:s&&(!(r=s.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=s.match(/Chrome\/(\d+)/))&&(i=r[1]),t.exports=i&&+i},function(t,e,n){var r=n(106);t.exports=function(t){if(r(t))throw TypeError("The method doesn't accept regular expressions");return t}},function(t,e,n){var r=n(10),i=n(40),o=n(6)("match");t.exports=function(t){var e;return r(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==i(t))}},function(t,e,n){var r=n(6)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[r]=!1,"/./"[t](e)}catch(t){}}return!1}},function(t,e,n){"use strict";var r=n(17);t.exports=function(){var t=r(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e,n){"use strict";n(22);var r=n(29),i=n(3),o=n(6),s=n(76),a=n(24),u=o("species"),c=!i((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})),l="$0"==="a".replace(/./,"$0"),f=o("replace"),h=!!/./[f]&&""===/./[f]("a","$0"),d=!i((function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));t.exports=function(t,e,n,f){var p=o(t),v=!i((function(){var e={};return e[p]=function(){return 7},7!=""[t](e)})),y=v&&!i((function(){var e=!1,n=/a/;return"split"===t&&((n={}).constructor={},n.constructor[u]=function(){return n},n.flags="",n[p]=/./[p]),n.exec=function(){return e=!0,null},n[p](""),!e}));if(!v||!y||"replace"===t&&(!c||!l||h)||"split"===t&&!d){var g=/./[p],E=n(p,""[t],(function(t,e,n,r,i){return e.exec===s?v&&!i?{done:!0,value:g.call(e,n,r)}:{done:!0,value:t.call(n,e,r)}:{done:!1}}),{REPLACE_KEEPS_$0:l,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:h}),S=E[0],b=E[1];r(String.prototype,t,S),r(RegExp.prototype,p,2==e?function(t,e){return b.call(t,this,e)}:function(t){return b.call(t,this)})}f&&a(RegExp.prototype[p],"sham",!0)}},function(t,e,n){"use strict";var r=n(132).charAt;t.exports=function(t,e,n){return e+(n?r(t,e).length:1)}},function(t,e,n){var r=n(40),i=n(76);t.exports=function(t,e){var n=t.exec;if("function"==typeof n){var o=n.call(t,e);if("object"!=typeof o)throw TypeError("RegExp exec method returned something other than an Object or null");return o}if("RegExp"!==r(t))throw TypeError("RegExp#exec called on incompatible receiver");return i.call(t,e)}},function(t,e,n){var r=n(10),i=n(60);t.exports=function(t,e,n){var o,s;return i&&"function"==typeof(o=e.constructor)&&o!==n&&r(s=o.prototype)&&s!==n.prototype&&i(t,s),t}},function(t,e,n){"use strict";var r=n(109),i=n(17),o=n(8),s=n(31),a=n(110),u=n(111);r("match",1,(function(t,e,n){return[function(e){var n=s(this),r=null==e?void 0:e[t];return void 0!==r?r.call(e,n):new RegExp(e)[t](String(n))},function(t){var r=n(e,t,this);if(r.done)return r.value;var s=i(t),c=String(this);if(!s.global)return u(s,c);var l=s.unicode;s.lastIndex=0;for(var f,h=[],d=0;null!==(f=u(s,c));){var p=String(f[0]);h[d]=p,""===p&&(s.lastIndex=a(c,o(s.lastIndex),l)),d++}return 0===d?null:h}]}))},function(t,e,n){"use strict";var r=n(16),i=n(2),o=n(69),s=n(29),a=n(18),u=n(40),c=n(112),l=n(48),f=n(3),h=n(50),d=n(43).f,p=n(27).f,v=n(20).f,y=n(115).trim,g=i.Number,E=g.prototype,S="Number"==u(h(E)),b=function(t){var e,n,r,i,o,s,a,u,c=l(t,!1);if("string"==typeof c&&c.length>2)if(43===(e=(c=y(c)).charCodeAt(0))||45===e){if(88===(n=c.charCodeAt(2))||120===n)return NaN}else if(48===e){switch(c.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+c}for(s=(o=c.slice(2)).length,a=0;a<s;a++)if((u=o.charCodeAt(a))<48||u>i)return NaN;return parseInt(o,r)}return+c};if(o("Number",!g(" 0o1")||!g("0b1")||g("+0x1"))){for(var m,k=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof k&&(S?f((function(){E.valueOf.call(n)})):"Number"!=u(n))?c(new g(b(e)),n,k):b(e)},A=r?d(g):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),I=0;A.length>I;I++)a(g,m=A[I])&&!a(k,m)&&v(k,m,p(g,m));k.prototype=E,E.constructor=k,s(i,"Number",k)}},function(t,e,n){var r=n(31),i="["+n(116)+"]",o=RegExp("^"+i+i+"*"),s=RegExp(i+i+"*$"),a=function(t){return function(e){var n=String(r(e));return 1&t&&(n=n.replace(o,"")),2&t&&(n=n.replace(s,"")),n}};t.exports={start:a(1),end:a(2),trim:a(3)}},function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){var r=n(16),i=n(3),o=n(88);t.exports=!r&&!i((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},function(t,e,n){var r=n(18),i=n(120),o=n(27),s=n(20);t.exports=function(t,e){for(var n=i(e),a=s.f,u=o.f,c=0;c<n.length;c++){var l=n[c];r(t,l)||a(t,l,u(e,l))}}},function(t,e,n){var r=n(42),i=n(43),o=n(94),s=n(17);t.exports=r("Reflect","ownKeys")||function(t){var e=i.f(s(t)),n=o.f;return n?e.concat(n(t)):e}},function(t,e,n){var r=n(2);t.exports=r},function(t,e,n){var r=n(18),i=n(28),o=n(56).indexOf,s=n(68);t.exports=function(t,e){var n,a=i(t),u=0,c=[];for(n in a)!r(s,n)&&r(a,n)&&c.push(n);for(;e.length>u;)r(a,n=e[u++])&&(~o(c,n)||c.push(n));return c}},function(t,e,n){var r=n(95);t.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(t,e,n){var r=n(42);t.exports=r("document","documentElement")},function(t,e,n){var r=n(28),i=n(43).f,o={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return s&&"[object Window]"==o.call(t)?function(t){try{return i(t)}catch(t){return s.slice()}}(t):i(r(t))}},function(t,e,n){var r=n(6);e.f=r},function(t,e,n){var r=n(121),i=n(18),o=n(126),s=n(20).f;t.exports=function(t){var e=r.Symbol||(r.Symbol={});i(e,t)||s(e,t,{value:o.f(t)})}},function(t,e,n){"use strict";var r=n(1),i=n(163),o=n(51),s=n(60),a=n(57),u=n(24),c=n(29),l=n(6),f=n(41),h=n(59),d=n(129),p=d.IteratorPrototype,v=d.BUGGY_SAFARI_ITERATORS,y=l("iterator"),g=function(){return this};t.exports=function(t,e,n,l,d,E,S){i(n,e,l);var b,m,k,A=function(t){if(t===d&&_)return _;if(!v&&t in R)return R[t];switch(t){case"keys":case"values":case"entries":return function(){return new n(this,t)}}return function(){return new n(this)}},I=e+" Iterator",D=!1,R=t.prototype,T=R[y]||R["@@iterator"]||d&&R[d],_=!v&&T||A(d),N="Array"==e&&R.entries||T;if(N&&(b=o(N.call(new t)),p!==Object.prototype&&b.next&&(f||o(b)===p||(s?s(b,p):"function"!=typeof b[y]&&u(b,y,g)),a(b,I,!0,!0),f&&(h[I]=g))),"values"==d&&T&&"values"!==T.name&&(D=!0,_=function(){return T.call(this)}),f&&!S||R[y]===_||u(R,y,_),h[e]=_,d)if(m={values:A("values"),keys:E?_:A("keys"),entries:A("entries")},S)for(k in m)(v||D||!(k in R))&&c(R,k,m[k]);else r({target:e,proto:!0,forced:v||D},m);return m}},function(t,e,n){"use strict";var r,i,o,s=n(51),a=n(24),u=n(18),c=n(6),l=n(41),f=c("iterator"),h=!1;[].keys&&("next"in(o=[].keys())?(i=s(s(o)))!==Object.prototype&&(r=i):h=!0),null==r&&(r={}),l||u(r,f)||a(r,f,(function(){return this})),t.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:h}},function(t,e,n){var r=n(3);t.exports=!r((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},function(t,e,n){var r=n(1),i=n(165);r({target:"Object",stat:!0,forced:Object.assign!==i},{assign:i})},function(t,e,n){var r=n(32),i=n(31),o=function(t){return function(e,n){var o,s,a=String(i(e)),u=r(n),c=a.length;return u<0||u>=c?t?"":void 0:(o=a.charCodeAt(u))<55296||o>56319||u+1===c||(s=a.charCodeAt(u+1))<56320||s>57343?t?a.charAt(u):o:t?a.slice(u,u+2):s-56320+(o-55296<<10)+65536}};t.exports={codeAt:o(!1),charAt:o(!0)}},function(t,e){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(t,e,n){var r=n(29);t.exports=function(t,e,n){for(var i in e)r(t,i,e[i],n);return t}},function(t,e,n){var r=n(17);t.exports=function(t){var e=t.return;if(void 0!==e)return r(e.call(t)).value}},function(t,e,n){var r,i,o,s=n(2),a=n(3),u=n(58),c=n(124),l=n(88),f=n(137),h=n(103),d=s.location,p=s.setImmediate,v=s.clearImmediate,y=s.process,g=s.MessageChannel,E=s.Dispatch,S=0,b={},m=function(t){if(b.hasOwnProperty(t)){var e=b[t];delete b[t],e()}},k=function(t){return function(){m(t)}},A=function(t){m(t.data)},I=function(t){s.postMessage(t+"",d.protocol+"//"+d.host)};p&&v||(p=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return b[++S]=function(){("function"==typeof t?t:Function(t)).apply(void 0,e)},r(S),S},v=function(t){delete b[t]},h?r=function(t){y.nextTick(k(t))}:E&&E.now?r=function(t){E.now(k(t))}:g&&!f?(o=(i=new g).port2,i.port1.onmessage=A,r=u(o.postMessage,o,1)):s.addEventListener&&"function"==typeof postMessage&&!s.importScripts&&d&&"file:"!==d.protocol&&!a(I)?(r=I,s.addEventListener("message",A,!1)):r="onreadystatechange"in l("script")?function(t){c.appendChild(l("script")).onreadystatechange=function(){c.removeChild(this),m(t)}}:function(t){setTimeout(k(t),0)}),t.exports={set:p,clear:v}},function(t,e,n){var r=n(138);t.exports=/(iphone|ipod|ipad).*applewebkit/i.test(r)},function(t,e,n){var r=n(42);t.exports=r("navigator","userAgent")||""},function(t,e,n){"use strict";var r=n(44),i=function(t){var e,n;this.promise=new t((function(t,r){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=r})),this.resolve=r(e),this.reject=r(n)};t.exports.f=function(t){return new i(t)}},function(t,e,n){"use strict";var r,i=n(1),o=n(27).f,s=n(8),a=n(105),u=n(31),c=n(107),l=n(41),f="".endsWith,h=Math.min,d=c("endsWith");i({target:"String",proto:!0,forced:!(!l&&!d&&(r=o(String.prototype,"endsWith"),r&&!r.writable)||d)},{endsWith:function(t){var e=String(u(this));a(t);var n=arguments.length>1?arguments[1]:void 0,r=s(e.length),i=void 0===n?r:h(s(n),r),o=String(t);return f?f.call(e,o,i):e.slice(i-o.length,i)===o}})},function(t,e,n){"use strict";var r=n(3);function i(t,e){return RegExp(t,e)}e.UNSUPPORTED_Y=r((function(){var t=i("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),e.BROKEN_CARET=r((function(){var t=i("^r","gy");return t.lastIndex=2,null!=t.exec("str")}))},function(t,e,n){"use strict";var r=n(25).forEach,i=n(75),o=n(33),s=i("forEach"),a=o("forEach");t.exports=s&&a?[].forEach:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}},function(t,e,n){"use strict";var r,i=n(1),o=n(27).f,s=n(8),a=n(105),u=n(31),c=n(107),l=n(41),f="".startsWith,h=Math.min,d=c("startsWith");i({target:"String",proto:!0,forced:!(!l&&!d&&(r=o(String.prototype,"startsWith"),r&&!r.writable)||d)},{startsWith:function(t){var e=String(u(this));a(t);var n=s(h(arguments.length>1?arguments[1]:void 0,e.length)),r=String(t);return f?f.call(e,r,n):e.slice(n,n+r.length)===r}})},function(t,e,n){"use strict";var r=n(21),i=n(49),o=n(8),s=Math.min;t.exports=[].copyWithin||function(t,e){var n=r(this),a=o(n.length),u=i(t,a),c=i(e,a),l=arguments.length>2?arguments[2]:void 0,f=s((void 0===l?a:i(l,a))-c,a-u),h=1;for(c<u&&u<c+f&&(h=-1,c+=f-1,u+=f-1);f-- >0;)c in n?n[u]=n[c]:delete n[u],u+=h,c+=h;return n}},function(t,e){t.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},function(t,e,n){var r=n(32),i=n(8);t.exports=function(t){if(void 0===t)return 0;var e=r(t),n=i(e);if(e!==n)throw RangeError("Wrong length or index");return n}},function(t,e,n){"use strict";var r=n(21),i=n(49),o=n(8);t.exports=function(t){for(var e=r(this),n=o(e.length),s=arguments.length,a=i(s>1?arguments[1]:void 0,n),u=s>2?arguments[2]:void 0,c=void 0===u?n:i(u,n);c>a;)e[a++]=t;return e}},function(t,e,n){var r=n(180);t.exports=function(t,e){var n=r(t);if(n%e)throw RangeError("Wrong offset");return n}},function(t,e,n){var r=n(44),i=n(21),o=n(55),s=n(8),a=function(t){return function(e,n,a,u){r(n);var c=i(e),l=o(c),f=s(c.length),h=t?f-1:0,d=t?-1:1;if(a<2)for(;;){if(h in l){u=l[h],h+=d;break}if(h+=d,t?h<0:f<=h)throw TypeError("Reduce of empty array with no initial value")}for(;t?h>=0:f>h;h+=d)h in l&&(u=n(u,l[h],h,c));return u}};t.exports={left:a(!1),right:a(!0)}},function(t,e,n){"use strict";var r=n(1),i=n(115).trim;r({target:"String",proto:!0,forced:n(206)("trim")},{trim:function(){return i(this)}})},function(t,e,n){var r=n(1),i=n(210);r({target:"Array",stat:!0,forced:!n(102)((function(t){Array.from(t)}))},{from:i})},function(t,e,n){"use strict";var r=n(1),i=n(25).filter,o=n(64),s=n(33),a=o("filter"),u=s("filter");r({target:"Array",proto:!0,forced:!a||!u},{filter:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,n){!function(t){var e={"&amp;":"&","&lt;":"<","&gt;":">","&apos;":"'","&quot;":'"'};function n(t){return t&&t.replace(/^\s+|\s+$/g,"")}function r(t){return t.replace(/(&(?:lt|gt|amp|apos|quot|#(?:\d{1,6}|x[0-9a-fA-F]{1,5}));)/g,(function(t){if("#"===t[1]){var n="x"===t[2]?parseInt(t.substr(3),16):parseInt(t.substr(2),10);if(n>-1)return String.fromCharCode(n)}return e[t]||t}))}function i(t,e,n){if(void 0!==n){var r=t[e];r instanceof Array?r.push(n):t[e]=e in t?[r,n]:n}}t.fromXML=function(t,e){return function t(e,o){if("string"==typeof e)return e;var s=e.r;if(s)return s;var a,u=function(t,e){if(t.t){for(var o,s,a=t.t.split(/([^\s='"]+(?:\s*=\s*(?:'[\S\s]*?'|"[\S\s]*?"|[^\s'"]*))?)/),u=a.length,c=0;c<u;c++){var l=n(a[c]);if(l){o||(o={});var f=l.indexOf("=");if(f<0)l="@"+l,s=null;else{s=l.substr(f+1).replace(/^\s+/,""),l="@"+l.substr(0,f).replace(/\s+$/,"");var h=s[0];h!==s[s.length-1]||"'"!==h&&'"'!==h||(s=s.substr(1,s.length-2)),s=r(s)}e&&(s=e(l,s)),i(o,l,s)}}return o}}(e,o),c=e.f,l=c.length;if(u||l>1)a=u||{},c.forEach((function(e){"string"==typeof e?i(a,"#",e):i(a,e.n,t(e,o))}));else if(l){var f=c[0];if(a=t(f,o),f.n){var h={};h[f.n]=a,a=h}}else a=e.c?null:"";return o&&(a=o(e.n||"",a)),a}(function(t){for(var e=String.prototype.split.call(t,/<([^!<>?](?:'[\S\s]*?'|"[\S\s]*?"|[^'"<>])*|!(?:--[\S\s]*?--|\[[^\[\]'"<>]+\[[\S\s]*?]]|DOCTYPE[^\[<>]*?\[[\S\s]*?]|(?:ENTITY[^"<>]*?"[\S\s]*?")?[\S\s]*?)|\?[\S\s]*?\?)>/),i=e.length,o={f:[]},s=o,a=[],u=0;u<i;){var c=e[u++];c&&d(c);var l=e[u++];l&&f(l)}return o;function f(t){var e=t.length,n=t[0];if("/"===n)for(var r=t.replace(/^\/|[\s\/].*$/g,"").toLowerCase();a.length;){var i=s.n&&s.n.toLowerCase();if(s=a.pop(),i===r)break}else if("?"===n)h({n:"?",r:t.substr(1,e-2)});else if("!"===n)"[CDATA["===t.substr(1,7)&&"]]"===t.substr(-2)?d(t.substr(8,e-10)):h({n:"!",r:t.substr(1)});else{var o=function(t){var e={f:[]},n=(t=t.replace(/\s*\/?$/,"")).search(/[\s='"\/]/);return n<0?e.n=t:(e.n=t.substr(0,n),e.t=t.substr(n)),e}(t);h(o),"/"===t[e-1]?o.c=1:(a.push(s),s=o)}}function h(t){s.f.push(t)}function d(t){(t=n(t))&&h(r(t))}}(t),e)}}(e||{})},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(0);function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,(n=[{key:"log",value:function(t,e,n){var i=r.c.formatDate();switch(t){case 0:console.log(i+" V/"+e+": "+n);break;case 1:console.log(i+" D/"+e+": "+n);break;case 2:console.log(i+" I/"+e+": "+n);break;case 3:console.log(i+" W/"+e+": "+n);break;case 4:console.log(i+" E/"+e+": "+n);break;default:console.log(i+" ?/"+e+": "+n)}}}])&&i(e.prototype,n),t}()},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n.d(e,"a",(function(){return o})),n(9),n(11),n(12),n(36),n(7),n(74),n(4),n(22),n(13),n(34),n(150),n(38),n(14);var o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,(n=[{key:"get",value:function(t,e,n,r){var i=new XMLHttpRequest,o=!1,s={};for(var a in i.onreadystatechange=function(){i.readyState===i.DONE&&(i.getAllResponseHeaders().trim().split(/[\r\n]+/).forEach((function(t){var e=t.split(": "),n=e.shift().toLowerCase();s[n]=e.join(": ")})),i.status>=200&&i.status<300?r({body:i.responseText,headers:s,statusCode:i.status}):0!==i.status&&r({body:"",headers:s,statusCode:i.status}))},i.onerror=function(){o||r({body:"",headers:s,statusCode:i.status})},i.ontimeout=function(){r({body:"",headers:s,statusCode:i.status})},i.open("GET",t,!0),i.timeout=n,this.deleteUnsafeHeaders(e),e)i.setRequestHeader(a,e[a]);i.send(),setTimeout((function(){i.readyState!==i.DONE&&(o=!0,i.abort(),r({body:"",headers:s,statusCode:i.status}))}),n+100)}},{key:"post",value:function(t,e,n,r,i){var o=new XMLHttpRequest,s=!1,a={};for(var u in o.onreadystatechange=function(){o.readyState===o.DONE&&(o.getAllResponseHeaders().trim().split(/[\r\n]+/).forEach((function(t){var e=t.split(": "),n=e.shift().toLowerCase();a[n]=e.join(": ")})),o.status>=200&&o.status<300?i({body:o.responseText,headers:a,statusCode:o.status}):0!==o.status&&i({body:"",headers:a,statusCode:o.status}))},o.onerror=function(){s||i({body:"",headers:a,statusCode:o.status})},o.ontimeout=function(){i({body:"",headers:a,statusCode:o.status})},o.open("POST",t,!0),o.timeout=r,this.deleteUnsafeHeaders(e),e)o.setRequestHeader(u,e[u]);o.send(n),setTimeout((function(){o.readyState!==o.DONE&&(s=!0,o.abort(),i({body:"",headers:a,statusCode:o.status}))}),r+100)}},{key:"deleteUnsafeHeaders",value:function(t){"object"!==("undefined"==typeof window?"undefined":r(window))&&"function"!=typeof XMLHttpRequest||(delete t["User-Agent"],delete t["Accept-Charset"],delete t["Accept-Encoding"],delete t["Access-Control-Request-Headers"],delete t["Access-Control-Request-Method"],delete t.Connection,delete t["Content-Length"],delete t.Cookie,delete t.Cookie2,delete t.Date,delete t.DNT,delete t.Expect,delete t.Host,delete t["Keep-Alive"],delete t.Origin,delete t.Referer,delete t.TE,delete t.Trailer,delete t["Transfer-Encoding"],delete t.Upgrade,delete t.Via)}}])&&i(e.prototype,n),t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return v}));var r=n(0),i=n(79),o=n(80),s=n(81),a=n(82),u=n(83),c=n(84),l=n(85);function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var d=0,p="__private_"+d+++"_adapters",v=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Object.defineProperty(this,p,{writable:!0,value:void 0})}var e,n;return e=t,(n=[{key:"loadPlayerAdapters",value:function(){return h(this,p)[p]={},h(this,p)[p].generic=r.d,h(this,p)[p].shaka=i.a,h(this,p)[p].dashjs=o.a,h(this,p)[p].html5=s.a,h(this,p)[p].avplay=a.a,h(this,p)[p].diw387=u.a,h(this,p)[p].hbbtv1=c.a,h(this,p)[p].kaltura=l.a,h(this,p)[p]}},{key:"attachPlayer",value:function(t,e){for(var n in h(this,p)[p])if(h(this,p)[p][n].checkPlayer(t,e)){var r=new(h(this,p)[p][n]);return r.attachPlayer(t,e),r}}}])&&f(e.prototype,n),t}()},function(t,e,n){"use strict";e.a="3317"},function(module,exports){module.exports=function(lib){return eval("require")(lib)}},function(t,e,n){n(160),t.exports=n(218)},function(t,e,n){"use strict";n.r(e),n(86).a.getInstance().init()},function(t,e,n){var r=n(2),i=n(90),o=r.WeakMap;t.exports="function"==typeof o&&/native code/.test(i(o))},function(t,e,n){var r=n(16),i=n(20),o=n(17),s=n(71);t.exports=r?Object.defineProperties:function(t,e){o(t);for(var n,r=s(e),a=r.length,u=0;a>u;)i.f(t,n=r[u++],e[n]);return t}},function(t,e,n){"use strict";var r=n(129).IteratorPrototype,i=n(50),o=n(47),s=n(57),a=n(59),u=function(){return this};t.exports=function(t,e,n){var c=e+" Iterator";return t.prototype=i(r,{next:o(1,n)}),s(t,c,!1,!0),a[c]=u,t}},function(t,e,n){var r=n(10);t.exports=function(t){if(!r(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype");return t}},function(t,e,n){"use strict";var r=n(16),i=n(3),o=n(71),s=n(94),a=n(87),u=n(21),c=n(55),l=Object.assign,f=Object.defineProperty;t.exports=!l||i((function(){if(r&&1!==l({b:1},l(f({},"a",{enumerable:!0,get:function(){f(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},n=Symbol();return t[n]=7,"abcdefghijklmnopqrst".split("").forEach((function(t){e[t]=t})),7!=l({},t)[n]||"abcdefghijklmnopqrst"!=o(l({},e)).join("")}))?function(t,e){for(var n=u(t),i=arguments.length,l=1,f=s.f,h=a.f;i>l;)for(var d,p=c(arguments[l++]),v=f?o(p).concat(f(p)):o(p),y=v.length,g=0;y>g;)d=v[g++],r&&!h.call(p,d)||(n[d]=p[d]);return n}:l},function(t,e,n){"use strict";var r=n(97),i=n(73);t.exports=r?{}.toString:function(){return"[object "+i(this)+"]"}},function(t,e,n){var r=n(2);t.exports=r.Promise},function(t,e,n){var r=n(17),i=n(100),o=n(8),s=n(58),a=n(101),u=n(135),c=function(t,e){this.stopped=t,this.result=e};t.exports=function(t,e,n){var l,f,h,d,p,v,y,g=n&&n.that,E=!(!n||!n.AS_ENTRIES),S=!(!n||!n.IS_ITERATOR),b=!(!n||!n.INTERRUPTED),m=s(e,g,1+E+b),k=function(t){return l&&u(l),new c(!0,t)},A=function(t){return E?(r(t),b?m(t[0],t[1],k):m(t[0],t[1])):b?m(t,k):m(t)};if(S)l=t;else{if("function"!=typeof(f=a(t)))throw TypeError("Target is not iterable");if(i(f)){for(h=0,d=o(t.length);d>h;h++)if((p=A(t[h]))&&p instanceof c)return p;return new c(!1)}l=f.call(t)}for(v=l.next;!(y=v.call(l)).done;){try{p=A(y.value)}catch(t){throw u(l),t}if("object"==typeof p&&p&&p instanceof c)return p}return new c(!1)}},function(t,e,n){var r,i,o,s,a,u,c,l,f=n(2),h=n(27).f,d=n(136).set,p=n(137),v=n(103),y=f.MutationObserver||f.WebKitMutationObserver,g=f.document,E=f.process,S=f.Promise,b=h(f,"queueMicrotask"),m=b&&b.value;m||(r=function(){var t,e;for(v&&(t=E.domain)&&t.exit();i;){e=i.fn,i=i.next;try{e()}catch(t){throw i?s():o=void 0,t}}o=void 0,t&&t.enter()},!p&&!v&&y&&g?(a=!0,u=g.createTextNode(""),new y(r).observe(u,{characterData:!0}),s=function(){u.data=a=!a}):S&&S.resolve?(c=S.resolve(void 0),l=c.then,s=function(){l.call(c,r)}):s=v?function(){E.nextTick(r)}:function(){d.call(f,r)}),t.exports=m||function(t){var e={fn:t,next:void 0};o&&(o.next=e),i||(i=e,s()),o=e}},function(t,e,n){var r=n(17),i=n(10),o=n(139);t.exports=function(t,e){if(r(t),i(e)&&e.constructor===t)return e;var n=o.f(t);return(0,n.resolve)(e),n.promise}},function(t,e,n){var r=n(2);t.exports=function(t,e){var n=r.console;n&&n.error&&(1===arguments.length?n.error(t):n.error(t,e))}},function(t,e){t.exports=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}}},function(t,e,n){var r=n(16),i=n(2),o=n(69),s=n(112),a=n(20).f,u=n(43).f,c=n(106),l=n(108),f=n(141),h=n(29),d=n(3),p=n(35).set,v=n(98),y=n(6)("match"),g=i.RegExp,E=g.prototype,S=/a/g,b=/a/g,m=new g(S)!==S,k=f.UNSUPPORTED_Y;if(r&&o("RegExp",!m||k||d((function(){return b[y]=!1,g(S)!=S||g(b)==b||"/a/i"!=g(S,"i")})))){for(var A=function(t,e){var n,r=this instanceof A,i=c(t),o=void 0===e;if(!r&&i&&t.constructor===A&&o)return t;m?i&&!o&&(t=t.source):t instanceof A&&(o&&(e=l.call(t)),t=t.source),k&&(n=!!e&&e.indexOf("y")>-1)&&(e=e.replace(/y/g,""));var a=s(m?new g(t,e):g(t,e),r?this:E,A);return k&&n&&p(a,{sticky:n}),a},I=function(t){t in A||a(A,t,{configurable:!0,get:function(){return g[t]},set:function(e){g[t]=e}})},D=u(g),R=0;D.length>R;)I(D[R++]);E.constructor=A,A.prototype=E,h(i,"RegExp",A)}v("RegExp")},function(t,e,n){var r=n(1),i=n(144),o=n(72);r({target:"Array",proto:!0},{copyWithin:i}),o("copyWithin")},function(t,e,n){n(176)("Uint8",(function(t){return function(e,n,r){return t(this,e,n,r)}}))},function(t,e,n){"use strict";var r=n(1),i=n(2),o=n(16),s=n(177),a=n(5),u=n(178),c=n(99),l=n(47),f=n(24),h=n(8),d=n(146),p=n(148),v=n(48),y=n(18),g=n(73),E=n(10),S=n(50),b=n(60),m=n(43).f,k=n(181),A=n(25).forEach,I=n(98),D=n(20),R=n(27),T=n(35),_=n(112),N=T.get,L=T.set,O=D.f,P=R.f,w=Math.round,C=i.RangeError,M=u.ArrayBuffer,B=u.DataView,x=a.NATIVE_ARRAY_BUFFER_VIEWS,U=a.TYPED_ARRAY_TAG,j=a.TypedArray,F=a.TypedArrayPrototype,G=a.aTypedArrayConstructor,H=a.isTypedArray,V=function(t,e){for(var n=0,r=e.length,i=new(G(t))(r);r>n;)i[n]=e[n++];return i},Y=function(t,e){O(t,e,{get:function(){return N(this)[e]}})},W=function(t){var e;return t instanceof M||"ArrayBuffer"==(e=g(t))||"SharedArrayBuffer"==e},q=function(t,e){return H(t)&&"symbol"!=typeof e&&e in t&&String(+e)==String(e)},K=function(t,e){return q(t,e=v(e,!0))?l(2,t[e]):P(t,e)},Q=function(t,e,n){return!(q(t,e=v(e,!0))&&E(n)&&y(n,"value"))||y(n,"get")||y(n,"set")||n.configurable||y(n,"writable")&&!n.writable||y(n,"enumerable")&&!n.enumerable?O(t,e,n):(t[e]=n.value,t)};o?(x||(R.f=K,D.f=Q,Y(F,"buffer"),Y(F,"byteOffset"),Y(F,"byteLength"),Y(F,"length")),r({target:"Object",stat:!0,forced:!x},{getOwnPropertyDescriptor:K,defineProperty:Q}),t.exports=function(t,e,n){var o=t.match(/\d+$/)[0]/8,a=t+(n?"Clamped":"")+"Array",u="get"+t,l="set"+t,v=i[a],y=v,g=y&&y.prototype,D={},R=function(t,e){O(t,e,{get:function(){return function(t,e){var n=N(t);return n.view[u](e*o+n.byteOffset,!0)}(this,e)},set:function(t){return function(t,e,r){var i=N(t);n&&(r=(r=w(r))<0?0:r>255?255:255&r),i.view[l](e*o+i.byteOffset,r,!0)}(this,e,t)},enumerable:!0})};x?s&&(y=e((function(t,e,n,r){return c(t,y,a),_(E(e)?W(e)?void 0!==r?new v(e,p(n,o),r):void 0!==n?new v(e,p(n,o)):new v(e):H(e)?V(y,e):k.call(y,e):new v(d(e)),t,y)})),b&&b(y,j),A(m(v),(function(t){t in y||f(y,t,v[t])})),y.prototype=g):(y=e((function(t,e,n,r){c(t,y,a);var i,s,u,l=0,f=0;if(E(e)){if(!W(e))return H(e)?V(y,e):k.call(y,e);i=e,f=p(n,o);var v=e.byteLength;if(void 0===r){if(v%o)throw C("Wrong length");if((s=v-f)<0)throw C("Wrong length")}else if((s=h(r)*o)+f>v)throw C("Wrong length");u=s/o}else u=d(e),i=new M(s=u*o);for(L(t,{buffer:i,byteOffset:f,byteLength:s,length:u,view:new B(i)});l<u;)R(t,l++)})),b&&b(y,j),g=y.prototype=S(F)),g.constructor!==y&&f(g,"constructor",y),U&&f(g,U,a),D[a]=y,r({global:!0,forced:y!=v,sham:!x},D),"BYTES_PER_ELEMENT"in y||f(y,"BYTES_PER_ELEMENT",o),"BYTES_PER_ELEMENT"in g||f(g,"BYTES_PER_ELEMENT",o),I(a)}):t.exports=function(){}},function(t,e,n){var r=n(2),i=n(3),o=n(102),s=n(5).NATIVE_ARRAY_BUFFER_VIEWS,a=r.ArrayBuffer,u=r.Int8Array;t.exports=!s||!i((function(){u(1)}))||!i((function(){new u(-1)}))||!o((function(t){new u,new u(null),new u(1.5),new u(t)}),!0)||i((function(){return 1!==new u(new a(2),1,void 0).length}))},function(t,e,n){"use strict";var r=n(2),i=n(16),o=n(145),s=n(24),a=n(134),u=n(3),c=n(99),l=n(32),f=n(8),h=n(146),d=n(179),p=n(51),v=n(60),y=n(43).f,g=n(20).f,E=n(147),S=n(57),b=n(35),m=b.get,k=b.set,A=r.ArrayBuffer,I=A,D=r.DataView,R=D&&D.prototype,T=Object.prototype,_=r.RangeError,N=d.pack,L=d.unpack,O=function(t){return[255&t]},P=function(t){return[255&t,t>>8&255]},w=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},C=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},M=function(t){return N(t,23,4)},B=function(t){return N(t,52,8)},x=function(t,e){g(t.prototype,e,{get:function(){return m(this)[e]}})},U=function(t,e,n,r){var i=h(n),o=m(t);if(i+e>o.byteLength)throw _("Wrong index");var s=m(o.buffer).bytes,a=i+o.byteOffset,u=s.slice(a,a+e);return r?u:u.reverse()},j=function(t,e,n,r,i,o){var s=h(n),a=m(t);if(s+e>a.byteLength)throw _("Wrong index");for(var u=m(a.buffer).bytes,c=s+a.byteOffset,l=r(+i),f=0;f<e;f++)u[c+f]=l[o?f:e-f-1]};if(o){if(!u((function(){A(1)}))||!u((function(){new A(-1)}))||u((function(){return new A,new A(1.5),new A(NaN),"ArrayBuffer"!=A.name}))){for(var F,G=(I=function(t){return c(this,I),new A(h(t))}).prototype=A.prototype,H=y(A),V=0;H.length>V;)(F=H[V++])in I||s(I,F,A[F]);G.constructor=I}v&&p(R)!==T&&v(R,T);var Y=new D(new I(2)),W=R.setInt8;Y.setInt8(0,2147483648),Y.setInt8(1,2147483649),!Y.getInt8(0)&&Y.getInt8(1)||a(R,{setInt8:function(t,e){W.call(this,t,e<<24>>24)},setUint8:function(t,e){W.call(this,t,e<<24>>24)}},{unsafe:!0})}else I=function(t){c(this,I,"ArrayBuffer");var e=h(t);k(this,{bytes:E.call(new Array(e),0),byteLength:e}),i||(this.byteLength=e)},D=function(t,e,n){c(this,D,"DataView"),c(t,I,"DataView");var r=m(t).byteLength,o=l(e);if(o<0||o>r)throw _("Wrong offset");if(o+(n=void 0===n?r-o:f(n))>r)throw _("Wrong length");k(this,{buffer:t,byteLength:n,byteOffset:o}),i||(this.buffer=t,this.byteLength=n,this.byteOffset=o)},i&&(x(I,"byteLength"),x(D,"buffer"),x(D,"byteLength"),x(D,"byteOffset")),a(D.prototype,{getInt8:function(t){return U(this,1,t)[0]<<24>>24},getUint8:function(t){return U(this,1,t)[0]},getInt16:function(t){var e=U(this,2,t,arguments.length>1?arguments[1]:void 0);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=U(this,2,t,arguments.length>1?arguments[1]:void 0);return e[1]<<8|e[0]},getInt32:function(t){return C(U(this,4,t,arguments.length>1?arguments[1]:void 0))},getUint32:function(t){return C(U(this,4,t,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(t){return L(U(this,4,t,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(t){return L(U(this,8,t,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(t,e){j(this,1,t,O,e)},setUint8:function(t,e){j(this,1,t,O,e)},setInt16:function(t,e){j(this,2,t,P,e,arguments.length>2?arguments[2]:void 0)},setUint16:function(t,e){j(this,2,t,P,e,arguments.length>2?arguments[2]:void 0)},setInt32:function(t,e){j(this,4,t,w,e,arguments.length>2?arguments[2]:void 0)},setUint32:function(t,e){j(this,4,t,w,e,arguments.length>2?arguments[2]:void 0)},setFloat32:function(t,e){j(this,4,t,M,e,arguments.length>2?arguments[2]:void 0)},setFloat64:function(t,e){j(this,8,t,B,e,arguments.length>2?arguments[2]:void 0)}});S(I,"ArrayBuffer"),S(D,"DataView"),t.exports={ArrayBuffer:I,DataView:D}},function(t,e){var n=Math.abs,r=Math.pow,i=Math.floor,o=Math.log,s=Math.LN2;t.exports={pack:function(t,e,a){var u,c,l,f=new Array(a),h=8*a-e-1,d=(1<<h)-1,p=d>>1,v=23===e?r(2,-24)-r(2,-77):0,y=t<0||0===t&&1/t<0?1:0,g=0;for((t=n(t))!=t||t===1/0?(c=t!=t?1:0,u=d):(u=i(o(t)/s),t*(l=r(2,-u))<1&&(u--,l*=2),(t+=u+p>=1?v/l:v*r(2,1-p))*l>=2&&(u++,l/=2),u+p>=d?(c=0,u=d):u+p>=1?(c=(t*l-1)*r(2,e),u+=p):(c=t*r(2,p-1)*r(2,e),u=0));e>=8;f[g++]=255&c,c/=256,e-=8);for(u=u<<e|c,h+=e;h>0;f[g++]=255&u,u/=256,h-=8);return f[--g]|=128*y,f},unpack:function(t,e){var n,i=t.length,o=8*i-e-1,s=(1<<o)-1,a=s>>1,u=o-7,c=i-1,l=t[c--],f=127&l;for(l>>=7;u>0;f=256*f+t[c],c--,u-=8);for(n=f&(1<<-u)-1,f>>=-u,u+=e;u>0;n=256*n+t[c],c--,u-=8);if(0===f)f=1-a;else{if(f===s)return n?NaN:l?-1/0:1/0;n+=r(2,e),f-=a}return(l?-1:1)*n*r(2,f-e)}}},function(t,e,n){var r=n(32);t.exports=function(t){var e=r(t);if(e<0)throw RangeError("The argument can't be less than 0");return e}},function(t,e,n){var r=n(21),i=n(8),o=n(101),s=n(100),a=n(58),u=n(5).aTypedArrayConstructor;t.exports=function(t){var e,n,c,l,f,h,d=r(t),p=arguments.length,v=p>1?arguments[1]:void 0,y=void 0!==v,g=o(d);if(null!=g&&!s(g))for(h=(f=g.call(d)).next,d=[];!(l=h.call(f)).done;)d.push(l.value);for(y&&p>2&&(v=a(v,arguments[2],2)),n=i(d.length),c=new(u(this))(n),e=0;n>e;e++)c[e]=y?v(d[e],e):d[e];return c}},function(t,e,n){"use strict";var r=n(5),i=n(144),o=r.aTypedArray;(0,r.exportTypedArrayMethod)("copyWithin",(function(t,e){return i.call(o(this),t,e,arguments.length>2?arguments[2]:void 0)}))},function(t,e,n){"use strict";var r=n(5),i=n(25).every,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("every",(function(t){return i(o(this),t,arguments.length>1?arguments[1]:void 0)}))},function(t,e,n){"use strict";var r=n(5),i=n(147),o=r.aTypedArray;(0,r.exportTypedArrayMethod)("fill",(function(t){return i.apply(o(this),arguments)}))},function(t,e,n){"use strict";var r=n(5),i=n(25).filter,o=n(52),s=r.aTypedArray,a=r.aTypedArrayConstructor;(0,r.exportTypedArrayMethod)("filter",(function(t){for(var e=i(s(this),t,arguments.length>1?arguments[1]:void 0),n=o(this,this.constructor),r=0,u=e.length,c=new(a(n))(u);u>r;)c[r]=e[r++];return c}))},function(t,e,n){"use strict";var r=n(5),i=n(25).find,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("find",(function(t){return i(o(this),t,arguments.length>1?arguments[1]:void 0)}))},function(t,e,n){"use strict";var r=n(5),i=n(25).findIndex,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("findIndex",(function(t){return i(o(this),t,arguments.length>1?arguments[1]:void 0)}))},function(t,e,n){"use strict";var r=n(5),i=n(25).forEach,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("forEach",(function(t){i(o(this),t,arguments.length>1?arguments[1]:void 0)}))},function(t,e,n){"use strict";var r=n(5),i=n(56).includes,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("includes",(function(t){return i(o(this),t,arguments.length>1?arguments[1]:void 0)}))},function(t,e,n){"use strict";var r=n(5),i=n(56).indexOf,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("indexOf",(function(t){return i(o(this),t,arguments.length>1?arguments[1]:void 0)}))},function(t,e,n){"use strict";var r=n(2),i=n(5),o=n(7),s=n(6)("iterator"),a=r.Uint8Array,u=o.values,c=o.keys,l=o.entries,f=i.aTypedArray,h=i.exportTypedArrayMethod,d=a&&a.prototype[s],p=!!d&&("values"==d.name||null==d.name),v=function(){return u.call(f(this))};h("entries",(function(){return l.call(f(this))})),h("keys",(function(){return c.call(f(this))})),h("values",v,!p),h(s,v,!p)},function(t,e,n){"use strict";var r=n(5),i=r.aTypedArray,o=r.exportTypedArrayMethod,s=[].join;o("join",(function(t){return s.apply(i(this),arguments)}))},function(t,e,n){"use strict";var r=n(5),i=n(194),o=r.aTypedArray;(0,r.exportTypedArrayMethod)("lastIndexOf",(function(t){return i.apply(o(this),arguments)}))},function(t,e,n){"use strict";var r=n(28),i=n(32),o=n(8),s=n(75),a=n(33),u=Math.min,c=[].lastIndexOf,l=!!c&&1/[1].lastIndexOf(1,-0)<0,f=s("lastIndexOf"),h=a("indexOf",{ACCESSORS:!0,1:0}),d=l||!f||!h;t.exports=d?function(t){if(l)return c.apply(this,arguments)||0;var e=r(this),n=o(e.length),s=n-1;for(arguments.length>1&&(s=u(s,i(arguments[1]))),s<0&&(s=n+s);s>=0;s--)if(s in e&&e[s]===t)return s||0;return-1}:c},function(t,e,n){"use strict";var r=n(5),i=n(25).map,o=n(52),s=r.aTypedArray,a=r.aTypedArrayConstructor;(0,r.exportTypedArrayMethod)("map",(function(t){return i(s(this),t,arguments.length>1?arguments[1]:void 0,(function(t,e){return new(a(o(t,t.constructor)))(e)}))}))},function(t,e,n){"use strict";var r=n(5),i=n(149).left,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("reduce",(function(t){return i(o(this),t,arguments.length,arguments.length>1?arguments[1]:void 0)}))},function(t,e,n){"use strict";var r=n(5),i=n(149).right,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("reduceRight",(function(t){return i(o(this),t,arguments.length,arguments.length>1?arguments[1]:void 0)}))},function(t,e,n){"use strict";var r=n(5),i=r.aTypedArray,o=r.exportTypedArrayMethod,s=Math.floor;o("reverse",(function(){for(var t,e=i(this).length,n=s(e/2),r=0;r<n;)t=this[r],this[r++]=this[--e],this[e]=t;return this}))},function(t,e,n){"use strict";var r=n(5),i=n(8),o=n(148),s=n(21),a=n(3),u=r.aTypedArray;(0,r.exportTypedArrayMethod)("set",(function(t){u(this);var e=o(arguments.length>1?arguments[1]:void 0,1),n=this.length,r=s(t),a=i(r.length),c=0;if(a+e>n)throw RangeError("Wrong length");for(;c<a;)this[e+c]=r[c++]}),a((function(){new Int8Array(1).set({})})))},function(t,e,n){"use strict";var r=n(5),i=n(52),o=n(3),s=r.aTypedArray,a=r.aTypedArrayConstructor,u=r.exportTypedArrayMethod,c=[].slice;u("slice",(function(t,e){for(var n=c.call(s(this),t,e),r=i(this,this.constructor),o=0,u=n.length,l=new(a(r))(u);u>o;)l[o]=n[o++];return l}),o((function(){new Int8Array(1).slice()})))},function(t,e,n){"use strict";var r=n(5),i=n(25).some,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("some",(function(t){return i(o(this),t,arguments.length>1?arguments[1]:void 0)}))},function(t,e,n){"use strict";var r=n(5),i=r.aTypedArray,o=r.exportTypedArrayMethod,s=[].sort;o("sort",(function(t){return s.call(i(this),t)}))},function(t,e,n){"use strict";var r=n(5),i=n(8),o=n(49),s=n(52),a=r.aTypedArray;(0,r.exportTypedArrayMethod)("subarray",(function(t,e){var n=a(this),r=n.length,u=o(t,r);return new(s(n,n.constructor))(n.buffer,n.byteOffset+u*n.BYTES_PER_ELEMENT,i((void 0===e?r:o(e,r))-u))}))},function(t,e,n){"use strict";var r=n(2),i=n(5),o=n(3),s=r.Int8Array,a=i.aTypedArray,u=i.exportTypedArrayMethod,c=[].toLocaleString,l=[].slice,f=!!s&&o((function(){c.call(new s(1))}));u("toLocaleString",(function(){return c.apply(f?l.call(a(this)):a(this),arguments)}),o((function(){return[1,2].toLocaleString()!=new s([1,2]).toLocaleString()}))||!o((function(){s.prototype.toLocaleString.call([1,2])})))},function(t,e,n){"use strict";var r=n(5).exportTypedArrayMethod,i=n(3),o=n(2).Uint8Array,s=o&&o.prototype||{},a=[].toString,u=[].join;i((function(){a.call({})}))&&(a=function(){return u.call(this)});var c=s.toString!=a;r("toString",a,c)},function(t,e,n){var r=n(3),i=n(116);t.exports=function(t){return r((function(){return!!i[t]()||"​᠎"!="​᠎"[t]()||i[t].name!==t}))}},function(t,e,n){"use strict";var r=n(44),i=n(10),o=[].slice,s={},a=function(t,e,n){if(!(e in s)){for(var r=[],i=0;i<e;i++)r[i]="a["+i+"]";s[e]=Function("C,a","return new C("+r.join(",")+")")}return s[e](t,n)};t.exports=Function.bind||function(t){var e=r(this),n=o.call(arguments,1),s=function(){var r=n.concat(o.call(arguments));return this instanceof s?a(e,r.length,r):e.apply(t,r)};return i(e.prototype)&&(s.prototype=e.prototype),s}},function(t,e,n){n(1)({target:"Number",stat:!0},{isInteger:n(209)})},function(t,e,n){var r=n(10),i=Math.floor;t.exports=function(t){return!r(t)&&isFinite(t)&&i(t)===t}},function(t,e,n){"use strict";var r=n(58),i=n(21),o=n(211),s=n(100),a=n(8),u=n(63),c=n(101);t.exports=function(t){var e,n,l,f,h,d,p=i(t),v="function"==typeof this?this:Array,y=arguments.length,g=y>1?arguments[1]:void 0,E=void 0!==g,S=c(p),b=0;if(E&&(g=r(g,y>2?arguments[2]:void 0,2)),null==S||v==Array&&s(S))for(n=new v(e=a(p.length));e>b;b++)d=E?g(p[b],b):p[b],u(n,b,d);else for(h=(f=S.call(p)).next,n=new v;!(l=h.call(f)).done;b++)d=E?o(f,g,[l.value,b],!0):l.value,u(n,b,d);return n.length=b,n}},function(t,e,n){var r=n(17),i=n(135);t.exports=function(t,e,n,o){try{return o?e(r(n)[0],n[1]):e(n)}catch(e){throw i(t),e}}},function(t,e,n){"use strict";var r=n(1),i=n(25).find,o=n(72),s=n(33),a=!0,u=s("find");"find"in[]&&Array(1).find((function(){a=!1})),r({target:"Array",proto:!0,forced:a||!u},{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),o("find")},function(t,e,n){"use strict";var r=n(1),i=n(25).map,o=n(64),s=n(33),a=o("map"),u=s("map");r({target:"Array",proto:!0,forced:!a||!u},{map:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,n){var r=n(1),i=n(16),o=n(120),s=n(28),a=n(27),u=n(63);r({target:"Object",stat:!0,sham:!i},{getOwnPropertyDescriptors:function(t){for(var e,n,r=s(t),i=a.f,c=o(r),l={},f=0;c.length>f;)void 0!==(n=i(r,e=c[f++]))&&u(l,e,n);return l}})},function(t,e,n){var r=n(1),i=n(3),o=n(125).f;r({target:"Object",stat:!0,forced:i((function(){return!Object.getOwnPropertyNames(1)}))},{getOwnPropertyNames:o})},function(t,e,n){var r=n(1),i=n(217);r({target:"Number",stat:!0,forced:Number.parseInt!=i},{parseInt:i})},function(t,e,n){var r=n(2),i=n(115).trim,o=n(116),s=r.parseInt,a=/^[+-]?0[Xx]/,u=8!==s(o+"08")||22!==s(o+"0x16");t.exports=u?function(t,e){var n=i(String(t));return s(n,e>>>0||(a.test(n)?16:10))}:s},function(t,e,n){"use strict";n.r(e);var r=n(0);n.d(e,"SmartLib",(function(){return r.n})),n.d(e,"LoggerManager",(function(){return r.h})),n.d(e,"PlayerEventListener",(function(){return r.j})),n.d(e,"GenericPlayerApi",(function(){return r.e})),n.d(e,"RequestManager",(function(){return r.l})),n.d(e,"HostResolvingTask",(function(){return r.f})),n.d(e,"SessionTrackerTimeline",(function(){return r.m})),n.d(e,"StreamingSession",(function(){return r.o})),n.d(e,"StreamingSessionOptions",(function(){return r.p})),n.d(e,"StreamingSessionResult",(function(){return r.q})),n.d(e,"AdManager",(function(){return r.a}));var i=n(80);n.d(e,"DashJsPlayerAdapter",(function(){return i.a}));var o=n(79);n.d(e,"ShakaPlayerAdapter",(function(){return o.a}));var s=n(81);n.d(e,"HTML5PlayerAdapter",(function(){return s.a}));var a=n(82);n.d(e,"AVPlayAdapter",(function(){return a.a}));var u=n(83);n.d(e,"SagemcomDIW387Adapter",(function(){return u.a}));var c=n(84);n.d(e,"HbbTV1PlayerAdapter",(function(){return c.a}));var l=n(85);n.d(e,"KalturaPlayerAdapter",(function(){return l.a})),n(86).a.getInstance().init()}])},module.exports=e()},function(t,e,n){var r=n(11),i=n(12),o=n(17);t.exports=r?function(t,e,n){return i.f(t,e,o(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,n){var r=n(45),i=n(0),o=function(t){return"function"==typeof t?t:void 0};t.exports=function(t,e){return arguments.length<2?o(r[t])||o(i[t]):r[t]&&r[t][e]||i[t]&&i[t][e]}},function(t,e,n){var r=n(0),i=n(23).f,o=n(7),s=n(13),a=n(27),u=n(69),c=n(48);t.exports=function(t,e){var n,l,f,h,d,p=t.target,v=t.global,y=t.stat;if(n=v?r:y?r[p]||a(p,{}):(r[p]||{}).prototype)for(l in e){if(h=e[l],f=t.noTargetGet?(d=i(n,l))&&d.value:n[l],!c(v?l:p+(y?".":"#")+l,t.forced)&&void 0!==f){if(typeof h==typeof f)continue;u(h,f)}(t.sham||f&&f.sham)&&o(h,"sham",!0),s(n,l,h,t)}}},function(t,e,n){var r=n(2);t.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(t,e,n){var r=n(11),i=n(42),o=n(4),s=n(40),a=Object.defineProperty;e.f=r?a:function(t,e,n){if(o(t),e=s(e,!0),o(n),i)try{return a(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){var r=n(0),i=n(7),o=n(3),s=n(27),a=n(28),u=n(19),c=u.get,l=u.enforce,f=String(String).split("String");(t.exports=function(t,e,n,a){var u,c=!!a&&!!a.unsafe,h=!!a&&!!a.enumerable,d=!!a&&!!a.noTargetGet;"function"==typeof n&&("string"!=typeof e||o(n,"name")||i(n,"name",e),(u=l(n)).source||(u.source=f.join("string"==typeof e?e:""))),t!==r?(c?!d&&t[e]&&(h=!0):delete t[e],h?t[e]=n:i(t,e,n)):h?t[e]=n:s(e,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&c(this).source||a(this)}))},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t}},function(t,e){t.exports=!1},function(t,e){t.exports={}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){var r=n(67),i=n(25);t.exports=function(t){return r(i(t))}},function(t,e,n){var r,i,o,s=n(68),a=n(0),u=n(8),c=n(7),l=n(3),f=n(29),h=n(30),d=n(31),p=a.WeakMap;if(s){var v=f.state||(f.state=new p),y=v.get,g=v.has,E=v.set;r=function(t,e){if(g.call(v,t))throw new TypeError("Object already initialized");return e.facade=t,E.call(v,t,e),e},i=function(t){return y.call(v,t)||{}},o=function(t){return g.call(v,t)}}else{var S=h("state");d[S]=!0,r=function(t,e){if(l(t,S))throw new TypeError("Object already initialized");return e.facade=t,c(t,S,e),e},i=function(t){return l(t,S)?t[S]:{}},o=function(t){return l(t,S)}}t.exports={set:r,get:i,has:o,enforce:function(t){return o(t)?i(t):r(t,{})},getterFor:function(t){return function(e){var n;if(!u(e)||(n=i(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return n}}}},function(t,e,n){var r=n(4),i=n(79),o=n(47),s=n(53),a=n(81),u=n(82),c=function(t,e){this.stopped=t,this.result=e};t.exports=function(t,e,n){var l,f,h,d,p,v,y,g=n&&n.that,E=!(!n||!n.AS_ENTRIES),S=!(!n||!n.IS_ITERATOR),b=!(!n||!n.INTERRUPTED),m=s(e,g,1+E+b),k=function(t){return l&&u(l),new c(!0,t)},A=function(t){return E?(r(t),b?m(t[0],t[1],k):m(t[0],t[1])):b?m(t,k):m(t)};if(S)l=t;else{if("function"!=typeof(f=a(t)))throw TypeError("Target is not iterable");if(i(f)){for(h=0,d=o(t.length);d>h;h++)if((p=A(t[h]))&&p instanceof c)return p;return new c(!1)}l=f.call(t)}for(v=l.next;!(y=v.call(l)).done;){try{p=A(y.value)}catch(t){throw u(l),t}if("object"==typeof p&&p&&p instanceof c)return p}return new c(!1)}},function(t,e,n){var r=n(24),i=n(0);t.exports="process"==r(i.process)},function(t,e,n){"use strict";var r=n(14),i=function(t){var e,n;this.promise=new t((function(t,r){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=r})),this.resolve=r(e),this.reject=r(n)};t.exports.f=function(t){return new i(t)}},function(t,e,n){var r=n(11),i=n(66),o=n(17),s=n(18),a=n(40),u=n(3),c=n(42),l=Object.getOwnPropertyDescriptor;e.f=r?l:function(t,e){if(t=s(t),e=a(e,!0),c)try{return l(t,e)}catch(t){}if(u(t,e))return o(!i.f.call(t,e),t[e])}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t}},function(t,e,n){var r=n(0),i=n(8),o=r.document,s=i(o)&&i(o.createElement);t.exports=function(t){return s?o.createElement(t):{}}},function(t,e,n){var r=n(0),i=n(7);t.exports=function(t,e){try{i(r,t,e)}catch(n){r[t]=e}return e}},function(t,e,n){var r=n(29),i=Function.toString;"function"!=typeof r.inspectSource&&(r.inspectSource=function(t){return i.call(t)}),t.exports=r.inspectSource},function(t,e,n){var r=n(0),i=n(27),o=r["__core-js_shared__"]||i("__core-js_shared__",{});t.exports=o},function(t,e,n){var r=n(43),i=n(44),o=r("keys");t.exports=function(t){return o[t]||(o[t]=i(t))}},function(t,e){t.exports={}},function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},function(t,e){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(t,e,n){var r=n(3),i=n(41),o=n(30),s=n(75),a=o("IE_PROTO"),u=Object.prototype;t.exports=s?Object.getPrototypeOf:function(t){return t=i(t),r(t,a)?t[a]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,e,n){var r,i=n(4),o=n(77),s=n(33),a=n(31),u=n(50),c=n(26),l=n(30),f=l("IE_PROTO"),h=function(){},d=function(t){return"<script>"+t+"<\/script>"},p=function(){try{r=document.domain&&new ActiveXObject("htmlfile")}catch(t){}var t,e;p=r?function(t){t.write(d("")),t.close();var e=t.parentWindow.Object;return t=null,e}(r):((e=c("iframe")).style.display="none",u.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(d("document.F=Object")),t.close(),t.F);for(var n=s.length;n--;)delete p.prototype[s[n]];return p()};a[f]=!0,t.exports=Object.create||function(t,e){var n;return null!==t?(h.prototype=i(t),n=new h,h.prototype=null,n[f]=t):n=p(),void 0===e?n:o(n,e)}},function(t,e,n){var r=n(9);t.exports=r("navigator","userAgent")||""},function(t,e,n){var r={};r[n(1)("toStringTag")]="z",t.exports="[object z]"===String(r)},function(t,e,n){var r=n(12).f,i=n(3),o=n(1)("toStringTag");t.exports=function(t,e,n){t&&!i(t=n?t:t.prototype,o)&&r(t,o,{configurable:!0,value:e})}},function(t,e){t.exports=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}}},function(t,e,n){var r=n(8);t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){var r=n(25);t.exports=function(t){return Object(r(t))}},function(t,e,n){var r=n(11),i=n(2),o=n(26);t.exports=!r&&!i((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},function(t,e,n){var r=n(15),i=n(29);(t.exports=function(t,e){return i[t]||(i[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.11.0",mode:r?"pure":"global",copyright:"© 2021 Denis Pushkarev (zloirock.ru)"})},function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++n+r).toString(36)}},function(t,e,n){var r=n(0);t.exports=r},function(t,e,n){var r=n(3),i=n(18),o=n(72).indexOf,s=n(31);t.exports=function(t,e){var n,a=i(t),u=0,c=[];for(n in a)!r(s,n)&&r(a,n)&&c.push(n);for(;e.length>u;)r(a,n=e[u++])&&(~o(c,n)||c.push(n));return c}},function(t,e,n){var r=n(32),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},function(t,e,n){var r=n(2),i=/#|\.prototype\./,o=function(t,e){var n=a[s(t)];return n==c||n!=u&&("function"==typeof e?r(e):!!e)},s=o.normalize=function(t){return String(t).replace(i,".").toLowerCase()},a=o.data={},u=o.NATIVE="N",c=o.POLYFILL="P";t.exports=o},function(t,e,n){var r=n(4),i=n(76);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),e=n instanceof Array}catch(t){}return function(n,o){return r(n),i(o),e?t.call(n,o):n.__proto__=o,n}}():void 0)},function(t,e,n){var r=n(9);t.exports=r("document","documentElement")},function(t,e,n){var r=n(21),i=n(52),o=n(2);t.exports=!!Object.getOwnPropertySymbols&&!o((function(){return!Symbol.sham&&(r?38===i:i>37&&i<41)}))},function(t,e,n){var r,i,o=n(0),s=n(36),a=o.process,u=a&&a.versions,c=u&&u.v8;c?i=(r=c.split("."))[0]+r[1]:s&&(!(r=s.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=s.match(/Chrome\/(\d+)/))&&(i=r[1]),t.exports=i&&+i},function(t,e,n){var r=n(14);t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 0:return function(){return t.call(e)};case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}}},function(t,e,n){var r=n(37),i=n(24),o=n(1)("toStringTag"),s="Arguments"==i(function(){return arguments}());t.exports=r?i:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),o))?n:s?i(e):"Object"==(r=i(e))&&"function"==typeof e.callee?"Arguments":r}},function(t,e,n){var r=n(0);t.exports=r.Promise},function(t,e,n){var r=n(4),i=n(14),o=n(1)("species");t.exports=function(t,e){var n,s=r(t).constructor;return void 0===s||null==(n=r(s)[o])?e:i(n)}},function(t,e,n){var r,i,o,s=n(0),a=n(2),u=n(53),c=n(50),l=n(26),f=n(58),h=n(21),d=s.location,p=s.setImmediate,v=s.clearImmediate,y=s.process,g=s.MessageChannel,E=s.Dispatch,S=0,b={},m=function(t){if(b.hasOwnProperty(t)){var e=b[t];delete b[t],e()}},k=function(t){return function(){m(t)}},A=function(t){m(t.data)},I=function(t){s.postMessage(t+"",d.protocol+"//"+d.host)};p&&v||(p=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return b[++S]=function(){("function"==typeof t?t:Function(t)).apply(void 0,e)},r(S),S},v=function(t){delete b[t]},h?r=function(t){y.nextTick(k(t))}:E&&E.now?r=function(t){E.now(k(t))}:g&&!f?(o=(i=new g).port2,i.port1.onmessage=A,r=u(o.postMessage,o,1)):s.addEventListener&&"function"==typeof postMessage&&!s.importScripts&&d&&"file:"!==d.protocol&&!a(I)?(r=I,s.addEventListener("message",A,!1)):r="onreadystatechange"in l("script")?function(t){c.appendChild(l("script")).onreadystatechange=function(){c.removeChild(this),m(t)}}:function(t){setTimeout(k(t),0)}),t.exports={set:p,clear:v}},function(t,e,n){var r=n(36);t.exports=/(?:iphone|ipod|ipad).*applewebkit/i.test(r)},function(t,e,n){var r=n(4),i=n(8),o=n(22);t.exports=function(t,e){if(r(t),i(e)&&e.constructor===t)return e;var n=o.f(t);return(0,n.resolve)(e),n.promise}},function(t,e,n){"use strict";var r=n(10),i=n(98),o=n(34),s=n(49),a=n(38),u=n(7),c=n(13),l=n(1),f=n(15),h=n(16),d=n(61),p=d.IteratorPrototype,v=d.BUGGY_SAFARI_ITERATORS,y=l("iterator"),g=function(){return this};t.exports=function(t,e,n,l,d,E,S){i(n,e,l);var b,m,k,A=function(t){if(t===d&&_)return _;if(!v&&t in R)return R[t];switch(t){case"keys":case"values":case"entries":return function(){return new n(this,t)}}return function(){return new n(this)}},I=e+" Iterator",D=!1,R=t.prototype,T=R[y]||R["@@iterator"]||d&&R[d],_=!v&&T||A(d),N="Array"==e&&R.entries||T;if(N&&(b=o(N.call(new t)),p!==Object.prototype&&b.next&&(f||o(b)===p||(s?s(b,p):"function"!=typeof b[y]&&u(b,y,g)),a(b,I,!0,!0),f&&(h[I]=g))),"values"==d&&T&&"values"!==T.name&&(D=!0,_=function(){return T.call(this)}),f&&!S||R[y]===_||u(R,y,_),h[e]=_,d)if(m={values:A("values"),keys:E?_:A("keys"),entries:A("entries")},S)for(k in m)(v||D||!(k in R))&&c(R,k,m[k]);else r({target:e,proto:!0,forced:v||D},m);return m}},function(t,e,n){"use strict";var r,i,o,s=n(2),a=n(34),u=n(7),c=n(3),l=n(1),f=n(15),h=l("iterator"),d=!1;[].keys&&("next"in(o=[].keys())?(i=a(a(o)))!==Object.prototype&&(r=i):d=!0);var p=null==r||s((function(){var t={};return r[h].call(t)!==t}));p&&(r={}),f&&!p||c(r,h)||u(r,h,(function(){return this})),t.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:d}},function(t,e,n){var r=n(63);t.exports=r},function(t,e,n){n(64),n(83),n(85),n(93),n(94),n(95),n(96),n(99);var r=n(45);t.exports=r.Promise},function(t,e,n){"use strict";var r=n(10),i=n(34),o=n(49),s=n(35),a=n(7),u=n(17),c=n(20),l=function(t,e){var n=this;if(!(n instanceof l))return new l(t,e);o&&(n=o(new Error(void 0),i(n))),void 0!==e&&a(n,"message",String(e));var r=[];return c(t,r.push,{that:r}),a(n,"errors",r),n};l.prototype=s(Error.prototype,{constructor:u(5,l),message:u(5,""),name:u(5,"AggregateError")}),r({global:!0},{AggregateError:l})},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";var r={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,o=i&&!r.call({1:2},1);e.f=o?function(t){var e=i(this,t);return!!e&&e.enumerable}:r},function(t,e,n){var r=n(2),i=n(24),o="".split;t.exports=r((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==i(t)?o.call(t,""):Object(t)}:Object},function(t,e,n){var r=n(0),i=n(28),o=r.WeakMap;t.exports="function"==typeof o&&/native code/.test(i(o))},function(t,e,n){var r=n(3),i=n(70),o=n(23),s=n(12);t.exports=function(t,e){for(var n=i(e),a=s.f,u=o.f,c=0;c<n.length;c++){var l=n[c];r(t,l)||a(t,l,u(e,l))}}},function(t,e,n){var r=n(9),i=n(71),o=n(74),s=n(4);t.exports=r("Reflect","ownKeys")||function(t){var e=i.f(s(t)),n=o.f;return n?e.concat(n(t)):e}},function(t,e,n){var r=n(46),i=n(33).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,i)}},function(t,e,n){var r=n(18),i=n(47),o=n(73),s=function(t){return function(e,n,s){var a,u=r(e),c=i(u.length),l=o(s,c);if(t&&n!=n){for(;c>l;)if((a=u[l++])!=a)return!0}else for(;c>l;l++)if((t||l in u)&&u[l]===n)return t||l||0;return!t&&-1}};t.exports={includes:s(!0),indexOf:s(!1)}},function(t,e,n){var r=n(32),i=Math.max,o=Math.min;t.exports=function(t,e){var n=r(t);return n<0?i(n+e,0):o(n,e)}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var r=n(2);t.exports=!r((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},function(t,e,n){var r=n(8);t.exports=function(t){if(!r(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype");return t}},function(t,e,n){var r=n(11),i=n(12),o=n(4),s=n(78);t.exports=r?Object.defineProperties:function(t,e){o(t);for(var n,r=s(e),a=r.length,u=0;a>u;)i.f(t,n=r[u++],e[n]);return t}},function(t,e,n){var r=n(46),i=n(33);t.exports=Object.keys||function(t){return r(t,i)}},function(t,e,n){var r=n(1),i=n(16),o=r("iterator"),s=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||s[o]===t)}},function(t,e,n){var r=n(51);t.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(t,e,n){var r=n(54),i=n(16),o=n(1)("iterator");t.exports=function(t){if(null!=t)return t[o]||t["@@iterator"]||i[r(t)]}},function(t,e,n){var r=n(4);t.exports=function(t){var e=t.return;if(void 0!==e)return r(e.call(t)).value}},function(t,e,n){var r=n(37),i=n(13),o=n(84);r||i(Object.prototype,"toString",o,{unsafe:!0})},function(t,e,n){"use strict";var r=n(37),i=n(54);t.exports=r?{}.toString:function(){return"[object "+i(this)+"]"}},function(t,e,n){"use strict";var r,i,o,s,a=n(10),u=n(15),c=n(0),l=n(9),f=n(55),h=n(13),d=n(86),p=n(38),v=n(87),y=n(8),g=n(14),E=n(88),S=n(28),b=n(20),m=n(89),k=n(56),A=n(57).set,I=n(90),D=n(59),R=n(92),T=n(22),_=n(39),N=n(19),L=n(48),O=n(1),P=n(21),w=n(52),C=O("species"),M="Promise",B=N.get,x=N.set,U=N.getterFor(M),j=f,F=c.TypeError,G=c.document,H=c.process,V=l("fetch"),Y=T.f,W=Y,q=!!(G&&G.createEvent&&c.dispatchEvent),K="function"==typeof PromiseRejectionEvent,Q=L(M,(function(){if(!(S(j)!==String(j))){if(66===w)return!0;if(!P&&!K)return!0}if(u&&!j.prototype.finally)return!0;if(w>=51&&/native code/.test(j))return!1;var t=j.resolve(1),e=function(t){t((function(){}),(function(){}))};return(t.constructor={})[C]=e,!(t.then((function(){}))instanceof e)})),z=Q||!m((function(t){j.all(t).catch((function(){}))})),J=function(t){var e;return!(!y(t)||"function"!=typeof(e=t.then))&&e},X=function(t,e){if(!t.notified){t.notified=!0;var n=t.reactions;I((function(){for(var r=t.value,i=1==t.state,o=0;n.length>o;){var s,a,u,c=n[o++],l=i?c.ok:c.fail,f=c.resolve,h=c.reject,d=c.domain;try{l?(i||(2===t.rejection&&et(t),t.rejection=1),!0===l?s=r:(d&&d.enter(),s=l(r),d&&(d.exit(),u=!0)),s===c.promise?h(F("Promise-chain cycle")):(a=J(s))?a.call(s,f,h):f(s)):h(r)}catch(t){d&&!u&&d.exit(),h(t)}}t.reactions=[],t.notified=!1,e&&!t.rejection&&Z(t)}))}},$=function(t,e,n){var r,i;q?((r=G.createEvent("Event")).promise=e,r.reason=n,r.initEvent(t,!1,!0),c.dispatchEvent(r)):r={promise:e,reason:n},!K&&(i=c["on"+t])?i(r):"unhandledrejection"===t&&R("Unhandled promise rejection",n)},Z=function(t){A.call(c,(function(){var e,n=t.facade,r=t.value;if(tt(t)&&(e=_((function(){P?H.emit("unhandledRejection",r,n):$("unhandledrejection",n,r)})),t.rejection=P||tt(t)?2:1,e.error))throw e.value}))},tt=function(t){return 1!==t.rejection&&!t.parent},et=function(t){A.call(c,(function(){var e=t.facade;P?H.emit("rejectionHandled",e):$("rejectionhandled",e,t.value)}))},nt=function(t,e,n){return function(r){t(e,r,n)}},rt=function(t,e,n){t.done||(t.done=!0,n&&(t=n),t.value=e,t.state=2,X(t,!0))},it=function(t,e,n){if(!t.done){t.done=!0,n&&(t=n);try{if(t.facade===e)throw F("Promise can't be resolved itself");var r=J(e);r?I((function(){var n={done:!1};try{r.call(e,nt(it,n,t),nt(rt,n,t))}catch(e){rt(n,e,t)}})):(t.value=e,t.state=1,X(t,!1))}catch(e){rt({done:!1},e,t)}}};Q&&(j=function(t){E(this,j,M),g(t),r.call(this);var e=B(this);try{t(nt(it,e),nt(rt,e))}catch(t){rt(e,t)}},(r=function(t){x(this,{type:M,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=d(j.prototype,{then:function(t,e){var n=U(this),r=Y(k(this,j));return r.ok="function"!=typeof t||t,r.fail="function"==typeof e&&e,r.domain=P?H.domain:void 0,n.parent=!0,n.reactions.push(r),0!=n.state&&X(n,!1),r.promise},catch:function(t){return this.then(void 0,t)}}),i=function(){var t=new r,e=B(t);this.promise=t,this.resolve=nt(it,e),this.reject=nt(rt,e)},T.f=Y=function(t){return t===j||t===o?new i(t):W(t)},u||"function"!=typeof f||(s=f.prototype.then,h(f.prototype,"then",(function(t,e){var n=this;return new j((function(t,e){s.call(n,t,e)})).then(t,e)}),{unsafe:!0}),"function"==typeof V&&a({global:!0,enumerable:!0,forced:!0},{fetch:function(t){return D(j,V.apply(c,arguments))}}))),a({global:!0,wrap:!0,forced:Q},{Promise:j}),p(j,M,!1,!0),v(M),o=l(M),a({target:M,stat:!0,forced:Q},{reject:function(t){var e=Y(this);return e.reject.call(void 0,t),e.promise}}),a({target:M,stat:!0,forced:u||Q},{resolve:function(t){return D(u&&this===o?j:this,t)}}),a({target:M,stat:!0,forced:z},{all:function(t){var e=this,n=Y(e),r=n.resolve,i=n.reject,o=_((function(){var n=g(e.resolve),o=[],s=0,a=1;b(t,(function(t){var u=s++,c=!1;o.push(void 0),a++,n.call(e,t).then((function(t){c||(c=!0,o[u]=t,--a||r(o))}),i)})),--a||r(o)}));return o.error&&i(o.value),n.promise},race:function(t){var e=this,n=Y(e),r=n.reject,i=_((function(){var i=g(e.resolve);b(t,(function(t){i.call(e,t).then(n.resolve,r)}))}));return i.error&&r(i.value),n.promise}})},function(t,e,n){var r=n(13);t.exports=function(t,e,n){for(var i in e)r(t,i,e[i],n);return t}},function(t,e,n){"use strict";var r=n(9),i=n(12),o=n(1),s=n(11),a=o("species");t.exports=function(t){var e=r(t),n=i.f;s&&e&&!e[a]&&n(e,a,{configurable:!0,get:function(){return this}})}},function(t,e){t.exports=function(t,e,n){if(!(t instanceof e))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return t}},function(t,e,n){var r=n(1)("iterator"),i=!1;try{var o=0,s={next:function(){return{done:!!o++}},return:function(){i=!0}};s[r]=function(){return this},Array.from(s,(function(){throw 2}))}catch(t){}t.exports=function(t,e){if(!e&&!i)return!1;var n=!1;try{var o={};o[r]=function(){return{next:function(){return{done:n=!0}}}},t(o)}catch(t){}return n}},function(t,e,n){var r,i,o,s,a,u,c,l,f=n(0),h=n(23).f,d=n(57).set,p=n(58),v=n(91),y=n(21),g=f.MutationObserver||f.WebKitMutationObserver,E=f.document,S=f.process,b=f.Promise,m=h(f,"queueMicrotask"),k=m&&m.value;k||(r=function(){var t,e;for(y&&(t=S.domain)&&t.exit();i;){e=i.fn,i=i.next;try{e()}catch(t){throw i?s():o=void 0,t}}o=void 0,t&&t.enter()},p||y||v||!g||!E?b&&b.resolve?(c=b.resolve(void 0),l=c.then,s=function(){l.call(c,r)}):s=y?function(){S.nextTick(r)}:function(){d.call(f,r)}:(a=!0,u=E.createTextNode(""),new g(r).observe(u,{characterData:!0}),s=function(){u.data=a=!a})),t.exports=k||function(t){var e={fn:t,next:void 0};o&&(o.next=e),i||(i=e,s()),o=e}},function(t,e,n){var r=n(36);t.exports=/web0s(?!.*chrome)/i.test(r)},function(t,e,n){var r=n(0);t.exports=function(t,e){var n=r.console;n&&n.error&&(1===arguments.length?n.error(t):n.error(t,e))}},function(t,e,n){"use strict";var r=n(10),i=n(14),o=n(22),s=n(39),a=n(20);r({target:"Promise",stat:!0},{allSettled:function(t){var e=this,n=o.f(e),r=n.resolve,u=n.reject,c=s((function(){var n=i(e.resolve),o=[],s=0,u=1;a(t,(function(t){var i=s++,a=!1;o.push(void 0),u++,n.call(e,t).then((function(t){a||(a=!0,o[i]={status:"fulfilled",value:t},--u||r(o))}),(function(t){a||(a=!0,o[i]={status:"rejected",reason:t},--u||r(o))}))})),--u||r(o)}));return c.error&&u(c.value),n.promise}})},function(t,e,n){"use strict";var r=n(10),i=n(14),o=n(9),s=n(22),a=n(39),u=n(20);r({target:"Promise",stat:!0},{any:function(t){var e=this,n=s.f(e),r=n.resolve,c=n.reject,l=a((function(){var n=i(e.resolve),s=[],a=0,l=1,f=!1;u(t,(function(t){var i=a++,u=!1;s.push(void 0),l++,n.call(e,t).then((function(t){u||f||(f=!0,r(t))}),(function(t){u||f||(u=!0,s[i]=t,--l||c(new(o("AggregateError"))(s,"No one promise resolved")))}))})),--l||c(new(o("AggregateError"))(s,"No one promise resolved"))}));return l.error&&c(l.value),n.promise}})},function(t,e,n){"use strict";var r=n(10),i=n(15),o=n(55),s=n(2),a=n(9),u=n(56),c=n(59),l=n(13);r({target:"Promise",proto:!0,real:!0,forced:!!o&&s((function(){o.prototype.finally.call({then:function(){}},(function(){}))}))},{finally:function(t){var e=u(this,a("Promise")),n="function"==typeof t;return this.then(n?function(n){return c(e,t()).then((function(){return n}))}:t,n?function(n){return c(e,t()).then((function(){throw n}))}:t)}}),i||"function"!=typeof o||o.prototype.finally||l(o.prototype,"finally",a("Promise").prototype.finally)},function(t,e,n){"use strict";var r=n(97).charAt,i=n(19),o=n(60),s=i.set,a=i.getterFor("String Iterator");o(String,"String",(function(t){s(this,{type:"String Iterator",string:String(t),index:0})}),(function(){var t,e=a(this),n=e.string,i=e.index;return i>=n.length?{value:void 0,done:!0}:(t=r(n,i),e.index+=t.length,{value:t,done:!1})}))},function(t,e,n){var r=n(32),i=n(25),o=function(t){return function(e,n){var o,s,a=String(i(e)),u=r(n),c=a.length;return u<0||u>=c?t?"":void 0:(o=a.charCodeAt(u))<55296||o>56319||u+1===c||(s=a.charCodeAt(u+1))<56320||s>57343?t?a.charAt(u):o:t?a.slice(u,u+2):s-56320+(o-55296<<10)+65536}};t.exports={codeAt:o(!1),charAt:o(!0)}},function(t,e,n){"use strict";var r=n(61).IteratorPrototype,i=n(35),o=n(17),s=n(38),a=n(16),u=function(){return this};t.exports=function(t,e,n){var c=e+" Iterator";return t.prototype=i(r,{next:o(1,n)}),s(t,c,!1,!0),a[c]=u,t}},function(t,e,n){var r=n(0),i=n(100),o=n(101),s=n(7),a=n(1),u=a("iterator"),c=a("toStringTag"),l=o.values;for(var f in i){var h=r[f],d=h&&h.prototype;if(d){if(d[u]!==l)try{s(d,u,l)}catch(t){d[u]=l}if(d[c]||s(d,c,f),i[f])for(var p in o)if(d[p]!==o[p])try{s(d,p,o[p])}catch(t){d[p]=o[p]}}}},function(t,e){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(t,e,n){"use strict";var r=n(18),i=n(102),o=n(16),s=n(19),a=n(60),u=s.set,c=s.getterFor("Array Iterator");t.exports=a(Array,"Array",(function(t,e){u(this,{type:"Array Iterator",target:r(t),index:0,kind:e})}),(function(){var t=c(this),e=t.target,n=t.kind,r=t.index++;return!e||r>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:e[r],done:!1}:{value:[r,e[r]],done:!1}}),"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},function(t,e,n){var r=n(1),i=n(35),o=n(12),s=r("unscopables"),a=Array.prototype;null==a[s]&&o.f(a,s,{configurable:!0,value:i(null)}),t.exports=function(t){a[s][t]=!0}},function(t,e,n){"use strict";n.r(e),n.d(e,"Plugin",(function(){return y})),n.d(e,"VERSION",(function(){return g})),n.d(e,"NAME",(function(){return E}));n(62);var r=n(5),i=n(6);function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var s=function(){function t(t,e){this._plugin=e,this._plugin.setSourceChangeCallback((function(e){return t.src=e}))}var e,n,r;return t.prototype.dispatchEvent=function(t){return t.defaultPrevented},e=t,(n=[{key:"active",get:function(){return!1}}])&&o(e.prototype,n),r&&o(e,r),t}();var a=function(t){var e,n;function r(e){var n,r,i,o;return n=t.call(this)||this,r=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(n),o="BPMiddleware",(i="id")in r?Object.defineProperty(r,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[i]=o,n._context=e,n}return n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n,r.prototype.load=function(t){var e=this;this._context.srcReady().finally((function(){return e.callNext(t)}))},r}(r.core.BaseMiddleware);r.core.BaseMiddleware;var u=r.core.Utils,c=r.core.LogLevel,l=-1,f=0,h=1;i.LoggerManager.getInstance().setLogLevel(l);var d,p,v,y=function(t){var e,n;n=t,(e=o).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n;var r=o.prototype;function o(e,n,r){var o;return(o=t.call(this,e,n,r)||this)._setLogLevel(),o.eventManager.listen(o.player,o.player.Event.Core.ERROR,(function(){return o.reset()})),o._attachSourceChange(),i.SmartLib.getInstance().init(o.config.analyticsAddress,o.config.nanoCDNHost,o.config.broadpeakDomainNames),o}return r.getEngineDecorator=function(t){return new s(t,this)},r.getMiddlewareImpl=function(){return new a(this)},o.isValid=function(){return!0},r.srcReady=function(){return this._srcPromise},r.setSourceChangeCallback=function(t){this.sourceChangeCallback=t},r.reset=function(){this.session&&this.session.stopStreamingSession(),this.session=null},r.destroy=function(){i.SmartLib.getInstance().release()},r._setLogLevel=function(){switch(u.Object.getPropertyPath(this.player,"config.log.level")){case c.ERROR.name:case c.OFF.name:i.LoggerManager.getInstance().setLogLevel(l);break;case c.DEBUG.name:i.LoggerManager.getInstance().setLogLevel(h);break;case c.TIME.name:case c.WARN.name:case c.INFO.name:default:i.LoggerManager.getInstance().setLogLevel(f)}},r._attachSourceChange=function(){var t=this;this.eventManager.listen(this.player,this.player.Event.Core.SOURCE_SELECTED,(function(e){t._srcPromise=u.Object.defer(),t.session=i.SmartLib.getInstance().createStreamingSession(),t.session.attachPlayer(t.player),t._getSource(e.payload.selectedSource[0].url)}))},r._getSource=function(t){var e=this;this.session.getURL(t).then((function(t){t.isError()?(e.logger.error("getUrl failed",t.getErrorCode(),t.getErrorMessage()),e.reset(),e._srcPromise.reject()):(e.logger.debug("getUrl response",t.getURL()),e.sourceChangeCallback(t.getURL()),e._srcPromise.resolve())}))},o}(r.BasePlugin);v={analyticsAddress:null,nanoCDNHost:null,broadpeakDomainNames:[]},(p="defaultConfig")in(d=y)?Object.defineProperty(d,p,{value:v,enumerable:!0,configurable:!0,writable:!0}):d[p]=v;var g="1.1.1",E="@playkit-js/playkit-broadpeak-smartlib";Object(r.registerPlugin)("broadpeak",y)}]);
//# sourceMappingURL=playkit-broadpeak.js.map